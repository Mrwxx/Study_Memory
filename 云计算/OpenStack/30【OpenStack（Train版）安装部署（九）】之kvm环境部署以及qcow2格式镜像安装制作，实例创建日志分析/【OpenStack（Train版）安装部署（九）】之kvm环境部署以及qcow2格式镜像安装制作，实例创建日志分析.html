<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>【OpenStack（Train版）安装部署（九）】之kvm环境部署以及qcow2格式镜像安装制作，实例创建日志分析</title>
  <link rel="stylesheet" href="https://stackedit.io/style.css" />
</head>

<body class="stackedit">
  <div class="stackedit__html"><p></p><div class="toc"><h3>文章目录</h3><ul><ul><li><a href="#_1">本文章由公号【开发小鸽】发布！欢迎关注！！！</a></li><li><a href="#1%09_9">1.	镜像类型</a></li><li><a href="#2%09_33">2.	容器格式</a></li><li><a href="#3OpenStack_40">3.OpenStack镜像上传方式</a></li><li><a href="#4%09dashboard_47">4.	（未实施）dashboard创建镜像</a></li><li><a href="#5glance_68">5.（未实施）glance创建镜像命令</a></li><li><a href="#6kvm_122">6.部署kvm基本环境</a></li><li><a href="#7Centosqcow2_170">7.Centos系统qcow2格式镜像制作</a></li><ul><li><a href="#1_171">（1）给虚拟机创建一个网络</a></li><li><a href="#2_193">（2）创建虚拟机</a></li><li><a href="#3_247">（3）启动与测试虚机</a></li><li><a href="#4Controllerglance_265">（4）Controller节点创建镜像到glance中</a></li><li><a href="#5dashboard_299">（5）通过dashboard测试创建实例</a></li><li><a href="#6_317">（6）通过命令创建单实例</a></li><li><a href="#7_331">（7）通过同一个镜像创建新的实例</a></li><li><a href="#8_344">（8）复制新的镜像创建新的实例</a></li><li><a href="#9qcow2glance_368">（9）复制qcow2格式镜像重新上传到glance中</a></li><li><a href="#10qcow2qcow2_396">（10）在qcow2格式基础镜像的基础上创建新的qcow2格式的镜像</a></li><li><a href="#11glance_421">（11）通过该新的增量镜像上传到glance中</a></li><li><a href="#12_436">（12）测试通过该新的镜像创建实例</a></li><li><a href="#13flavor_452">（13）创建新的flavor后继续创建虚机</a></li><li><a href="#14nova_480">（14）查看nova日志</a></li><li><a href="#15image_546">（15）查看image日志</a></li><li><a href="#16novaserver_566">（16）根据nova创建server实例的日志流程排错</a></li><li><a href="#17ComputeCPU_713">（17）增大Compute节点的内存和CPU容量</a></li></ul></ul></ul></div><p></p>
<h2><a id="_1"></a>本文章由公号【开发小鸽】发布！欢迎关注！！！</h2>
<br>
<p><strong>老规矩–妹妹镇楼：</strong></p>
<center>
<img src="https://img-blog.csdnimg.cn/20200721223424816.JPG" width="20%">
</center><h2><a id="1%09_9"></a>1.	镜像类型</h2>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 一类是 物理机镜像格式。 ISO BIN IMAGE等。使用此类镜像创建虚拟机，需从头安装该操作系统。</p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 一类是 虚拟机镜像格式。 raw qcow2 vmdk等。已经安装好了系统并进行了基础设置，可看做一个模板。</p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; OpenStack 上传到glance的镜像既可以是ISO等格式的物理机镜像 也可以是qcow2等格式的虚拟机镜像。</p>
<p>有如下的格式</p>
<pre><code class="prism language-cpp">ISO 
Raw
<span class="token function">Machine</span> <span class="token punctuation">(</span>kernel<span class="token operator">/</span>ramdisk outside of image<span class="token punctuation">,</span> a<span class="token punctuation">.</span>k<span class="token punctuation">.</span>a<span class="token punctuation">.</span> AMI<span class="token punctuation">)</span>
<span class="token function">VHD</span> <span class="token punctuation">(</span>Hyper<span class="token operator">-</span>V<span class="token punctuation">)</span>
<span class="token function">VDI</span> <span class="token punctuation">(</span>VirtualBox<span class="token punctuation">)</span>
<span class="token function">qcow2</span> <span class="token punctuation">(</span>Qemu<span class="token operator">/</span>KVM<span class="token punctuation">)</span>
<span class="token function">VMDK</span> <span class="token punctuation">(</span>VMWare<span class="token punctuation">)</span>
<span class="token function">OVF</span> <span class="token punctuation">(</span>VMWare<span class="token punctuation">,</span> others<span class="token punctuation">)</span>
</code></pre>
<br>
<h2><a id="2%09_33"></a>2.	容器格式</h2>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 容器container格式是指虚拟机映像是否包含一个文件格式，该文件格式还包含有关实际虚拟机的元数据。需要注意的是：容器格式字符串在当前并不会被glance或其他OpenStack组件的使用，所以如果你不确定，简单的将容器格式指定bare是安全的。<br>
<br></p>
<h2><a id="3OpenStack_40"></a>3.OpenStack镜像上传方式</h2>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 可以通过dashboard上传，也可以使用openstack的命令上传。镜像名称可重复，根据ID查找镜像。如上传WindowsServer2008 的镜像（ISO和qcow2两种格式），不同格式的镜像上传时应选择对应的格式。<br>
<br></p>
<h2><a id="4%09dashboard_47"></a>4.	（未实施）dashboard创建镜像</h2>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 在dashboard的镜像界面中，通过创建镜像的方式创建ISO格式和QCOW2格式的镜像，如下所示：<br>
<img src="https://img-blog.csdnimg.cn/d0d93073fc2446ddbcd62836b973e32d.png" alt="在这里插入图片描述"></p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 通过openstack命令行来查看image镜像：</p>
<p><img src="https://img-blog.csdnimg.cn/9a0058a8751a4accb9851587075aee73.png" alt="在这里插入图片描述"></p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 查看Image对应的物理文件，在默认的images存储目录/var/lib/glance/images下：</p>
<pre><code class="prism language-cpp">ll <span class="token operator">/</span>var<span class="token operator">/</span>lib<span class="token operator">/</span>glance<span class="token operator">/</span>images
</code></pre>
<p><img src="https://img-blog.csdnimg.cn/2f90534f01204a239006f86e9732f51a.png" alt="在这里插入图片描述"><br>
<br></p>
<h2><a id="5glance_68"></a>5.（未实施）glance创建镜像命令</h2>
<pre><code class="prism language-cpp">glance image<span class="token operator">-</span>create命令 可以使用以下参数：
<span class="token operator">--</span>id <span class="token operator">&lt;</span>IMAGE_ID<span class="token operator">&gt;</span> 　　　　　　 　　　　　　 　　　　#镜像的ID
<span class="token operator">--</span>name <span class="token operator">&lt;</span>NAME<span class="token operator">&gt;</span> 　　　　 　　 　　　　 　　　　　　#镜像的名称
<span class="token operator">--</span>store <span class="token operator">&lt;</span>STORE<span class="token operator">&gt;</span> 　　　　　　 　　　　 　　　　　　#储存的镜像上传到
<span class="token operator">--</span>disk<span class="token operator">-</span>format <span class="token operator">&lt;</span>DISK_FORMAT<span class="token operator">&gt;</span>　　　　　　  　　　    #镜像的格式。可以接受的格式包含<span class="token operator">:</span> ami<span class="token punctuation">,</span>ari<span class="token punctuation">,</span> aki<span class="token punctuation">,</span> vhd<span class="token punctuation">,</span> vmdk<span class="token punctuation">,</span> raw<span class="token punctuation">,</span> qcow2<span class="token punctuation">,</span> vdi<span class="token punctuation">,</span> <span class="token operator">and</span> iso<span class="token punctuation">.</span>
<span class="token operator">--</span>container<span class="token operator">-</span>format <span class="token operator">&lt;</span>CONTAINER_FORMAT<span class="token operator">&gt;</span>　     　　  #镜像容器的格式。可以接受的格式包含<span class="token operator">:</span>ami<span class="token punctuation">,</span>ari<span class="token punctuation">,</span> aki<span class="token punctuation">,</span> bare<span class="token punctuation">,</span> <span class="token operator">and</span> ovf<span class="token punctuation">.</span>
<span class="token operator">--</span>owner <span class="token operator">&lt;</span>TENANT_ID<span class="token operator">&gt;</span> 　　　　　　　　　　　　 　　# 拥有该镜像的租户
<span class="token operator">--</span>size <span class="token operator">&lt;</span>SIZE<span class="token operator">&gt;</span>　　　　　　　　　　　　　　　　 　　  #镜像的大小<span class="token punctuation">(</span>以bytes表示<span class="token punctuation">)</span><span class="token punctuation">.</span> 一般只与<span class="token string">'--location'</span>和<span class="token string">'--copy_from'</span>一起使用。
<span class="token operator">--</span>min<span class="token operator">-</span>disk <span class="token operator">&lt;</span>DISK_GB<span class="token operator">&gt;</span> 　　　　　　　　　　　　 　　 #启动镜像所需的最小硬盘空间<span class="token punctuation">(</span>用gigabytes表示<span class="token punctuation">)</span><span class="token punctuation">.</span>
<span class="token operator">--</span>min<span class="token operator">-</span>ram <span class="token operator">&lt;</span>DISK_RAM<span class="token operator">&gt;</span> 　　　　　　　　　　　　 　  #启动镜像所需的最小内存数量<span class="token punctuation">(</span>用megabytes表示<span class="token punctuation">)</span><span class="token punctuation">.</span>
<span class="token operator">--</span>location <span class="token operator">&lt;</span>IMAGE_URL<span class="token operator">&gt;</span>　　　　　　　　　　　　　   #镜像所在位置的URL。例如，如果镜像储存在swift中，
<span class="token operator">--</span>file <span class="token operator">&lt;</span>FILE<span class="token operator">&gt;</span> 　　　　　　　　　　　　　　　　 　　    #在创建过程中将要被上传的本地文件（包括硬盘镜像）。另外，镜像也可以通过<span class="token constant">stdin</span>传递给客户端。
<span class="token operator">--</span>checksum <span class="token operator">&lt;</span>CHECKSUM<span class="token operator">&gt;</span>　　　　　　　　　　　　　#被Glance使用的可用于认证的镜像数据的哈希值，在此请提供一个md5校验值。
<span class="token operator">--</span>copy<span class="token operator">-</span>from <span class="token operator">&lt;</span>IMAGE_URL<span class="token operator">&gt;</span>　　　　　　　　　　　　    #用法和<span class="token string">'--location'</span>参数相似，但表明Glance服务器应该能立即从镜像所储存的地方拷贝数据并储存。
<span class="token operator">--</span>is<span class="token operator">-</span><span class="token keyword">public</span> <span class="token punctuation">[</span>True<span class="token operator">|</span>False<span class="token punctuation">]</span>　　　　　　　　　　　　　　　  #表示镜像是否能被公众访问。
<span class="token operator">--</span>is<span class="token operator">-</span><span class="token keyword">protected</span> <span class="token punctuation">[</span>True<span class="token operator">|</span>False<span class="token punctuation">]</span>　　　　　　　　　　　　　　#用于避免镜像被删除。
<span class="token operator">--</span>property <span class="token operator">&lt;</span>key<span class="token operator">=</span>value<span class="token operator">&gt;</span>　　　　　　　　　　　　　　　#与镜像有关的任意的属性。可以使用很多次。
<span class="token operator">--</span>human<span class="token operator">-</span>readable 　　　　　　　　　　　　　　　　    #用对人友好的格式打印镜像的尺寸。
<span class="token operator">--</span>progress 　　　　　　　　　　　　　　　　　　　　  #显示上传的进度条
</code></pre>
<p>首先获得admin权限</p>
<pre><code class="prism language-cpp">source admin<span class="token operator">-</span>openrc
</code></pre>
<p>上传ISO格式镜像：</p>
<pre><code class="prism language-cpp">glance image<span class="token operator">-</span>create <span class="token operator">--</span>name <span class="token string">"win7_xshell_iso"</span> <span class="token operator">--</span>file <span class="token operator">/</span>root<span class="token operator">/</span>image<span class="token operator">/</span> cn_windows_7_ultimate_with_sp1_x64_dvd_u_677408<span class="token punctuation">.</span>iso <span class="token operator">--</span>disk<span class="token operator">-</span>format iso <span class="token operator">--</span>container<span class="token operator">-</span>format bare <span class="token operator">--</span>visibility <span class="token keyword">public</span> <span class="token operator">--</span>progress
</code></pre>
<p><img src="https://img-blog.csdnimg.cn/715ade15f92d4a2cb14a19913725c3d0.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5byA5Y-R5bCP6bi9,size_19,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p>
<p>上传qcow2格式镜像：</p>
<pre><code class="prism language-cpp">glance image<span class="token operator">-</span>create <span class="token operator">--</span>name <span class="token string">"win7_xshell_qcow2"</span> <span class="token operator">--</span>file <span class="token operator">/</span>root<span class="token operator">/</span>image<span class="token operator">/</span> cn_windows_7_ultimate_with_sp1_x64_dvd_u_677408<span class="token punctuation">.</span>iso <span class="token operator">--</span>disk<span class="token operator">-</span>format qcow2 <span class="token operator">--</span>container<span class="token operator">-</span>format bare <span class="token operator">--</span>visibility <span class="token keyword">public</span> <span class="token operator">--</span>progress
</code></pre>
<p><img src="https://img-blog.csdnimg.cn/e0ad2e55c36f4a459b6ad5bb524efbff.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5byA5Y-R5bCP6bi9,size_19,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>
<br></p>
<h2><a id="6kvm_122"></a>6.部署kvm基本环境</h2>
<p>安装kvm核心包——虚拟操作系统模拟器加速模块</p>
<pre><code class="prism language-cpp">yum <span class="token operator">-</span>y install qemu<span class="token operator">-</span>kvm qemu<span class="token operator">-</span>kvm<span class="token operator">-</span>tools
</code></pre>
<p>安装kvm管理工具</p>
<pre><code class="prism language-cpp">yum <span class="token operator">-</span>y install libvirt libvirt<span class="token operator">-</span>python libguestfs<span class="token operator">-</span>tools
</code></pre>
<p>安装镜像安装程序virt-install</p>
<pre><code class="prism language-cpp">yum install <span class="token operator">-</span>y virt<span class="token operator">-</span>install
</code></pre>
<p>安装vncserver。使用vnc viewer连接完成虚拟机的图形化安装。</p>
<pre><code class="prism language-cpp">yum <span class="token operator">-</span>y install tigervnc<span class="token operator">-</span>server
</code></pre>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 虚拟机安装系统时会使用图形界面安装，主机安装vncserver，安装虚拟机时设置vnc client等远程连接虚拟机的端口，如5900,5901,5902，然后通过vnc client连接虚拟机进行系统的安装。</p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; vnc client用于远程连接vnc server。可以是windows下软件。如VNC viewer。viewer连接vnc server时需要保证服务器主机防火墙相关端口开放或者，暂时关闭防火墙。</p>
<pre><code class="prism language-cpp">systemctl stop firewalld
或是：
firewall<span class="token operator">-</span>cmd <span class="token operator">--</span>zone<span class="token operator">=</span><span class="token keyword">public</span> <span class="token operator">--</span>add<span class="token operator">-</span>port<span class="token operator">=</span><span class="token number">5900</span><span class="token operator">/</span>tcp <span class="token operator">--</span>permanent
firewall<span class="token operator">-</span>cmd <span class="token operator">--</span>reload
</code></pre>
<p>启动libvirtd管理程序：</p>
<pre><code class="prism language-cpp">systemctl enable libvirtd
systemctl start libvirtd
</code></pre>
<br>
<h2><a id="7Centosqcow2_170"></a>7.Centos系统qcow2格式镜像制作</h2>
<h3><a id="1_171"></a>（1）给虚拟机创建一个网络</h3>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 手动创建镜像需要确保libvirt运行有default网络，这个网络可以给虚拟机提供上网服务。</p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 查看当前是否启用default网络</p>
<pre><code class="prism language-cpp">virsh net<span class="token operator">-</span>list
</code></pre>
<p><img src="https://img-blog.csdnimg.cn/c00718011adf49048910b06c63afd12e.png" alt="在这里插入图片描述"></p>
<p>注：如果没有启用，使用以下命令启用default</p>
<pre><code class="prism language-cpp"> virsh net<span class="token operator">-</span>start <span class="token keyword">default</span>
</code></pre>
<br>
<h3><a id="2_193"></a>（2）创建虚拟机</h3>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 将iso镜像文件上传到/image目录下：<br>
<img src="https://img-blog.csdnimg.cn/83db24741d9b4b47a75b48f158c85054.png" alt="在这里插入图片描述"></p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 创建一个20G的qcow2格式的磁盘文件给虚拟机使用</p>
<pre><code class="prism language-cpp">qemu<span class="token operator">-</span>img create <span class="token operator">-</span>f qcow2 <span class="token operator">/</span>vhost<span class="token operator">/</span>centos7_x86_64<span class="token punctuation">.</span>qcow2 <span class="token number">20</span>G
</code></pre>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 安装centos7虚机</p>
<pre><code class="prism language-cpp">virt<span class="token operator">-</span>install <span class="token operator">--</span>virt<span class="token operator">-</span>type kvm <span class="token operator">--</span>name centos7_x86_64 <span class="token operator">--</span>ram <span class="token number">2048</span> <span class="token operator">--</span>disk <span class="token operator">/</span>vhost<span class="token operator">/</span>centos7_x86_64<span class="token punctuation">.</span>qcow2<span class="token punctuation">,</span>format<span class="token operator">=</span>qcow2 <span class="token operator">--</span>network network<span class="token operator">=</span><span class="token keyword">default</span> <span class="token operator">--</span>graphics vnc<span class="token punctuation">,</span>listen<span class="token operator">=</span><span class="token number">0.0</span><span class="token punctuation">.</span><span class="token number">0.0</span> <span class="token operator">--</span>noautoconsole <span class="token operator">--</span>os<span class="token operator">-</span>type<span class="token operator">=</span>linux <span class="token operator">--</span>location<span class="token operator">=</span><span class="token operator">/</span>image<span class="token operator">/</span>CentOS<span class="token operator">-</span><span class="token number">7</span><span class="token operator">-</span>x86_64<span class="token operator">-</span>DVD<span class="token operator">-</span><span class="token number">2009.</span>iso
</code></pre>
<p><img src="https://img-blog.csdnimg.cn/e7bbc600cbf744499a71f9065f6dd1c4.png" alt="在这里插入图片描述"></p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 查看刚刚通过kvm创建的虚机端口：</p>
<pre><code class="prism language-cpp">netstat <span class="token operator">-</span>lntup <span class="token operator">|</span> grep kvm
</code></pre>
<p><img src="https://img-blog.csdnimg.cn/670a152f8e70425abe84eb0d2a043720.png" alt="在这里插入图片描述"></p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 因此，可以推出当前的虚机连接地址为：192.168.112.146:5900，通过vnc client客户端连接到该地址中：</p>
<p><img src="https://img-blog.csdnimg.cn/a07bcfb4c97f4f8195e49cfcbd37240f.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5byA5Y-R5bCP6bi9,size_19,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 按照centos的安装方式安装minimal最小版本即可。</p>
<pre><code class="prism language-cpp">账户：root
密码：wangdage980204
</code></pre>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 在/root目录内创建一个test1文件，以检查后续再次通过该qcow2镜像创建虚机时是否为原来的镜像。</p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 注：只有配置了KVM虚拟机，libvirt就会生成一个与操作系统对应的xml文件，其记录了kvm虚拟机的状态。路径如下：/etc/libvirt/qemu/CentOS-6.6-x86_64.xml<br>
&nbsp;  &nbsp;  &nbsp;  &nbsp; 注：此文件只能通过“virsh edit”命令修改</p>
<p><img src="https://img-blog.csdnimg.cn/171cdc73f09f4787bc7de641cd80a3b2.png" alt="在这里插入图片描述"></p>
<br>
<h3><a id="3_247"></a>（3）启动与测试虚机</h3>
<p>查看当前的虚机情况：<br>
<img src="https://img-blog.csdnimg.cn/ee898976345d461db405ea6929c46c6d.png" alt="在这里插入图片描述"></p>
<p>启动虚机：</p>
<p><img src="https://img-blog.csdnimg.cn/5115c96da30742ff84812499f2e2f62f.png" alt="在这里插入图片描述"></p>
<p>关闭该虚机后，备份qcow2格式的镜像：<br>
<img src="https://img-blog.csdnimg.cn/e80078c4eb714ac6b05b3759cf61633e.png" alt="在这里插入图片描述"></p>
<br>
<h3><a id="4Controllerglance_265"></a>（4）Controller节点创建镜像到glance中</h3>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 将刚刚制作好的qcow2格式的centos7镜像上传到glance中：</p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp;   首先获得admin权限</p>
<pre><code class="prism language-cpp">source <span class="token operator">/</span>scripts<span class="token operator">/</span>admin<span class="token operator">-</span>openrc
</code></pre>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 上传镜像到glance中：</p>
<pre><code class="prism language-cpp">openstack image create <span class="token operator">--</span>file <span class="token operator">/</span>vhost<span class="token operator">/</span>centos7_x86_64<span class="token punctuation">.</span>qcow2 <span class="token operator">--</span>disk<span class="token operator">-</span>format qcow2 <span class="token operator">--</span>container<span class="token operator">-</span>format bare <span class="token operator">--</span><span class="token keyword">public</span> centos7_x86_64
</code></pre>
<p><img src="https://img-blog.csdnimg.cn/22f75c2c56bf45a0865d83d2d358c728.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5byA5Y-R5bCP6bi9,size_19,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 查看当前的image镜像情况：</p>
<p><img src="https://img-blog.csdnimg.cn/0b463852cc1248128e7eff01f8f57182.png" alt="在这里插入图片描述"></p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp;  查看Image对应的物理文件，在默认的images存储目录/var/lib/glance/images下：</p>
<pre><code class="prism language-cpp">ll <span class="token operator">/</span>var<span class="token operator">/</span>lib<span class="token operator">/</span>glance<span class="token operator">/</span>images
</code></pre>
<br>
<h3><a id="5dashboard_299"></a>（5）通过dashboard测试创建实例</h3>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 通过dashboard的镜像界面创建一个实例，但是首先需要创建一个实例类型<br>
<img src="https://img-blog.csdnimg.cn/211634c9fd714fe6a13e4f52193407dc.png" alt="在这里插入图片描述"></p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 我们设定为2核，2G内存，20G磁盘的实例类型。<br>
<img src="https://img-blog.csdnimg.cn/2e76ec1e7e2849c4a5d24de129a61ead.png" alt="在这里插入图片描述"></p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 然后通过之前上传的centos7镜像创建一个实例：</p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 我们可以通过控制台连接到该实例中，查看该实例中的test1文件是否存在，如果存在则说明是之前创建的qcow2格式的镜像：<br>
<img src="https://img-blog.csdnimg.cn/a3e067f3e8db41d38ca1a26ca53d40aa.png" alt="在这里插入图片描述"><br>
<br></p>
<h3><a id="6_317"></a>（6）通过命令创建单实例</h3>
<pre><code class="prism language-cpp">openstack server create <span class="token operator">--</span>image centos7_x86_64 <span class="token operator">--</span>flavor centos7 centos7_2
</code></pre>
<p><img src="https://img-blog.csdnimg.cn/0e245bc3cb4648fba80ca69b5030dfdc.png" alt="在这里插入图片描述"></p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 通过命令行创建的方式更加稳定，通过web界面会出现多次创建失败的问题。<br>
<br></p>
<h3><a id="7_331"></a>（7）通过同一个镜像创建新的实例</h3>
<pre><code class="prism language-cpp">openstack server create <span class="token operator">--</span>image centos7_x86_64 <span class="token operator">--</span>flavor centos7 centos7_2
</code></pre>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 很明显，通过同一个镜像创建新的实例是失败的：<br>
<img src="https://img-blog.csdnimg.cn/7acfb36058684af58949ceb75d585925.png" alt="在这里插入图片描述"><br>
<br></p>
<h3><a id="8_344"></a>（8）复制新的镜像创建新的实例</h3>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 从原有的qcow2格式的镜像中向glance中提交新的qcow2格式的镜像</p>
<pre><code class="prism language-cpp">openstack image create <span class="token operator">--</span>file <span class="token operator">/</span>vhost<span class="token operator">/</span>centos7_x86_64<span class="token punctuation">.</span>qcow2 <span class="token operator">--</span>disk<span class="token operator">-</span>format qcow2 <span class="token operator">--</span>container<span class="token operator">-</span>format bare <span class="token operator">--</span><span class="token keyword">public</span> centos7_x86_64_2
</code></pre>
<p><img src="https://img-blog.csdnimg.cn/ca0ec74809154a19b3f9b503004cf756.png" alt="在这里插入图片描述"></p>
<pre><code class="prism language-cpp">openstack server create <span class="token operator">--</span>image centos7_x86_64_2 <span class="token operator">--</span>flavor centos7 centos7_2
</code></pre>
<p>结果依然是创建失败：<br>
<img src="https://img-blog.csdnimg.cn/588a2eaed3eb46bea7000b0e6a78bc62.png" alt="在这里插入图片描述"></p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 这是因为不能从同一个qcow2格式的镜像上传到glance中作为两个镜像吗？我们通过同一个qcow2格式的镜像向glance中提交了两个镜像，第一个镜像是创建成功的，第二个创建失败的。<br>
<br></p>
<h3><a id="9qcow2glance_368"></a>（9）复制qcow2格式镜像重新上传到glance中</h3>
<p><img src="https://img-blog.csdnimg.cn/eff0e53285554927a7e8bd06999b8b05.png" alt="在这里插入图片描述"></p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 通过新的qcow2格式镜像提交到glance中：</p>
<pre><code class="prism language-cpp">openstack image create <span class="token operator">--</span>file <span class="token operator">/</span>vhost<span class="token operator">/</span>centos7_x86_64_2<span class="token punctuation">.</span>qcow2 <span class="token operator">--</span>disk<span class="token operator">-</span>format qcow2 <span class="token operator">--</span>container<span class="token operator">-</span>format bare <span class="token operator">--</span><span class="token keyword">public</span> centos7_x86_64_2
</code></pre>
<p><img src="https://img-blog.csdnimg.cn/2f0f4b470e5a44e1abc1dae982f3839e.png" alt="在这里插入图片描述"></p>
<pre><code class="prism language-cpp">openstack server create <span class="token operator">--</span>image centos7_x86_64_2 <span class="token operator">--</span>flavor centos7 centos7_2
</code></pre>
<p><img src="https://img-blog.csdnimg.cn/453a132bc35f4fd585aa0ac2ac173151.png" alt="在这里插入图片描述"><br>
<br></p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 依然创建失败，这两个qcow2格式的文件都不一样，为啥还出错呢？</p>
<h3><a id="10qcow2qcow2_396"></a>（10）在qcow2格式基础镜像的基础上创建新的qcow2格式的镜像</h3>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 查看当前的qcow2格式的镜像：<br>
<img src="https://img-blog.csdnimg.cn/3463edd37b8443ba8313ed8e7e2e7e0d.png" alt="在这里插入图片描述"></p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 可以看出，当前的qcow2格式的镜像文件的虚拟大小为20G，磁盘大小为1.6G。</p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 以该镜像为基础镜像创建新的qcow2格式的镜像：</p>
<pre><code class="prism language-cpp">qemu<span class="token operator">-</span>img create <span class="token operator">-</span>b centos7_x86_64<span class="token punctuation">.</span>qcow2 <span class="token operator">-</span>f  qcow2   centos7_x86_64_2<span class="token punctuation">.</span>qcow2
</code></pre>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 查看该新镜像的信息：<br>
<img src="https://img-blog.csdnimg.cn/06f7fdc0053844f589cd8b3ff4d83a49.png" alt="在这里插入图片描述"></p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 可以看到，发现该镜像是引用基础的镜像centos_x86_64.qcow2，同时它的磁盘大小也只有196k。这是增量镜像，类似于增量备份，或者copy on write。首先我们创建一个镜像文件A，在A上安装一个全新的操作系统。之后通过镜像A创建一个镜像B，从这一刻开始，A上只会发生读操作，数据写入到B镜像中。</p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 因此，基础镜像是不能删除的，删除了之后以该基础镜像为基础的其他镜像都会失效。<br>
<br></p>
<h3><a id="11glance_421"></a>（11）通过该新的增量镜像上传到glance中</h3>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 上传镜像到glance中：</p>
<pre><code class="prism language-cpp">openstack image create <span class="token operator">--</span>file <span class="token operator">/</span>vhost<span class="token operator">/</span>centos7_x86_64_2<span class="token punctuation">.</span>qcow2 <span class="token operator">--</span>disk<span class="token operator">-</span>format qcow2 <span class="token operator">--</span>container<span class="token operator">-</span>format bare <span class="token operator">--</span><span class="token keyword">public</span> centos7_x86_64_2
</code></pre>
<p><img src="https://img-blog.csdnimg.cn/c67eba51813741869d5793af78adc281.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5byA5Y-R5bCP6bi9,size_19,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"><br>
<br></p>
<h3><a id="12_436"></a>（12）测试通过该新的镜像创建实例</h3>
<pre><code class="prism language-cpp">openstack server create <span class="token operator">--</span>image centos7_x86_64_2 <span class="token operator">--</span>flavor centos7 centos7_2
</code></pre>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 同样是创建失败？这是为什么呢？<br>
&nbsp;  &nbsp;  &nbsp;  &nbsp; 思考发现，使用的是centos7这个flavor，这个flavor的格式是2G，2核CPU，20G的磁盘，我的Compute节点使用的是4G内存，因此这个内存空间是不足的，所以创建总是会失败。</p>
<p><img src="https://img-blog.csdnimg.cn/8fbb312f0ebd45599e79cda1a974d7d2.png" alt="在这里插入图片描述"><br>
<br></p>
<h3><a id="13flavor_452"></a>（13）创建新的flavor后继续创建虚机</h3>
<pre><code class="prism language-cpp">openstack flavor create <span class="token operator">--</span>ram <span class="token number">1024</span> <span class="token operator">--</span>disk <span class="token number">20</span> <span class="token operator">--</span>vcpus <span class="token number">1</span> <span class="token operator">--</span>id <span class="token number">3</span> centos72
</code></pre>
<p><img src="https://img-blog.csdnimg.cn/da3c95b053fe47ddb06363acdc6d7939.png" alt="在这里插入图片描述"></p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 查看当前的flavor的列表：<br>
<img src="https://img-blog.csdnimg.cn/f184bd008a8e4ef0b0ba6a193b8b80cc.png" alt="在这里插入图片描述"></p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 重新尝试创建虚机，但是使用的是新的flavor：</p>
<pre><code class="prism language-cpp">openstack server create <span class="token operator">--</span>image centos7_x86_64_2 <span class="token operator">--</span>flavor centos72  centos7_new
</code></pre>
<p><img src="https://img-blog.csdnimg.cn/af3397cf14164e3db15102589bc413cd.png" alt="在这里插入图片描述"></p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 依然出现error状态；</p>
<br>
<h3><a id="14nova_480"></a>（14）查看nova日志</h3>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; Controller节点和Compute节点中都有nova日志，首先查看Controller节点中的nova日志：<br>
<img src="https://img-blog.csdnimg.cn/2eea3f5ee08e4eb88014f024e0465386.png" alt="在这里插入图片描述"></p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 我们需要对nova-api.log日志好好分析一下：</p>
<p>如下命令<br>
openstack server list，查询实例列表</p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 对应着nova-api.log中的如下两行，一行是查询server，另一行是查询flavor：</p>
<pre><code class="prism language-cpp"><span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">19</span><span class="token operator">:</span><span class="token number">24</span><span class="token operator">:</span><span class="token number">30.891</span> <span class="token number">2252</span> INFO nova<span class="token punctuation">.</span>osapi_compute<span class="token punctuation">.</span>wsgi<span class="token punctuation">.</span>server <span class="token punctuation">[</span>req<span class="token operator">-</span><span class="token number">0</span>c90b8ee<span class="token operator">-</span><span class="token number">66</span>eb<span class="token operator">-</span><span class="token number">4</span>ca9<span class="token operator">-</span><span class="token number">9</span>c4b<span class="token operator">-</span>d3e465211ec6 <span class="token number">9942</span>eb4321644336a0c7383d9f1c2bed a7d812868cb74f1a978035530f55f1d0 <span class="token operator">-</span> <span class="token keyword">default</span> <span class="token keyword">default</span><span class="token punctuation">]</span> <span class="token number">192.168</span><span class="token punctuation">.</span><span class="token number">112.146</span> <span class="token string">"GET /v2.1/servers/detail HTTP/1.1"</span> status<span class="token operator">:</span> <span class="token number">200</span> len<span class="token operator">:</span> <span class="token number">4801</span> time<span class="token operator">:</span> <span class="token number">0.6548059</span>
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">19</span><span class="token operator">:</span><span class="token number">24</span><span class="token operator">:</span><span class="token number">30.949</span> <span class="token number">2252</span> INFO nova<span class="token punctuation">.</span>osapi_compute<span class="token punctuation">.</span>wsgi<span class="token punctuation">.</span>server <span class="token punctuation">[</span>req<span class="token operator">-</span><span class="token number">9</span>afe362e<span class="token operator">-</span><span class="token number">35e6</span><span class="token operator">-</span><span class="token number">451</span>c<span class="token operator">-</span>bb98<span class="token operator">-</span><span class="token number">21</span>ead6db2dd3 <span class="token number">9942</span>eb4321644336a0c7383d9f1c2bed a7d812868cb74f1a978035530f55f1d0 <span class="token operator">-</span> <span class="token keyword">default</span> <span class="token keyword">default</span><span class="token punctuation">]</span> <span class="token number">192.168</span><span class="token punctuation">.</span><span class="token number">112.146</span> <span class="token string">"GET /v2.1/flavors/detail?is_public=None HTTP/1.1"</span> status<span class="token operator">:</span> <span class="token number">200</span> len<span class="token operator">:</span> <span class="token number">1479</span> time<span class="token operator">:</span> <span class="token number">0.0143611</span>
</code></pre>
<p>删除实例的命令：<br>
openstack server delete centos7_new，对应如下的日志：</p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 删除一个实例对应的nova-api中的日志为如下所示，首先查找的是centos7_new实例，为啥没有找到？<br>
&nbsp;  &nbsp;  &nbsp;  &nbsp; 然后通过get方法查询/v2.1/servers/centos7_new，状态码是404说明没有找到；<br>
&nbsp;  &nbsp;  &nbsp;  &nbsp; 然后通过get方法查询/v2.1/servers?name=centos7_new，状态码是200，说明找到了；<br>
&nbsp;  &nbsp;  &nbsp;  &nbsp; 然后通过get方法查询/v2.1/servers/7ac8e2f0-0bb1-4e48-b0cf-00de7e050c1c，后面的已传字符是实例的编号，状态码是200，说明找到了；<br>
&nbsp;  &nbsp;  &nbsp;  &nbsp; 最后通过delete方法删除/v2.1/servers/7ac8e2f0-0bb1-4e48-b0cf-00de7e050c1c，状态码是204，说明没有返回内容；</p>
<pre><code class="prism language-cpp"><span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">19</span><span class="token operator">:</span><span class="token number">33</span><span class="token operator">:</span><span class="token number">35.449</span> <span class="token number">2255</span> INFO nova<span class="token punctuation">.</span>api<span class="token punctuation">.</span>openstack<span class="token punctuation">.</span>wsgi <span class="token punctuation">[</span>req<span class="token operator">-</span>feb51187<span class="token operator">-</span><span class="token number">0712</span><span class="token operator">-</span><span class="token number">4</span>ebe<span class="token operator">-</span><span class="token number">9861</span><span class="token operator">-</span><span class="token number">0b0</span>60e135a56 <span class="token number">9942</span>eb4321644336a0c7383d9f1c2bed a7d812868cb74f1a978035530f55f1d0 <span class="token operator">-</span> <span class="token keyword">default</span> <span class="token keyword">default</span><span class="token punctuation">]</span> HTTP exception thrown<span class="token operator">:</span> 实例 centos7_new 没有找到。
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">19</span><span class="token operator">:</span><span class="token number">33</span><span class="token operator">:</span><span class="token number">35.450</span> <span class="token number">2255</span> INFO nova<span class="token punctuation">.</span>osapi_compute<span class="token punctuation">.</span>wsgi<span class="token punctuation">.</span>server <span class="token punctuation">[</span>req<span class="token operator">-</span>feb51187<span class="token operator">-</span><span class="token number">0712</span><span class="token operator">-</span><span class="token number">4</span>ebe<span class="token operator">-</span><span class="token number">9861</span><span class="token operator">-</span><span class="token number">0b0</span>60e135a56 <span class="token number">9942</span>eb4321644336a0c7383d9f1c2bed a7d812868cb74f1a978035530f55f1d0 <span class="token operator">-</span> <span class="token keyword">default</span> <span class="token keyword">default</span><span class="token punctuation">]</span> <span class="token number">192.168</span><span class="token punctuation">.</span><span class="token number">112.146</span> <span class="token string">"GET /v2.1/servers/centos7_new HTTP/1.1"</span> status<span class="token operator">:</span> <span class="token number">404</span> len<span class="token operator">:</span> <span class="token number">522</span> time<span class="token operator">:</span> <span class="token number">0.2160928</span>
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">19</span><span class="token operator">:</span><span class="token number">33</span><span class="token operator">:</span><span class="token number">35.561</span> <span class="token number">2255</span> INFO nova<span class="token punctuation">.</span>osapi_compute<span class="token punctuation">.</span>wsgi<span class="token punctuation">.</span>server <span class="token punctuation">[</span>req<span class="token operator">-</span><span class="token number">65e9</span>a8f7<span class="token operator">-</span><span class="token number">0</span>ee7<span class="token operator">-</span><span class="token number">4</span>ab3<span class="token operator">-</span><span class="token number">968</span>d<span class="token operator">-</span><span class="token number">3</span>a33653aa71b <span class="token number">9942</span>eb4321644336a0c7383d9f1c2bed a7d812868cb74f1a978035530f55f1d0 <span class="token operator">-</span> <span class="token keyword">default</span> <span class="token keyword">default</span><span class="token punctuation">]</span> <span class="token number">192.168</span><span class="token punctuation">.</span><span class="token number">112.146</span> <span class="token string">"GET /v2.1/servers?name=centos7_new HTTP/1.1"</span> status<span class="token operator">:</span> <span class="token number">200</span> len<span class="token operator">:</span> <span class="token number">705</span> time<span class="token operator">:</span> <span class="token number">0.1083212</span>
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">19</span><span class="token operator">:</span><span class="token number">33</span><span class="token operator">:</span><span class="token number">35.645</span> <span class="token number">2255</span> INFO nova<span class="token punctuation">.</span>osapi_compute<span class="token punctuation">.</span>wsgi<span class="token punctuation">.</span>server <span class="token punctuation">[</span>req<span class="token operator">-</span><span class="token number">3</span>ab6a065<span class="token operator">-</span><span class="token number">810</span>a<span class="token operator">-</span><span class="token number">4</span>cbc<span class="token operator">-</span><span class="token number">8</span>a8b<span class="token operator">-</span><span class="token number">09124</span>c4da408 <span class="token number">9942</span>eb4321644336a0c7383d9f1c2bed a7d812868cb74f1a978035530f55f1d0 <span class="token operator">-</span> <span class="token keyword">default</span> <span class="token keyword">default</span><span class="token punctuation">]</span> <span class="token number">192.168</span><span class="token punctuation">.</span><span class="token number">112.146</span> <span class="token string">"GET /v2.1/servers/7ac8e2f0-0bb1-4e48-b0cf-00de7e050c1c HTTP/1.1"</span> status<span class="token operator">:</span> <span class="token number">200</span> len<span class="token operator">:</span> <span class="token number">4267</span> time<span class="token operator">:</span> <span class="token number">0.0799270</span>
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">19</span><span class="token operator">:</span><span class="token number">33</span><span class="token operator">:</span><span class="token number">35.742</span> <span class="token number">2255</span> WARNING nova<span class="token punctuation">.</span>compute<span class="token punctuation">.</span>api <span class="token punctuation">[</span>req<span class="token operator">-</span><span class="token number">55</span>be22b0<span class="token operator">-</span><span class="token number">898</span>b<span class="token operator">-</span><span class="token number">426f</span><span class="token operator">-</span>b382<span class="token operator">-</span><span class="token number">119f</span>60c43d74 <span class="token number">9942</span>eb4321644336a0c7383d9f1c2bed a7d812868cb74f1a978035530f55f1d0 <span class="token operator">-</span> <span class="token keyword">default</span> <span class="token keyword">default</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>instance<span class="token operator">:</span> <span class="token number">7</span>ac8e2f0<span class="token operator">-</span><span class="token number">0</span>bb1<span class="token operator">-</span><span class="token number">4e48</span><span class="token operator">-</span>b0cf<span class="token operator">-</span><span class="token number">00</span>de7e050c1c<span class="token punctuation">]</span> instance<span class="token number">'</span>s host None is down<span class="token punctuation">,</span> deleting from database
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">19</span><span class="token operator">:</span><span class="token number">33</span><span class="token operator">:</span><span class="token number">36.456</span> <span class="token number">2255</span> INFO nova<span class="token punctuation">.</span>osapi_compute<span class="token punctuation">.</span>wsgi<span class="token punctuation">.</span>server <span class="token punctuation">[</span>req<span class="token operator">-</span><span class="token number">55</span>be22b0<span class="token operator">-</span><span class="token number">898</span>b<span class="token operator">-</span><span class="token number">426f</span><span class="token operator">-</span>b382<span class="token operator">-</span><span class="token number">119f</span>60c43d74 <span class="token number">9942</span>eb4321644336a0c7383d9f1c2bed a7d812868cb74f1a978035530f55f1d0 <span class="token operator">-</span> <span class="token keyword">default</span> <span class="token keyword">default</span><span class="token punctuation">]</span> <span class="token number">192.168</span><span class="token punctuation">.</span><span class="token number">112.146</span> <span class="token string">"DELETE /v2.1/servers/7ac8e2f0-0bb1-4e48-b0cf-00de7e050c1c HTTP/1.1"</span> status<span class="token operator">:</span> <span class="token number">204</span> len<span class="token operator">:</span> <span class="token number">405</span> time<span class="token operator">:</span> <span class="token number">0.8070309</span>
</code></pre>
<p>创建虚机的命令如下所示：</p>
<pre><code class="prism language-cpp">openstack server create <span class="token operator">--</span>image centos7_x86_64_2 <span class="token operator">--</span>flavor centos72  centos7_new
</code></pre>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 查询flavor的list，状态码是200；<br>
&nbsp;  &nbsp;  &nbsp;  &nbsp; 查询云主机类型centos72，却没有找到；<br>
&nbsp;  &nbsp;  &nbsp;  &nbsp; 通过get方法查询/v2.1/flavors/centos72，状态码是404说明没有找到；<br>
&nbsp;  &nbsp;  &nbsp;  &nbsp; 通过get方法查询/v2.1/flavors，状态码是200；<br>
&nbsp;  &nbsp;  &nbsp;  &nbsp; 通过post方法上传实例到/v2.1/servers，状态码是202表示是异步处理；<br>
&nbsp;  &nbsp;  &nbsp;  &nbsp; 通过get方法查询server状态/v2.1/servers/a275a604-84f0-43f4-98d1-7cc3bbbb0903，状态码是200；<br>
&nbsp;  &nbsp;  &nbsp;  &nbsp; 通过get方法查询指定的id为3的flavor，/v2.1/flavors/3，状态码是200；</p>
<pre><code class="prism language-cpp"><span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">19</span><span class="token operator">:</span><span class="token number">51</span><span class="token operator">:</span><span class="token number">48.612</span> <span class="token number">2254</span> INFO nova<span class="token punctuation">.</span>osapi_compute<span class="token punctuation">.</span>wsgi<span class="token punctuation">.</span>server <span class="token punctuation">[</span>req<span class="token operator">-</span><span class="token number">196</span>b6d50<span class="token operator">-</span>aed7<span class="token operator">-</span><span class="token number">4476</span><span class="token operator">-</span>bc53<span class="token operator">-</span><span class="token number">59</span>ad2f6d96a9 <span class="token number">9942</span>eb4321644336a0c7383d9f1c2bed a7d812868cb74f1a978035530f55f1d0 <span class="token operator">-</span> <span class="token keyword">default</span> <span class="token keyword">default</span><span class="token punctuation">]</span> <span class="token number">192.168</span><span class="token punctuation">.</span><span class="token number">112.146</span> <span class="token string">"GET /v2.1/flavors/detail HTTP/1.1"</span> status<span class="token operator">:</span> <span class="token number">200</span> len<span class="token operator">:</span> <span class="token number">1479</span> time<span class="token operator">:</span> <span class="token number">0.2345939</span>
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">20</span><span class="token operator">:</span><span class="token number">01</span><span class="token operator">:</span><span class="token number">58.911</span> <span class="token number">2253</span> INFO nova<span class="token punctuation">.</span>api<span class="token punctuation">.</span>openstack<span class="token punctuation">.</span>wsgi <span class="token punctuation">[</span>req<span class="token operator">-</span>ce277c0e<span class="token operator">-</span>ac19<span class="token operator">-</span><span class="token number">4358</span><span class="token operator">-</span>bf26<span class="token operator">-</span>c67ac8199a52 <span class="token number">9942</span>eb4321644336a0c7383d9f1c2bed a7d812868cb74f1a978035530f55f1d0 <span class="token operator">-</span> <span class="token keyword">default</span> <span class="token keyword">default</span><span class="token punctuation">]</span> HTTP exception thrown<span class="token operator">:</span> 云主机类型 centos72 没有找到。
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">20</span><span class="token operator">:</span><span class="token number">01</span><span class="token operator">:</span><span class="token number">58.912</span> <span class="token number">2253</span> INFO nova<span class="token punctuation">.</span>osapi_compute<span class="token punctuation">.</span>wsgi<span class="token punctuation">.</span>server <span class="token punctuation">[</span>req<span class="token operator">-</span>ce277c0e<span class="token operator">-</span>ac19<span class="token operator">-</span><span class="token number">4358</span><span class="token operator">-</span>bf26<span class="token operator">-</span>c67ac8199a52 <span class="token number">9942</span>eb4321644336a0c7383d9f1c2bed a7d812868cb74f1a978035530f55f1d0 <span class="token operator">-</span> <span class="token keyword">default</span> <span class="token keyword">default</span><span class="token punctuation">]</span> <span class="token number">192.168</span><span class="token punctuation">.</span><span class="token number">112.146</span> <span class="token string">"GET /v2.1/flavors/centos72 HTTP/1.1"</span> status<span class="token operator">:</span> <span class="token number">404</span> len<span class="token operator">:</span> <span class="token number">537</span> time<span class="token operator">:</span> <span class="token number">0.0172770</span>
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">20</span><span class="token operator">:</span><span class="token number">01</span><span class="token operator">:</span><span class="token number">58.928</span> <span class="token number">2253</span> INFO nova<span class="token punctuation">.</span>osapi_compute<span class="token punctuation">.</span>wsgi<span class="token punctuation">.</span>server <span class="token punctuation">[</span>req<span class="token operator">-</span><span class="token number">707e4</span>e40<span class="token operator">-</span><span class="token number">0561</span><span class="token operator">-</span><span class="token number">48</span>b4<span class="token operator">-</span><span class="token number">896</span>d<span class="token operator">-</span><span class="token number">646</span>d1cd7bd59 <span class="token number">9942</span>eb4321644336a0c7383d9f1c2bed a7d812868cb74f1a978035530f55f1d0 <span class="token operator">-</span> <span class="token keyword">default</span> <span class="token keyword">default</span><span class="token punctuation">]</span> <span class="token number">192.168</span><span class="token punctuation">.</span><span class="token number">112.146</span> <span class="token string">"GET /v2.1/flavors HTTP/1.1"</span> status<span class="token operator">:</span> <span class="token number">200</span> len<span class="token operator">:</span> <span class="token number">965</span> time<span class="token operator">:</span> <span class="token number">0.0131981</span>
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">20</span><span class="token operator">:</span><span class="token number">01</span><span class="token operator">:</span><span class="token number">58.942</span> <span class="token number">2253</span> INFO nova<span class="token punctuation">.</span>osapi_compute<span class="token punctuation">.</span>wsgi<span class="token punctuation">.</span>server <span class="token punctuation">[</span>req<span class="token operator">-</span>a1ec74e0<span class="token operator">-</span><span class="token number">1377</span><span class="token operator">-</span><span class="token number">4</span>c77<span class="token operator">-</span>ac4e<span class="token operator">-</span><span class="token number">0</span>ca6ff1be1b8 <span class="token number">9942</span>eb4321644336a0c7383d9f1c2bed a7d812868cb74f1a978035530f55f1d0 <span class="token operator">-</span> <span class="token keyword">default</span> <span class="token keyword">default</span><span class="token punctuation">]</span> <span class="token number">192.168</span><span class="token punctuation">.</span><span class="token number">112.146</span> <span class="token string">"GET /v2.1/flavors/3 HTTP/1.1"</span> status<span class="token operator">:</span> <span class="token number">200</span> len<span class="token operator">:</span> <span class="token number">766</span> time<span class="token operator">:</span> <span class="token number">0.0103431</span>
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">20</span><span class="token operator">:</span><span class="token number">01</span><span class="token operator">:</span><span class="token number">59.407</span> <span class="token number">2253</span> INFO nova<span class="token punctuation">.</span>osapi_compute<span class="token punctuation">.</span>wsgi<span class="token punctuation">.</span>server <span class="token punctuation">[</span>req<span class="token operator">-</span><span class="token number">63</span>b82c1f<span class="token operator">-</span><span class="token number">1f</span>5e<span class="token operator">-</span><span class="token number">492e-9</span>b66<span class="token operator">-</span>dc761f45164c <span class="token number">9942</span>eb4321644336a0c7383d9f1c2bed a7d812868cb74f1a978035530f55f1d0 <span class="token operator">-</span> <span class="token keyword">default</span> <span class="token keyword">default</span><span class="token punctuation">]</span> <span class="token number">192.168</span><span class="token punctuation">.</span><span class="token number">112.146</span> <span class="token string">"POST /v2.1/servers HTTP/1.1"</span> status<span class="token operator">:</span> <span class="token number">202</span> len<span class="token operator">:</span> <span class="token number">876</span> time<span class="token operator">:</span> <span class="token number">0.4548001</span>
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">20</span><span class="token operator">:</span><span class="token number">01</span><span class="token operator">:</span><span class="token number">59.457</span> <span class="token number">2253</span> INFO nova<span class="token punctuation">.</span>osapi_compute<span class="token punctuation">.</span>wsgi<span class="token punctuation">.</span>server <span class="token punctuation">[</span>req<span class="token operator">-</span><span class="token number">5f</span>961569<span class="token operator">-</span>c5ff<span class="token operator">-</span><span class="token number">4</span>b0f<span class="token operator">-</span>aefb<span class="token operator">-</span>bc3e36d452fd <span class="token number">9942</span>eb4321644336a0c7383d9f1c2bed a7d812868cb74f1a978035530f55f1d0 <span class="token operator">-</span> <span class="token keyword">default</span> <span class="token keyword">default</span><span class="token punctuation">]</span> <span class="token number">192.168</span><span class="token punctuation">.</span><span class="token number">112.146</span> <span class="token string">"GET /v2.1/servers/a275a604-84f0-43f4-98d1-7cc3bbbb0903 HTTP/1.1"</span> status<span class="token operator">:</span> <span class="token number">200</span> len<span class="token operator">:</span> <span class="token number">1691</span> time<span class="token operator">:</span> <span class="token number">0.0470769</span>
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">20</span><span class="token operator">:</span><span class="token number">01</span><span class="token operator">:</span><span class="token number">59.484</span> <span class="token number">2253</span> INFO nova<span class="token punctuation">.</span>osapi_compute<span class="token punctuation">.</span>wsgi<span class="token punctuation">.</span>server <span class="token punctuation">[</span>req<span class="token operator">-</span><span class="token number">526091</span>aa<span class="token operator">-</span><span class="token number">08</span>ee<span class="token operator">-</span><span class="token number">4</span>c28<span class="token operator">-</span><span class="token number">9</span>df1<span class="token operator">-</span>c0d531ac94d5 <span class="token number">9942</span>eb4321644336a0c7383d9f1c2bed a7d812868cb74f1a978035530f55f1d0 <span class="token operator">-</span> <span class="token keyword">default</span> <span class="token keyword">default</span><span class="token punctuation">]</span> <span class="token number">192.168</span><span class="token punctuation">.</span><span class="token number">112.146</span> <span class="token string">"GET /v2.1/flavors/3 HTTP/1.1"</span> status<span class="token operator">:</span> <span class="token number">200</span> len<span class="token operator">:</span> <span class="token number">766</span> time<span class="token operator">:</span> <span class="token number">0.0102990</span>
</code></pre>
<br>
<h3><a id="15image_546"></a>（15）查看image日志</h3>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 在Controller节点查看/var/log/glance/api.log日志，即镜像的日志，得到如下的结果：<br>
&nbsp;  &nbsp;  &nbsp;  &nbsp; 通过get方法查询/v2/images/centos7_x86_64_2，即使用的image镜像是什么；</p>
<pre><code class="prism language-cpp"><span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">20</span><span class="token operator">:</span><span class="token number">01</span><span class="token operator">:</span><span class="token number">58.868</span> <span class="token number">2200</span> INFO eventlet<span class="token punctuation">.</span>wsgi<span class="token punctuation">.</span>server <span class="token punctuation">[</span>req<span class="token operator">-</span><span class="token number">837</span>eac44<span class="token operator">-</span>cc2f<span class="token operator">-</span><span class="token number">4f</span>8e<span class="token operator">-</span><span class="token number">9913</span><span class="token operator">-</span><span class="token number">796</span>cc0721877 <span class="token number">9942</span>eb4321644336a0c7383d9f1c2bed a7d812868cb74f1a978035530f55f1d0 <span class="token operator">-</span> <span class="token keyword">default</span> <span class="token keyword">default</span><span class="token punctuation">]</span> <span class="token number">192.168</span><span class="token punctuation">.</span><span class="token number">112.146</span> <span class="token operator">-</span> <span class="token operator">-</span> <span class="token punctuation">[</span><span class="token number">17</span><span class="token operator">/</span>Sep<span class="token operator">/</span><span class="token number">2021</span> <span class="token number">20</span><span class="token operator">:</span><span class="token number">01</span><span class="token operator">:</span><span class="token number">58</span><span class="token punctuation">]</span> <span class="token string">"GET /v2/images/centos7_x86_64_2 HTTP/1.1"</span> <span class="token number">404</span> <span class="token number">450</span> <span class="token number">0.238023</span>
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">20</span><span class="token operator">:</span><span class="token number">01</span><span class="token operator">:</span><span class="token number">58.885</span> <span class="token number">2200</span> INFO eventlet<span class="token punctuation">.</span>wsgi<span class="token punctuation">.</span>server <span class="token punctuation">[</span>req<span class="token operator">-</span><span class="token number">9ff</span>3b12d<span class="token operator">-</span>d3b8<span class="token operator">-</span><span class="token number">4443</span><span class="token operator">-</span>b7ce<span class="token operator">-</span>b2a8f21d3581 <span class="token number">9942</span>eb4321644336a0c7383d9f1c2bed a7d812868cb74f1a978035530f55f1d0 <span class="token operator">-</span> <span class="token keyword">default</span> <span class="token keyword">default</span><span class="token punctuation">]</span> <span class="token number">192.168</span><span class="token punctuation">.</span><span class="token number">112.146</span> <span class="token operator">-</span> <span class="token operator">-</span> <span class="token punctuation">[</span><span class="token number">17</span><span class="token operator">/</span>Sep<span class="token operator">/</span><span class="token number">2021</span> <span class="token number">20</span><span class="token operator">:</span><span class="token number">01</span><span class="token operator">:</span><span class="token number">58</span><span class="token punctuation">]</span> <span class="token string">"GET /v2/images?limit=20 HTTP/1.1"</span> <span class="token number">200</span> <span class="token number">2637</span> <span class="token number">0.015316</span>
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">20</span><span class="token operator">:</span><span class="token number">01</span><span class="token operator">:</span><span class="token number">58.890</span> <span class="token number">2200</span> INFO eventlet<span class="token punctuation">.</span>wsgi<span class="token punctuation">.</span>server <span class="token punctuation">[</span>req<span class="token operator">-</span><span class="token number">2</span>cb129aa<span class="token operator">-</span>d608<span class="token operator">-</span><span class="token number">4</span>b6a<span class="token operator">-</span><span class="token number">8508</span><span class="token operator">-</span><span class="token number">2</span>d4fa267ce69 <span class="token number">9942</span>eb4321644336a0c7383d9f1c2bed a7d812868cb74f1a978035530f55f1d0 <span class="token operator">-</span> <span class="token keyword">default</span> <span class="token keyword">default</span><span class="token punctuation">]</span> <span class="token number">192.168</span><span class="token punctuation">.</span><span class="token number">112.146</span> <span class="token operator">-</span> <span class="token operator">-</span> <span class="token punctuation">[</span><span class="token number">17</span><span class="token operator">/</span>Sep<span class="token operator">/</span><span class="token number">2021</span> <span class="token number">20</span><span class="token operator">:</span><span class="token number">01</span><span class="token operator">:</span><span class="token number">58</span><span class="token punctuation">]</span> <span class="token string">"GET /v2/schemas/image HTTP/1.1"</span> <span class="token number">200</span> <span class="token number">6925</span> <span class="token number">0.002258</span>
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">20</span><span class="token operator">:</span><span class="token number">01</span><span class="token operator">:</span><span class="token number">59.122</span> <span class="token number">2200</span> INFO eventlet<span class="token punctuation">.</span>wsgi<span class="token punctuation">.</span>server <span class="token punctuation">[</span>req<span class="token operator">-</span><span class="token number">8f</span>ce43e8<span class="token operator">-</span><span class="token number">3</span>b25<span class="token operator">-</span><span class="token number">41f</span>e<span class="token operator">-</span><span class="token number">88</span>d7<span class="token operator">-</span><span class="token number">8</span>bec729187bd <span class="token number">9942</span>eb4321644336a0c7383d9f1c2bed a7d812868cb74f1a978035530f55f1d0 <span class="token operator">-</span> <span class="token keyword">default</span> <span class="token keyword">default</span><span class="token punctuation">]</span> <span class="token number">192.168</span><span class="token punctuation">.</span><span class="token number">112.146</span> <span class="token operator">-</span> <span class="token operator">-</span> <span class="token punctuation">[</span><span class="token number">17</span><span class="token operator">/</span>Sep<span class="token operator">/</span><span class="token number">2021</span> <span class="token number">20</span><span class="token operator">:</span><span class="token number">01</span><span class="token operator">:</span><span class="token number">59</span><span class="token punctuation">]</span> <span class="token string">"GET /v2/images/6e6047e0-7ecc-49d2-aa17-79cacff593af HTTP/1.1"</span> <span class="token number">200</span> <span class="token number">986</span> <span class="token number">0.149315</span>
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">20</span><span class="token operator">:</span><span class="token number">01</span><span class="token operator">:</span><span class="token number">59.127</span> <span class="token number">2200</span> INFO eventlet<span class="token punctuation">.</span>wsgi<span class="token punctuation">.</span>server <span class="token punctuation">[</span>req<span class="token operator">-</span>d15b7265<span class="token operator">-</span>b4c4<span class="token operator">-</span><span class="token number">409f</span><span class="token operator">-</span><span class="token number">8</span>c36<span class="token operator">-</span>bdd11e8c6e68 <span class="token number">9942</span>eb4321644336a0c7383d9f1c2bed a7d812868cb74f1a978035530f55f1d0 <span class="token operator">-</span> <span class="token keyword">default</span> <span class="token keyword">default</span><span class="token punctuation">]</span> <span class="token number">192.168</span><span class="token punctuation">.</span><span class="token number">112.146</span> <span class="token operator">-</span> <span class="token operator">-</span> <span class="token punctuation">[</span><span class="token number">17</span><span class="token operator">/</span>Sep<span class="token operator">/</span><span class="token number">2021</span> <span class="token number">20</span><span class="token operator">:</span><span class="token number">01</span><span class="token operator">:</span><span class="token number">59</span><span class="token punctuation">]</span> <span class="token string">"GET /v2/schemas/image HTTP/1.1"</span> <span class="token number">200</span> <span class="token number">6925</span> <span class="token number">0.002797</span>
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">20</span><span class="token operator">:</span><span class="token number">01</span><span class="token operator">:</span><span class="token number">59.471</span> <span class="token number">2200</span> INFO eventlet<span class="token punctuation">.</span>wsgi<span class="token punctuation">.</span>server <span class="token punctuation">[</span>req<span class="token operator">-</span>e1b2226b<span class="token operator">-</span><span class="token number">62f</span>a<span class="token operator">-</span><span class="token number">42</span>ba<span class="token operator">-</span><span class="token number">90</span>b8<span class="token operator">-</span><span class="token number">1366f</span>82d7356 <span class="token number">9942</span>eb4321644336a0c7383d9f1c2bed a7d812868cb74f1a978035530f55f1d0 <span class="token operator">-</span> <span class="token keyword">default</span> <span class="token keyword">default</span><span class="token punctuation">]</span> <span class="token number">192.168</span><span class="token punctuation">.</span><span class="token number">112.146</span> <span class="token operator">-</span> <span class="token operator">-</span> <span class="token punctuation">[</span><span class="token number">17</span><span class="token operator">/</span>Sep<span class="token operator">/</span><span class="token number">2021</span> <span class="token number">20</span><span class="token operator">:</span><span class="token number">01</span><span class="token operator">:</span><span class="token number">59</span><span class="token punctuation">]</span> <span class="token string">"GET /v2/images/6e6047e0-7ecc-49d2-aa17-79cacff593af HTTP/1.1"</span> <span class="token number">200</span> <span class="token number">986</span> <span class="token number">0.010701</span>
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">20</span><span class="token operator">:</span><span class="token number">02</span><span class="token operator">:</span><span class="token number">07.870</span> <span class="token number">2200</span> INFO eventlet<span class="token punctuation">.</span>wsgi<span class="token punctuation">.</span>server <span class="token punctuation">[</span>req<span class="token operator">-</span>d23793ee<span class="token operator">-</span>fafb<span class="token operator">-</span><span class="token number">40f</span>e<span class="token operator">-</span>a13a<span class="token operator">-</span><span class="token number">88347</span>aaa1d6b <span class="token number">9942</span>eb4321644336a0c7383d9f1c2bed a7d812868cb74f1a978035530f55f1d0 <span class="token operator">-</span> <span class="token keyword">default</span> <span class="token keyword">default</span><span class="token punctuation">]</span> <span class="token number">192.168</span><span class="token punctuation">.</span><span class="token number">112.146</span> <span class="token operator">-</span> <span class="token operator">-</span> <span class="token punctuation">[</span><span class="token number">17</span><span class="token operator">/</span>Sep<span class="token operator">/</span><span class="token number">2021</span> <span class="token number">20</span><span class="token operator">:</span><span class="token number">02</span><span class="token operator">:</span><span class="token number">07</span><span class="token punctuation">]</span> <span class="token string">"GET /v2/images?limit=20 HTTP/1.1"</span> <span class="token number">200</span> <span class="token number">2637</span> <span class="token number">0.015508</span>
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">20</span><span class="token operator">:</span><span class="token number">02</span><span class="token operator">:</span><span class="token number">07.874</span> <span class="token number">2200</span> INFO eventlet<span class="token punctuation">.</span>wsgi<span class="token punctuation">.</span>server <span class="token punctuation">[</span>req<span class="token operator">-</span><span class="token number">47401128</span><span class="token operator">-</span><span class="token number">8408</span><span class="token operator">-</span><span class="token number">45</span>a4<span class="token operator">-</span><span class="token number">9</span>a75<span class="token operator">-</span>dd14d27088b1 <span class="token number">9942</span>eb4321644336a0c7383d9f1c2bed a7d812868cb74f1a978035530f55f1d0 <span class="token operator">-</span> <span class="token keyword">default</span> <span class="token keyword">default</span><span class="token punctuation">]</span> <span class="token number">192.168</span><span class="token punctuation">.</span><span class="token number">112.146</span> <span class="token operator">-</span> <span class="token operator">-</span> <span class="token punctuation">[</span><span class="token number">17</span><span class="token operator">/</span>Sep<span class="token operator">/</span><span class="token number">2021</span> <span class="token number">20</span><span class="token operator">:</span><span class="token number">02</span><span class="token operator">:</span><span class="token number">07</span><span class="token punctuation">]</span> <span class="token string">"GET /v2/schemas/image HTTP/1.1"</span> <span class="token number">200</span> <span class="token number">6925</span> <span class="token number">0.002249</span>
</code></pre>
<br>
<h3><a id="16novaserver_566"></a>（16）根据nova创建server实例的日志流程排错</h3>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 客户向nova-api发送请求，请求创建虚拟机；</p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; nova-api对请求作出处理后，向mq发送消息“让scheduler创建虚机”；</p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; nova-scheduler从mq中获取到API发送给它的消息，然后执行调度算法，从若干个计算节点中选出节点A；</p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; noav-scheduler向mq发送消息“在节点A上创建虚拟”；</p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 计算节点A的nova-compute从mq中获取到nova-scheduler发给它的消息，然后在本节点的Hypervisor上启动虚拟机；</p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 在虚拟机创建的过程中，计算节点A的nova-compute如果需要查询或更新数据库消息，会通过mq向nova-conductor发送消息，nova-conductor负责数据库访问。</p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 执行创建server实例的命令：</p>
<pre><code class="prism language-cpp">openstack server create <span class="token operator">--</span>image centos7_x86_64_2 <span class="token operator">--</span>flavor centos72  centos7_new
</code></pre>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 首先查看Controller节点的nova-api.log日志：</p>
<pre><code class="prism language-cpp"><span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">23</span><span class="token operator">:</span><span class="token number">48</span><span class="token operator">:</span><span class="token number">46.780</span> <span class="token number">2253</span> INFO nova<span class="token punctuation">.</span>api<span class="token punctuation">.</span>openstack<span class="token punctuation">.</span>wsgi <span class="token punctuation">[</span>req<span class="token operator">-</span><span class="token number">32</span>b257bf<span class="token operator">-</span><span class="token number">2ff</span>5<span class="token operator">-</span><span class="token number">4</span>b94<span class="token operator">-</span><span class="token number">9213</span><span class="token operator">-</span><span class="token number">1072f</span>a557b8c <span class="token number">9942</span>eb4321644336a0c7383d9f1c2bed a7d812868cb74f1a978035530f55f1d0 <span class="token operator">-</span> <span class="token keyword">default</span> <span class="token keyword">default</span><span class="token punctuation">]</span> HTTP exception thrown<span class="token operator">:</span> 云主机类型 centos72 没有找到。
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">23</span><span class="token operator">:</span><span class="token number">48</span><span class="token operator">:</span><span class="token number">46.781</span> <span class="token number">2253</span> INFO nova<span class="token punctuation">.</span>osapi_compute<span class="token punctuation">.</span>wsgi<span class="token punctuation">.</span>server <span class="token punctuation">[</span>req<span class="token operator">-</span><span class="token number">32</span>b257bf<span class="token operator">-</span><span class="token number">2ff</span>5<span class="token operator">-</span><span class="token number">4</span>b94<span class="token operator">-</span><span class="token number">9213</span><span class="token operator">-</span><span class="token number">1072f</span>a557b8c <span class="token number">9942</span>eb4321644336a0c7383d9f1c2bed a7d812868cb74f1a978035530f55f1d0 <span class="token operator">-</span> <span class="token keyword">default</span> <span class="token keyword">default</span><span class="token punctuation">]</span> <span class="token number">192.168</span><span class="token punctuation">.</span><span class="token number">112.146</span> <span class="token string">"GET /v2.1/flavors/centos72 HTTP/1.1"</span> status<span class="token operator">:</span> <span class="token number">404</span> len<span class="token operator">:</span> <span class="token number">537</span> time<span class="token operator">:</span> <span class="token number">0.0147262</span>
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">23</span><span class="token operator">:</span><span class="token number">48</span><span class="token operator">:</span><span class="token number">46.799</span> <span class="token number">2253</span> INFO nova<span class="token punctuation">.</span>osapi_compute<span class="token punctuation">.</span>wsgi<span class="token punctuation">.</span>server <span class="token punctuation">[</span>req<span class="token operator">-</span><span class="token number">851</span>da075<span class="token operator">-</span>eb20<span class="token operator">-</span><span class="token number">4924</span><span class="token operator">-</span>a170<span class="token operator">-</span><span class="token number">1f</span>58753967ad <span class="token number">9942</span>eb4321644336a0c7383d9f1c2bed a7d812868cb74f1a978035530f55f1d0 <span class="token operator">-</span> <span class="token keyword">default</span> <span class="token keyword">default</span><span class="token punctuation">]</span> <span class="token number">192.168</span><span class="token punctuation">.</span><span class="token number">112.146</span> <span class="token string">"GET /v2.1/flavors HTTP/1.1"</span> status<span class="token operator">:</span> <span class="token number">200</span> len<span class="token operator">:</span> <span class="token number">965</span> time<span class="token operator">:</span> <span class="token number">0.0149779</span>
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">23</span><span class="token operator">:</span><span class="token number">48</span><span class="token operator">:</span><span class="token number">46.812</span> <span class="token number">2253</span> INFO nova<span class="token punctuation">.</span>osapi_compute<span class="token punctuation">.</span>wsgi<span class="token punctuation">.</span>server <span class="token punctuation">[</span>req<span class="token operator">-</span><span class="token number">2</span>a3944b4<span class="token operator">-</span>a89d<span class="token operator">-</span><span class="token number">4f</span>6c<span class="token operator">-</span><span class="token number">9</span>cbe<span class="token operator">-</span><span class="token number">234442</span>da470d <span class="token number">9942</span>eb4321644336a0c7383d9f1c2bed a7d812868cb74f1a978035530f55f1d0 <span class="token operator">-</span> <span class="token keyword">default</span> <span class="token keyword">default</span><span class="token punctuation">]</span> <span class="token number">192.168</span><span class="token punctuation">.</span><span class="token number">112.146</span> <span class="token string">"GET /v2.1/flavors/3 HTTP/1.1"</span> status<span class="token operator">:</span> <span class="token number">200</span> len<span class="token operator">:</span> <span class="token number">766</span> time<span class="token operator">:</span> <span class="token number">0.0095580</span>
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">23</span><span class="token operator">:</span><span class="token number">48</span><span class="token operator">:</span><span class="token number">47.149</span> <span class="token number">2253</span> INFO nova<span class="token punctuation">.</span>osapi_compute<span class="token punctuation">.</span>wsgi<span class="token punctuation">.</span>server <span class="token punctuation">[</span>req<span class="token operator">-</span>ba7cca9e<span class="token operator">-</span><span class="token number">6</span>c0d<span class="token operator">-</span><span class="token number">4</span>a8e<span class="token operator">-</span>b657<span class="token operator">-</span><span class="token number">60673456</span>a472 <span class="token number">9942</span>eb4321644336a0c7383d9f1c2bed a7d812868cb74f1a978035530f55f1d0 <span class="token operator">-</span> <span class="token keyword">default</span> <span class="token keyword">default</span><span class="token punctuation">]</span> <span class="token number">192.168</span><span class="token punctuation">.</span><span class="token number">112.146</span> <span class="token string">"POST /v2.1/servers HTTP/1.1"</span> status<span class="token operator">:</span> <span class="token number">202</span> len<span class="token operator">:</span> <span class="token number">876</span> time<span class="token operator">:</span> <span class="token number">0.3276680</span>
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">23</span><span class="token operator">:</span><span class="token number">48</span><span class="token operator">:</span><span class="token number">47.374</span> <span class="token number">2253</span> INFO nova<span class="token punctuation">.</span>osapi_compute<span class="token punctuation">.</span>wsgi<span class="token punctuation">.</span>server <span class="token punctuation">[</span>req<span class="token operator">-</span><span class="token number">9989529</span>b<span class="token operator">-</span><span class="token number">317e-4998</span><span class="token operator">-</span><span class="token number">9</span>eff<span class="token operator">-</span><span class="token number">14</span>c4e69e6aa4 <span class="token number">9942</span>eb4321644336a0c7383d9f1c2bed a7d812868cb74f1a978035530f55f1d0 <span class="token operator">-</span> <span class="token keyword">default</span> <span class="token keyword">default</span><span class="token punctuation">]</span> <span class="token number">192.168</span><span class="token punctuation">.</span><span class="token number">112.146</span> <span class="token string">"GET /v2.1/servers/4f75fd35-c53c-4feb-90bf-391996dee667 HTTP/1.1"</span> status<span class="token operator">:</span> <span class="token number">200</span> len<span class="token operator">:</span> <span class="token number">1691</span> time<span class="token operator">:</span> <span class="token number">0.2202811</span>
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">23</span><span class="token operator">:</span><span class="token number">48</span><span class="token operator">:</span><span class="token number">47.426</span> <span class="token number">2253</span> INFO nova<span class="token punctuation">.</span>osapi_compute<span class="token punctuation">.</span>wsgi<span class="token punctuation">.</span>server <span class="token punctuation">[</span>req<span class="token operator">-</span>e151852b<span class="token operator">-</span><span class="token number">8</span>b42<span class="token operator">-</span><span class="token number">4f</span>52<span class="token operator">-</span><span class="token number">88e7</span><span class="token operator">-</span><span class="token number">95369</span>c3fc61a <span class="token number">9942</span>eb4321644336a0c7383d9f1c2bed a7d812868cb74f1a978035530f55f1d0 <span class="token operator">-</span> <span class="token keyword">default</span> <span class="token keyword">default</span><span class="token punctuation">]</span> <span class="token number">192.168</span><span class="token punctuation">.</span><span class="token number">112.146</span> <span class="token string">"GET /v2.1/flavors/3 HTTP/1.1"</span> status<span class="token operator">:</span> <span class="token number">200</span> len<span class="token operator">:</span> <span class="token number">766</span> time<span class="token operator">:</span> <span class="token number">0.0206590</span>
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">23</span><span class="token operator">:</span><span class="token number">49</span><span class="token operator">:</span><span class="token number">03.443</span> <span class="token number">2255</span> INFO nova<span class="token punctuation">.</span>osapi_compute<span class="token punctuation">.</span>wsgi<span class="token punctuation">.</span>server <span class="token punctuation">[</span>req<span class="token operator">-</span>a78a63b6<span class="token operator">-</span><span class="token number">06</span>a6<span class="token operator">-</span><span class="token number">4238</span><span class="token operator">-</span>ac77<span class="token operator">-</span><span class="token number">1472</span>c2d67d15 <span class="token number">9942</span>eb4321644336a0c7383d9f1c2bed a7d812868cb74f1a978035530f55f1d0 <span class="token operator">-</span> <span class="token keyword">default</span> <span class="token keyword">default</span><span class="token punctuation">]</span> <span class="token number">192.168</span><span class="token punctuation">.</span><span class="token number">112.145</span> <span class="token string">"GET /v2.1/flavors/detail HTTP/1.1"</span> status<span class="token operator">:</span> <span class="token number">200</span> len<span class="token operator">:</span> <span class="token number">1479</span> time<span class="token operator">:</span> <span class="token number">0.8354931</span>
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">23</span><span class="token operator">:</span><span class="token number">49</span><span class="token operator">:</span><span class="token number">03.536</span> <span class="token number">2255</span> INFO nova<span class="token punctuation">.</span>osapi_compute<span class="token punctuation">.</span>wsgi<span class="token punctuation">.</span>server <span class="token punctuation">[</span>req<span class="token operator">-</span><span class="token number">19</span>ee3aa7<span class="token operator">-</span><span class="token number">264</span>d<span class="token operator">-</span><span class="token number">4</span>bce<span class="token operator">-</span><span class="token number">8</span>efd<span class="token operator">-</span>de09763f1b1c <span class="token number">9942</span>eb4321644336a0c7383d9f1c2bed a7d812868cb74f1a978035530f55f1d0 <span class="token operator">-</span> <span class="token keyword">default</span> <span class="token keyword">default</span><span class="token punctuation">]</span> <span class="token number">192.168</span><span class="token punctuation">.</span><span class="token number">112.145</span> <span class="token string">"GET /v2.1 HTTP/1.1"</span> status<span class="token operator">:</span> <span class="token number">302</span> len<span class="token operator">:</span> <span class="token number">317</span> time<span class="token operator">:</span> <span class="token number">0.0038280</span>
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">23</span><span class="token operator">:</span><span class="token number">49</span><span class="token operator">:</span><span class="token number">03.543</span> <span class="token number">2255</span> INFO nova<span class="token punctuation">.</span>osapi_compute<span class="token punctuation">.</span>wsgi<span class="token punctuation">.</span>server <span class="token punctuation">[</span>req<span class="token operator">-</span><span class="token number">6</span>ae78456<span class="token operator">-</span><span class="token number">5</span>d4a<span class="token operator">-</span><span class="token number">42</span>d9<span class="token operator">-</span>af14<span class="token operator">-</span>e1a30fb18521 <span class="token number">9942</span>eb4321644336a0c7383d9f1c2bed a7d812868cb74f1a978035530f55f1d0 <span class="token operator">-</span> <span class="token keyword">default</span> <span class="token keyword">default</span><span class="token punctuation">]</span> <span class="token number">192.168</span><span class="token punctuation">.</span><span class="token number">112.145</span> <span class="token string">"GET /v2.1/ HTTP/1.1"</span> status<span class="token operator">:</span> <span class="token number">200</span> len<span class="token operator">:</span> <span class="token number">788</span> time<span class="token operator">:</span> <span class="token number">0.0038471</span>
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">23</span><span class="token operator">:</span><span class="token number">49</span><span class="token operator">:</span><span class="token number">05.096</span> <span class="token number">2254</span> INFO nova<span class="token punctuation">.</span>osapi_compute<span class="token punctuation">.</span>wsgi<span class="token punctuation">.</span>server <span class="token punctuation">[</span>req<span class="token operator">-</span><span class="token number">0</span>a1dfa3a<span class="token operator">-</span>d832<span class="token operator">-</span><span class="token number">4</span>c44<span class="token operator">-</span>abf0<span class="token operator">-</span><span class="token number">716803</span>a29475 <span class="token number">9942</span>eb4321644336a0c7383d9f1c2bed a7d812868cb74f1a978035530f55f1d0 <span class="token operator">-</span> <span class="token keyword">default</span> <span class="token keyword">default</span><span class="token punctuation">]</span> <span class="token number">192.168</span><span class="token punctuation">.</span><span class="token number">112.145</span> <span class="token string">"GET /v2.1/servers/detail?limit=21&amp;project_id=a7d812868cb74f1a978035530f55f1d0&amp;sort_dir=desc&amp;sort_dir=desc&amp;sort_dir=desc&amp;sort_key=created_at&amp;sort_key=display_name&amp;sort_key=uuid HTTP/1.1"</span> status<span class="token operator">:</span> <span class="token number">200</span> len<span class="token operator">:</span> <span class="token number">6270</span> time<span class="token operator">:</span> <span class="token number">1.4020071</span>
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">23</span><span class="token operator">:</span><span class="token number">49</span><span class="token operator">:</span><span class="token number">05.596</span> <span class="token number">2255</span> INFO nova<span class="token punctuation">.</span>osapi_compute<span class="token punctuation">.</span>wsgi<span class="token punctuation">.</span>server <span class="token punctuation">[</span>req<span class="token operator">-</span><span class="token number">145</span>b6db0<span class="token operator">-</span>aaf5<span class="token operator">-</span><span class="token number">4487</span><span class="token operator">-</span>b2b9<span class="token operator">-</span>ebcd7f17b8c4 <span class="token number">9942</span>eb4321644336a0c7383d9f1c2bed a7d812868cb74f1a978035530f55f1d0 <span class="token operator">-</span> <span class="token keyword">default</span> <span class="token keyword">default</span><span class="token punctuation">]</span> <span class="token number">192.168</span><span class="token punctuation">.</span><span class="token number">112.145</span> <span class="token string">"GET /v2.1/extensions HTTP/1.1"</span> status<span class="token operator">:</span> <span class="token number">200</span> len<span class="token operator">:</span> <span class="token number">23101</span> time<span class="token operator">:</span> <span class="token number">0.0046902</span>
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">23</span><span class="token operator">:</span><span class="token number">49</span><span class="token operator">:</span><span class="token number">05.863</span> <span class="token number">2255</span> INFO nova<span class="token punctuation">.</span>osapi_compute<span class="token punctuation">.</span>wsgi<span class="token punctuation">.</span>server <span class="token punctuation">[</span>req<span class="token operator">-</span>f9863cf3<span class="token operator">-</span><span class="token number">9641</span><span class="token operator">-</span><span class="token number">432</span>e<span class="token operator">-</span>ac53<span class="token operator">-</span>a5277a94c51d <span class="token number">9942</span>eb4321644336a0c7383d9f1c2bed a7d812868cb74f1a978035530f55f1d0 <span class="token operator">-</span> <span class="token keyword">default</span> <span class="token keyword">default</span><span class="token punctuation">]</span> <span class="token number">192.168</span><span class="token punctuation">.</span><span class="token number">112.145</span> <span class="token string">"GET /v2.1/limits?reserved=1 HTTP/1.1"</span> status<span class="token operator">:</span> <span class="token number">200</span> len<span class="token operator">:</span> <span class="token number">913</span> time<span class="token operator">:</span> <span class="token number">0.0407920</span>
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">23</span><span class="token operator">:</span><span class="token number">49</span><span class="token operator">:</span><span class="token number">06.368</span> <span class="token number">2255</span> INFO nova<span class="token punctuation">.</span>osapi_compute<span class="token punctuation">.</span>wsgi<span class="token punctuation">.</span>server <span class="token punctuation">[</span>req<span class="token operator">-</span>c16f1023<span class="token operator">-</span>d3c7<span class="token operator">-</span><span class="token number">4183</span><span class="token operator">-</span>a7bd<span class="token operator">-</span><span class="token number">3590</span>b7fec868 <span class="token number">9942</span>eb4321644336a0c7383d9f1c2bed a7d812868cb74f1a978035530f55f1d0 <span class="token operator">-</span> <span class="token keyword">default</span> <span class="token keyword">default</span><span class="token punctuation">]</span> <span class="token number">192.168</span><span class="token punctuation">.</span><span class="token number">112.145</span> <span class="token string">"GET /v2.1/limits?reserved=1 HTTP/1.1"</span> status<span class="token operator">:</span> <span class="token number">200</span> len<span class="token operator">:</span> <span class="token number">913</span> time<span class="token operator">:</span> <span class="token number">0.0380440</span>
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">23</span><span class="token operator">:</span><span class="token number">49</span><span class="token operator">:</span><span class="token number">44.228</span> <span class="token number">2255</span> INFO nova<span class="token punctuation">.</span>osapi_compute<span class="token punctuation">.</span>wsgi<span class="token punctuation">.</span>server <span class="token punctuation">[</span>req<span class="token operator">-</span><span class="token number">876229</span>d8<span class="token operator">-</span><span class="token number">50ff</span><span class="token operator">-</span><span class="token number">4f</span>1c<span class="token operator">-</span><span class="token number">8596</span><span class="token operator">-</span>c6f40bab9ab8 <span class="token number">9942</span>eb4321644336a0c7383d9f1c2bed a7d812868cb74f1a978035530f55f1d0 <span class="token operator">-</span> <span class="token keyword">default</span> <span class="token keyword">default</span><span class="token punctuation">]</span> <span class="token number">192.168</span><span class="token punctuation">.</span><span class="token number">112.145</span> <span class="token string">"GET /v2.1/flavors/detail HTTP/1.1"</span> status<span class="token operator">:</span> <span class="token number">200</span> len<span class="token operator">:</span> <span class="token number">1479</span> time<span class="token operator">:</span> <span class="token number">0.2233560</span>
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">23</span><span class="token operator">:</span><span class="token number">49</span><span class="token operator">:</span><span class="token number">44.274</span> <span class="token number">2255</span> INFO nova<span class="token punctuation">.</span>osapi_compute<span class="token punctuation">.</span>wsgi<span class="token punctuation">.</span>server <span class="token punctuation">[</span>req<span class="token operator">-</span><span class="token number">73</span>d47f3c<span class="token operator">-</span><span class="token number">629e-4316</span><span class="token operator">-</span>be5d<span class="token operator">-</span>bfe65767581d <span class="token number">9942</span>eb4321644336a0c7383d9f1c2bed a7d812868cb74f1a978035530f55f1d0 <span class="token operator">-</span> <span class="token keyword">default</span> <span class="token keyword">default</span><span class="token punctuation">]</span> <span class="token number">192.168</span><span class="token punctuation">.</span><span class="token number">112.145</span> <span class="token string">"GET /v2.1 HTTP/1.1"</span> status<span class="token operator">:</span> <span class="token number">302</span> len<span class="token operator">:</span> <span class="token number">317</span> time<span class="token operator">:</span> <span class="token number">0.0026519</span>
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">23</span><span class="token operator">:</span><span class="token number">49</span><span class="token operator">:</span><span class="token number">44.279</span> <span class="token number">2255</span> INFO nova<span class="token punctuation">.</span>osapi_compute<span class="token punctuation">.</span>wsgi<span class="token punctuation">.</span>server <span class="token punctuation">[</span>req<span class="token operator">-</span><span class="token number">9f</span>7572d8<span class="token operator">-</span>afbe<span class="token operator">-</span><span class="token number">448</span>a<span class="token operator">-</span>a025<span class="token operator">-</span><span class="token number">2f</span>eb5a0921f2 <span class="token number">9942</span>eb4321644336a0c7383d9f1c2bed a7d812868cb74f1a978035530f55f1d0 <span class="token operator">-</span> <span class="token keyword">default</span> <span class="token keyword">default</span><span class="token punctuation">]</span> <span class="token number">192.168</span><span class="token punctuation">.</span><span class="token number">112.145</span> <span class="token string">"GET /v2.1/ HTTP/1.1"</span> status<span class="token operator">:</span> <span class="token number">200</span> len<span class="token operator">:</span> <span class="token number">788</span> time<span class="token operator">:</span> <span class="token number">0.0028460</span>
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">23</span><span class="token operator">:</span><span class="token number">49</span><span class="token operator">:</span><span class="token number">45.046</span> <span class="token number">2255</span> INFO nova<span class="token punctuation">.</span>osapi_compute<span class="token punctuation">.</span>wsgi<span class="token punctuation">.</span>server <span class="token punctuation">[</span>req<span class="token operator">-</span>a72117ca<span class="token operator">-</span>daba<span class="token operator">-</span><span class="token number">424f</span><span class="token operator">-</span><span class="token number">84</span>b7<span class="token operator">-</span><span class="token number">3</span>d15c94ae72c <span class="token number">9942</span>eb4321644336a0c7383d9f1c2bed a7d812868cb74f1a978035530f55f1d0 <span class="token operator">-</span> <span class="token keyword">default</span> <span class="token keyword">default</span><span class="token punctuation">]</span> <span class="token number">192.168</span><span class="token punctuation">.</span><span class="token number">112.145</span> <span class="token string">"GET /v2.1/servers/detail?limit=21&amp;project_id=a7d812868cb74f1a978035530f55f1d0&amp;sort_dir=desc&amp;sort_dir=desc&amp;sort_dir=desc&amp;sort_key=created_at&amp;sort_key=display_name&amp;sort_key=uuid HTTP/1.1"</span> status<span class="token operator">:</span> <span class="token number">200</span> len<span class="token operator">:</span> <span class="token number">6270</span> time<span class="token operator">:</span> <span class="token number">0.6647730</span>
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">23</span><span class="token operator">:</span><span class="token number">49</span><span class="token operator">:</span><span class="token number">45.553</span> <span class="token number">2255</span> INFO nova<span class="token punctuation">.</span>osapi_compute<span class="token punctuation">.</span>wsgi<span class="token punctuation">.</span>server <span class="token punctuation">[</span>req<span class="token operator">-</span><span class="token number">077</span>ed365<span class="token operator">-</span><span class="token number">0</span>a58<span class="token operator">-</span><span class="token number">4981</span><span class="token operator">-</span><span class="token number">9523</span><span class="token operator">-</span>dad0fc98237c <span class="token number">9942</span>eb4321644336a0c7383d9f1c2bed a7d812868cb74f1a978035530f55f1d0 <span class="token operator">-</span> <span class="token keyword">default</span> <span class="token keyword">default</span><span class="token punctuation">]</span> <span class="token number">192.168</span><span class="token punctuation">.</span><span class="token number">112.145</span> <span class="token string">"GET /v2.1/extensions HTTP/1.1"</span> status<span class="token operator">:</span> <span class="token number">200</span> len<span class="token operator">:</span> <span class="token number">23101</span> time<span class="token operator">:</span> <span class="token number">0.0035529</span>
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">23</span><span class="token operator">:</span><span class="token number">49</span><span class="token operator">:</span><span class="token number">45.768</span> <span class="token number">2255</span> INFO nova<span class="token punctuation">.</span>osapi_compute<span class="token punctuation">.</span>wsgi<span class="token punctuation">.</span>server <span class="token punctuation">[</span>req<span class="token operator">-</span>bbadcf04<span class="token operator">-</span>abca<span class="token operator">-</span><span class="token number">47f</span>0<span class="token operator">-</span>b067<span class="token operator">-</span><span class="token number">8</span>d3a7ee7b64c <span class="token number">9942</span>eb4321644336a0c7383d9f1c2bed a7d812868cb74f1a978035530f55f1d0 <span class="token operator">-</span> <span class="token keyword">default</span> <span class="token keyword">default</span><span class="token punctuation">]</span> <span class="token number">192.168</span><span class="token punctuation">.</span><span class="token number">112.145</span> <span class="token string">"GET /v2.1/limits?reserved=1 HTTP/1.1"</span> status<span class="token operator">:</span> <span class="token number">200</span> len<span class="token operator">:</span> <span class="token number">913</span> time<span class="token operator">:</span> <span class="token number">0.0294020</span>
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">23</span><span class="token operator">:</span><span class="token number">49</span><span class="token operator">:</span><span class="token number">46.243</span> <span class="token number">2255</span> INFO nova<span class="token punctuation">.</span>osapi_compute<span class="token punctuation">.</span>wsgi<span class="token punctuation">.</span>server <span class="token punctuation">[</span>req<span class="token operator">-</span><span class="token number">4901</span>aa95<span class="token operator">-</span>fb27<span class="token operator">-</span><span class="token number">4</span>db4<span class="token operator">-</span><span class="token number">924</span>e<span class="token operator">-</span>e7845a45268d <span class="token number">9942</span>eb4321644336a0c7383d9f1c2bed a7d812868cb74f1a978035530f55f1d0 <span class="token operator">-</span> <span class="token keyword">default</span> <span class="token keyword">default</span><span class="token punctuation">]</span> <span class="token number">192.168</span><span class="token punctuation">.</span><span class="token number">112.145</span> <span class="token string">"GET /v2.1/limits?reserved=1 HTTP/1.1"</span> status<span class="token operator">:</span> <span class="token number">200</span> len<span class="token operator">:</span> <span class="token number">913</span> time<span class="token operator">:</span> <span class="token number">0.0318770</span>
</code></pre>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 查看Controller节点的nova-scheduler.log日志：</p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 首先通过compute_filter过滤器，通过ram内存过滤，首先通过localhost.localdomain节点进行过滤；</p>
<pre><code class="prism language-cpp"><span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">23</span><span class="token operator">:</span><span class="token number">48</span><span class="token operator">:</span><span class="token number">48.256</span> <span class="token number">2570</span> WARNING nova<span class="token punctuation">.</span>scheduler<span class="token punctuation">.</span>filters<span class="token punctuation">.</span>compute_filter <span class="token punctuation">[</span>req<span class="token operator">-</span>ba7cca9e<span class="token operator">-</span><span class="token number">6</span>c0d<span class="token operator">-</span><span class="token number">4</span>a8e<span class="token operator">-</span>b657<span class="token operator">-</span><span class="token number">60673456</span>a472 <span class="token number">9942</span>eb4321644336a0c7383d9f1c2bed a7d812868cb74f1a978035530f55f1d0 <span class="token operator">-</span> <span class="token keyword">default</span> <span class="token keyword">default</span><span class="token punctuation">]</span> <span class="token punctuation">(</span>localhost<span class="token punctuation">.</span>localdomain<span class="token punctuation">,</span> localhost<span class="token punctuation">.</span>localdomain<span class="token punctuation">)</span> ram<span class="token operator">:</span> <span class="token number">3258</span>MB disk<span class="token operator">:</span> <span class="token number">32768</span>MB io_ops<span class="token operator">:</span> <span class="token number">0</span> instances<span class="token operator">:</span> <span class="token number">0</span> has <span class="token operator">not</span> been heard from in a <span class="token keyword">while</span>
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">23</span><span class="token operator">:</span><span class="token number">48</span><span class="token operator">:</span><span class="token number">48.263</span> <span class="token number">2570</span> INFO nova<span class="token punctuation">.</span>filters <span class="token punctuation">[</span>req<span class="token operator">-</span>ba7cca9e<span class="token operator">-</span><span class="token number">6</span>c0d<span class="token operator">-</span><span class="token number">4</span>a8e<span class="token operator">-</span>b657<span class="token operator">-</span><span class="token number">60673456</span>a472 <span class="token number">9942</span>eb4321644336a0c7383d9f1c2bed a7d812868cb74f1a978035530f55f1d0 <span class="token operator">-</span> <span class="token keyword">default</span> <span class="token keyword">default</span><span class="token punctuation">]</span> Filter ComputeFilter returned <span class="token number">0</span> hosts
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">23</span><span class="token operator">:</span><span class="token number">48</span><span class="token operator">:</span><span class="token number">48.263</span> <span class="token number">2570</span> INFO nova<span class="token punctuation">.</span>filters <span class="token punctuation">[</span>req<span class="token operator">-</span>ba7cca9e<span class="token operator">-</span><span class="token number">6</span>c0d<span class="token operator">-</span><span class="token number">4</span>a8e<span class="token operator">-</span>b657<span class="token operator">-</span><span class="token number">60673456</span>a472 <span class="token number">9942</span>eb4321644336a0c7383d9f1c2bed a7d812868cb74f1a978035530f55f1d0 <span class="token operator">-</span> <span class="token keyword">default</span> <span class="token keyword">default</span><span class="token punctuation">]</span> Filtering removed all hosts <span class="token keyword">for</span> the request with instance ID <span class="token string">'4f75fd35-c53c-4feb-90bf-391996dee667'</span><span class="token punctuation">.</span> Filter results<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'AvailabilityZoneFilter: (start: 1, end: 1)'</span><span class="token punctuation">,</span> <span class="token string">'ComputeFilter: (start: 1, end: 0)'</span><span class="token punctuation">]</span>
</code></pre>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 查看Controller节点的nova-conductor.log日志：</p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 主要的问题是：找不到有效主机，原因是 没有足够的主机可用，猜测可能是CPU，内存，硬盘可能不足；</p>
<pre><code class="prism language-cpp"><span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">23</span><span class="token operator">:</span><span class="token number">48</span><span class="token operator">:</span><span class="token number">48.310</span> <span class="token number">2369</span> ERROR nova<span class="token punctuation">.</span>conductor<span class="token punctuation">.</span>manager <span class="token punctuation">[</span>req<span class="token operator">-</span>ba7cca9e<span class="token operator">-</span><span class="token number">6</span>c0d<span class="token operator">-</span><span class="token number">4</span>a8e<span class="token operator">-</span>b657<span class="token operator">-</span><span class="token number">60673456</span>a472 <span class="token number">9942</span>eb4321644336a0c7383d9f1c2bed a7d812868cb74f1a978035530f55f1d0 <span class="token operator">-</span> <span class="token keyword">default</span> <span class="token keyword">default</span><span class="token punctuation">]</span> Failed to schedule instances<span class="token operator">:</span> NoValidHost_Remote<span class="token operator">:</span> \u627e\u4e0d\u5230\u6709\u6548\u4e3b\u673a\uff0c\u539f\u56e0\u662f \u6ca1\u6709\u8db3\u591f\u7684\u4e3b\u673a\u53ef\u7528\u3002\u3002
<span class="token function">Traceback</span> <span class="token punctuation">(</span>most recent call last<span class="token punctuation">)</span><span class="token operator">:</span>

  File <span class="token string">"/usr/lib/python2.7/site-packages/oslo_messaging/rpc/server.py"</span><span class="token punctuation">,</span> line <span class="token number">235</span><span class="token punctuation">,</span> in inner
    <span class="token keyword">return</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">*</span><span class="token operator">*</span>kwargs<span class="token punctuation">)</span>

  File <span class="token string">"/usr/lib/python2.7/site-packages/nova/scheduler/manager.py"</span><span class="token punctuation">,</span> line <span class="token number">214</span><span class="token punctuation">,</span> in select_destinations
    allocation_request_version<span class="token punctuation">,</span> return_alternates<span class="token punctuation">)</span>

  File <span class="token string">"/usr/lib/python2.7/site-packages/nova/scheduler/filter_scheduler.py"</span><span class="token punctuation">,</span> line <span class="token number">96</span><span class="token punctuation">,</span> in select_destinations
    allocation_request_version<span class="token punctuation">,</span> return_alternates<span class="token punctuation">)</span>

  File <span class="token string">"/usr/lib/python2.7/site-packages/nova/scheduler/filter_scheduler.py"</span><span class="token punctuation">,</span> line <span class="token number">265</span><span class="token punctuation">,</span> in _schedule
    claimed_instance_uuids<span class="token punctuation">)</span>

  File <span class="token string">"/usr/lib/python2.7/site-packages/nova/scheduler/filter_scheduler.py"</span><span class="token punctuation">,</span> line <span class="token number">302</span><span class="token punctuation">,</span> in _ensure_sufficient_hosts
    raise exception<span class="token punctuation">.</span><span class="token function">NoValidHost</span><span class="token punctuation">(</span>reason<span class="token operator">=</span>reason<span class="token punctuation">)</span>

NoValidHost<span class="token operator">:</span> \u627e\u4e0d\u5230\u6709\u6548\u4e3b\u673a\uff0c\u539f\u56e0\u662f \u6ca1\u6709\u8db3\u591f\u7684\u4e3b\u673a\u53ef\u7528\u3002\u3002
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">23</span><span class="token operator">:</span><span class="token number">48</span><span class="token operator">:</span><span class="token number">48.310</span> <span class="token number">2369</span> ERROR nova<span class="token punctuation">.</span>conductor<span class="token punctuation">.</span>manager <span class="token function">Traceback</span> <span class="token punctuation">(</span>most recent call last<span class="token punctuation">)</span><span class="token operator">:</span>
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">23</span><span class="token operator">:</span><span class="token number">48</span><span class="token operator">:</span><span class="token number">48.310</span> <span class="token number">2369</span> ERROR nova<span class="token punctuation">.</span>conductor<span class="token punctuation">.</span>manager   File <span class="token string">"/usr/lib/python2.7/site-packages/nova/conductor/manager.py"</span><span class="token punctuation">,</span> line <span class="token number">1379</span><span class="token punctuation">,</span> in schedule_and_build_instances
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">23</span><span class="token operator">:</span><span class="token number">48</span><span class="token operator">:</span><span class="token number">48.310</span> <span class="token number">2369</span> ERROR nova<span class="token punctuation">.</span>conductor<span class="token punctuation">.</span>manager     instance_uuids<span class="token punctuation">,</span> return_alternates<span class="token operator">=</span>True<span class="token punctuation">)</span>
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">23</span><span class="token operator">:</span><span class="token number">48</span><span class="token operator">:</span><span class="token number">48.310</span> <span class="token number">2369</span> ERROR nova<span class="token punctuation">.</span>conductor<span class="token punctuation">.</span>manager   File <span class="token string">"/usr/lib/python2.7/site-packages/nova/conductor/manager.py"</span><span class="token punctuation">,</span> line <span class="token number">839</span><span class="token punctuation">,</span> in _schedule_instances
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">23</span><span class="token operator">:</span><span class="token number">48</span><span class="token operator">:</span><span class="token number">48.310</span> <span class="token number">2369</span> ERROR nova<span class="token punctuation">.</span>conductor<span class="token punctuation">.</span>manager     return_alternates<span class="token operator">=</span>return_alternates<span class="token punctuation">)</span>
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">23</span><span class="token operator">:</span><span class="token number">48</span><span class="token operator">:</span><span class="token number">48.310</span> <span class="token number">2369</span> ERROR nova<span class="token punctuation">.</span>conductor<span class="token punctuation">.</span>manager   File <span class="token string">"/usr/lib/python2.7/site-packages/nova/scheduler/client/query.py"</span><span class="token punctuation">,</span> line <span class="token number">42</span><span class="token punctuation">,</span> in select_destinations
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">23</span><span class="token operator">:</span><span class="token number">48</span><span class="token operator">:</span><span class="token number">48.310</span> <span class="token number">2369</span> ERROR nova<span class="token punctuation">.</span>conductor<span class="token punctuation">.</span>manager     instance_uuids<span class="token punctuation">,</span> return_objects<span class="token punctuation">,</span> return_alternates<span class="token punctuation">)</span>
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">23</span><span class="token operator">:</span><span class="token number">48</span><span class="token operator">:</span><span class="token number">48.310</span> <span class="token number">2369</span> ERROR nova<span class="token punctuation">.</span>conductor<span class="token punctuation">.</span>manager   File <span class="token string">"/usr/lib/python2.7/site-packages/nova/scheduler/rpcapi.py"</span><span class="token punctuation">,</span> line <span class="token number">160</span><span class="token punctuation">,</span> in select_destinations
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">23</span><span class="token operator">:</span><span class="token number">48</span><span class="token operator">:</span><span class="token number">48.310</span> <span class="token number">2369</span> ERROR nova<span class="token punctuation">.</span>conductor<span class="token punctuation">.</span>manager     <span class="token keyword">return</span> cctxt<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>ctxt<span class="token punctuation">,</span> <span class="token string">'select_destinations'</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token operator">*</span>msg_args<span class="token punctuation">)</span>
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">23</span><span class="token operator">:</span><span class="token number">48</span><span class="token operator">:</span><span class="token number">48.310</span> <span class="token number">2369</span> ERROR nova<span class="token punctuation">.</span>conductor<span class="token punctuation">.</span>manager   File <span class="token string">"/usr/lib/python2.7/site-packages/oslo_messaging/rpc/client.py"</span><span class="token punctuation">,</span> line <span class="token number">181</span><span class="token punctuation">,</span> in call
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">23</span><span class="token operator">:</span><span class="token number">48</span><span class="token operator">:</span><span class="token number">48.310</span> <span class="token number">2369</span> ERROR nova<span class="token punctuation">.</span>conductor<span class="token punctuation">.</span>manager     transport_options<span class="token operator">=</span>self<span class="token punctuation">.</span>transport_options<span class="token punctuation">)</span>
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">23</span><span class="token operator">:</span><span class="token number">48</span><span class="token operator">:</span><span class="token number">48.310</span> <span class="token number">2369</span> ERROR nova<span class="token punctuation">.</span>conductor<span class="token punctuation">.</span>manager   File <span class="token string">"/usr/lib/python2.7/site-packages/oslo_messaging/transport.py"</span><span class="token punctuation">,</span> line <span class="token number">129</span><span class="token punctuation">,</span> in _send
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">23</span><span class="token operator">:</span><span class="token number">48</span><span class="token operator">:</span><span class="token number">48.310</span> <span class="token number">2369</span> ERROR nova<span class="token punctuation">.</span>conductor<span class="token punctuation">.</span>manager     transport_options<span class="token operator">=</span>transport_options<span class="token punctuation">)</span>
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">23</span><span class="token operator">:</span><span class="token number">48</span><span class="token operator">:</span><span class="token number">48.310</span> <span class="token number">2369</span> ERROR nova<span class="token punctuation">.</span>conductor<span class="token punctuation">.</span>manager   File <span class="token string">"/usr/lib/python2.7/site-packages/oslo_messaging/_drivers/amqpdriver.py"</span><span class="token punctuation">,</span> line <span class="token number">674</span><span class="token punctuation">,</span> in send
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">23</span><span class="token operator">:</span><span class="token number">48</span><span class="token operator">:</span><span class="token number">48.310</span> <span class="token number">2369</span> ERROR nova<span class="token punctuation">.</span>conductor<span class="token punctuation">.</span>manager     transport_options<span class="token operator">=</span>transport_options<span class="token punctuation">)</span>
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">23</span><span class="token operator">:</span><span class="token number">48</span><span class="token operator">:</span><span class="token number">48.310</span> <span class="token number">2369</span> ERROR nova<span class="token punctuation">.</span>conductor<span class="token punctuation">.</span>manager   File <span class="token string">"/usr/lib/python2.7/site-packages/oslo_messaging/_drivers/amqpdriver.py"</span><span class="token punctuation">,</span> line <span class="token number">664</span><span class="token punctuation">,</span> in _send
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">23</span><span class="token operator">:</span><span class="token number">48</span><span class="token operator">:</span><span class="token number">48.310</span> <span class="token number">2369</span> ERROR nova<span class="token punctuation">.</span>conductor<span class="token punctuation">.</span>manager     raise result
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">23</span><span class="token operator">:</span><span class="token number">48</span><span class="token operator">:</span><span class="token number">48.310</span> <span class="token number">2369</span> ERROR nova<span class="token punctuation">.</span>conductor<span class="token punctuation">.</span>manager NoValidHost_Remote<span class="token operator">:</span> \u627e\u4e0d\u5230\u6709\u6548\u4e3b\u673a\uff0c\u539f\u56e0\u662f \u6ca1\u6709\u8db3\u591f\u7684\u4e3b\u673a\u53ef\u7528\u3002\u3002
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">23</span><span class="token operator">:</span><span class="token number">48</span><span class="token operator">:</span><span class="token number">48.310</span> <span class="token number">2369</span> ERROR nova<span class="token punctuation">.</span>conductor<span class="token punctuation">.</span>manager <span class="token function">Traceback</span> <span class="token punctuation">(</span>most recent call last<span class="token punctuation">)</span><span class="token operator">:</span>
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">23</span><span class="token operator">:</span><span class="token number">48</span><span class="token operator">:</span><span class="token number">48.310</span> <span class="token number">2369</span> ERROR nova<span class="token punctuation">.</span>conductor<span class="token punctuation">.</span>manager 
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">23</span><span class="token operator">:</span><span class="token number">48</span><span class="token operator">:</span><span class="token number">48.310</span> <span class="token number">2369</span> ERROR nova<span class="token punctuation">.</span>conductor<span class="token punctuation">.</span>manager   File <span class="token string">"/usr/lib/python2.7/site-packages/oslo_messaging/rpc/server.py"</span><span class="token punctuation">,</span> line <span class="token number">235</span><span class="token punctuation">,</span> in inner
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">23</span><span class="token operator">:</span><span class="token number">48</span><span class="token operator">:</span><span class="token number">48.310</span> <span class="token number">2369</span> ERROR nova<span class="token punctuation">.</span>conductor<span class="token punctuation">.</span>manager     <span class="token keyword">return</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">*</span><span class="token operator">*</span>kwargs<span class="token punctuation">)</span>
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">23</span><span class="token operator">:</span><span class="token number">48</span><span class="token operator">:</span><span class="token number">48.310</span> <span class="token number">2369</span> ERROR nova<span class="token punctuation">.</span>conductor<span class="token punctuation">.</span>manager 
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">23</span><span class="token operator">:</span><span class="token number">48</span><span class="token operator">:</span><span class="token number">48.310</span> <span class="token number">2369</span> ERROR nova<span class="token punctuation">.</span>conductor<span class="token punctuation">.</span>manager   File <span class="token string">"/usr/lib/python2.7/site-packages/nova/scheduler/manager.py"</span><span class="token punctuation">,</span> line <span class="token number">214</span><span class="token punctuation">,</span> in select_destinations
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">23</span><span class="token operator">:</span><span class="token number">48</span><span class="token operator">:</span><span class="token number">48.310</span> <span class="token number">2369</span> ERROR nova<span class="token punctuation">.</span>conductor<span class="token punctuation">.</span>manager     allocation_request_version<span class="token punctuation">,</span> return_alternates<span class="token punctuation">)</span>
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">23</span><span class="token operator">:</span><span class="token number">48</span><span class="token operator">:</span><span class="token number">48.310</span> <span class="token number">2369</span> ERROR nova<span class="token punctuation">.</span>conductor<span class="token punctuation">.</span>manager 
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">23</span><span class="token operator">:</span><span class="token number">48</span><span class="token operator">:</span><span class="token number">48.310</span> <span class="token number">2369</span> ERROR nova<span class="token punctuation">.</span>conductor<span class="token punctuation">.</span>manager   File <span class="token string">"/usr/lib/python2.7/site-packages/nova/scheduler/filter_scheduler.py"</span><span class="token punctuation">,</span> line <span class="token number">96</span><span class="token punctuation">,</span> in select_destinations
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">23</span><span class="token operator">:</span><span class="token number">48</span><span class="token operator">:</span><span class="token number">48.310</span> <span class="token number">2369</span> ERROR nova<span class="token punctuation">.</span>conductor<span class="token punctuation">.</span>manager     allocation_request_version<span class="token punctuation">,</span> return_alternates<span class="token punctuation">)</span>
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">23</span><span class="token operator">:</span><span class="token number">48</span><span class="token operator">:</span><span class="token number">48.310</span> <span class="token number">2369</span> ERROR nova<span class="token punctuation">.</span>conductor<span class="token punctuation">.</span>manager 
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">23</span><span class="token operator">:</span><span class="token number">48</span><span class="token operator">:</span><span class="token number">48.310</span> <span class="token number">2369</span> ERROR nova<span class="token punctuation">.</span>conductor<span class="token punctuation">.</span>manager   File <span class="token string">"/usr/lib/python2.7/site-packages/nova/scheduler/filter_scheduler.py"</span><span class="token punctuation">,</span> line <span class="token number">265</span><span class="token punctuation">,</span> in _schedule
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">23</span><span class="token operator">:</span><span class="token number">48</span><span class="token operator">:</span><span class="token number">48.310</span> <span class="token number">2369</span> ERROR nova<span class="token punctuation">.</span>conductor<span class="token punctuation">.</span>manager     claimed_instance_uuids<span class="token punctuation">)</span>
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">23</span><span class="token operator">:</span><span class="token number">48</span><span class="token operator">:</span><span class="token number">48.310</span> <span class="token number">2369</span> ERROR nova<span class="token punctuation">.</span>conductor<span class="token punctuation">.</span>manager 
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">23</span><span class="token operator">:</span><span class="token number">48</span><span class="token operator">:</span><span class="token number">48.310</span> <span class="token number">2369</span> ERROR nova<span class="token punctuation">.</span>conductor<span class="token punctuation">.</span>manager   File <span class="token string">"/usr/lib/python2.7/site-packages/nova/scheduler/filter_scheduler.py"</span><span class="token punctuation">,</span> line <span class="token number">302</span><span class="token punctuation">,</span> in _ensure_sufficient_hosts
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">23</span><span class="token operator">:</span><span class="token number">48</span><span class="token operator">:</span><span class="token number">48.310</span> <span class="token number">2369</span> ERROR nova<span class="token punctuation">.</span>conductor<span class="token punctuation">.</span>manager     raise exception<span class="token punctuation">.</span><span class="token function">NoValidHost</span><span class="token punctuation">(</span>reason<span class="token operator">=</span>reason<span class="token punctuation">)</span>
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">23</span><span class="token operator">:</span><span class="token number">48</span><span class="token operator">:</span><span class="token number">48.310</span> <span class="token number">2369</span> ERROR nova<span class="token punctuation">.</span>conductor<span class="token punctuation">.</span>manager 
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">23</span><span class="token operator">:</span><span class="token number">48</span><span class="token operator">:</span><span class="token number">48.310</span> <span class="token number">2369</span> ERROR nova<span class="token punctuation">.</span>conductor<span class="token punctuation">.</span>manager NoValidHost<span class="token operator">:</span> \u627e\u4e0d\u5230\u6709\u6548\u4e3b\u673a\uff0c\u539f\u56e0\u662f \u6ca1\u6709\u8db3\u591f\u7684\u4e3b\u673a\u53ef\u7528\u3002\u3002
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">23</span><span class="token operator">:</span><span class="token number">48</span><span class="token operator">:</span><span class="token number">48.310</span> <span class="token number">2369</span> ERROR nova<span class="token punctuation">.</span>conductor<span class="token punctuation">.</span>manager 
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">23</span><span class="token operator">:</span><span class="token number">48</span><span class="token operator">:</span><span class="token number">48.310</span> <span class="token number">2369</span> ERROR nova<span class="token punctuation">.</span>conductor<span class="token punctuation">.</span>manager 
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">23</span><span class="token operator">:</span><span class="token number">48</span><span class="token operator">:</span><span class="token number">48.416</span> <span class="token number">2369</span> WARNING nova<span class="token punctuation">.</span>scheduler<span class="token punctuation">.</span>utils <span class="token punctuation">[</span>req<span class="token operator">-</span>ba7cca9e<span class="token operator">-</span><span class="token number">6</span>c0d<span class="token operator">-</span><span class="token number">4</span>a8e<span class="token operator">-</span>b657<span class="token operator">-</span><span class="token number">60673456</span>a472 <span class="token number">9942</span>eb4321644336a0c7383d9f1c2bed a7d812868cb74f1a978035530f55f1d0 <span class="token operator">-</span> <span class="token keyword">default</span> <span class="token keyword">default</span><span class="token punctuation">]</span> Failed to compute_task_build_instances<span class="token operator">:</span> 找不到有效主机，原因是 没有足够的主机可用。
<span class="token function">Traceback</span> <span class="token punctuation">(</span>most recent call last<span class="token punctuation">)</span><span class="token operator">:</span>

  File <span class="token string">"/usr/lib/python2.7/site-packages/oslo_messaging/rpc/server.py"</span><span class="token punctuation">,</span> line <span class="token number">235</span><span class="token punctuation">,</span> in inner
    <span class="token keyword">return</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">*</span><span class="token operator">*</span>kwargs<span class="token punctuation">)</span>

  File <span class="token string">"/usr/lib/python2.7/site-packages/nova/scheduler/manager.py"</span><span class="token punctuation">,</span> line <span class="token number">214</span><span class="token punctuation">,</span> in select_destinations
    allocation_request_version<span class="token punctuation">,</span> return_alternates<span class="token punctuation">)</span>

  File <span class="token string">"/usr/lib/python2.7/site-packages/nova/scheduler/filter_scheduler.py"</span><span class="token punctuation">,</span> line <span class="token number">96</span><span class="token punctuation">,</span> in select_destinations
    allocation_request_version<span class="token punctuation">,</span> return_alternates<span class="token punctuation">)</span>

  File <span class="token string">"/usr/lib/python2.7/site-packages/nova/scheduler/filter_scheduler.py"</span><span class="token punctuation">,</span> line <span class="token number">265</span><span class="token punctuation">,</span> in _schedule
    claimed_instance_uuids<span class="token punctuation">)</span>

  File <span class="token string">"/usr/lib/python2.7/site-packages/nova/scheduler/filter_scheduler.py"</span><span class="token punctuation">,</span> line <span class="token number">302</span><span class="token punctuation">,</span> in _ensure_sufficient_hosts
    raise exception<span class="token punctuation">.</span><span class="token function">NoValidHost</span><span class="token punctuation">(</span>reason<span class="token operator">=</span>reason<span class="token punctuation">)</span>

NoValidHost<span class="token operator">:</span> \u627e\u4e0d\u5230\u6709\u6548\u4e3b\u673a\uff0c\u539f\u56e0\u662f \u6ca1\u6709\u8db3\u591f\u7684\u4e3b\u673a\u53ef\u7528\u3002\u3002
<span class="token operator">:</span> NoValidHost_Remote<span class="token operator">:</span> \u627e\u4e0d\u5230\u6709\u6548\u4e3b\u673a\uff0c\u539f\u56e0\u662f \u6ca1\u6709\u8db3\u591f\u7684\u4e3b\u673a\u53ef\u7528\u3002\u3002
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">23</span><span class="token operator">:</span><span class="token number">48</span><span class="token operator">:</span><span class="token number">48.417</span> <span class="token number">2369</span> WARNING nova<span class="token punctuation">.</span>scheduler<span class="token punctuation">.</span>utils <span class="token punctuation">[</span>req<span class="token operator">-</span>ba7cca9e<span class="token operator">-</span><span class="token number">6</span>c0d<span class="token operator">-</span><span class="token number">4</span>a8e<span class="token operator">-</span>b657<span class="token operator">-</span><span class="token number">60673456</span>a472 <span class="token number">9942</span>eb4321644336a0c7383d9f1c2bed a7d812868cb74f1a978035530f55f1d0 <span class="token operator">-</span> <span class="token keyword">default</span> <span class="token keyword">default</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>instance<span class="token operator">:</span> <span class="token number">4f</span>75fd35<span class="token operator">-</span>c53c<span class="token operator">-</span><span class="token number">4f</span>eb<span class="token operator">-</span><span class="token number">90</span>bf<span class="token operator">-</span><span class="token number">391996</span>dee667<span class="token punctuation">]</span> Setting instance to ERROR state<span class="token punctuation">.</span><span class="token operator">:</span> NoValidHost_Remote<span class="token operator">:</span> \u627e\u4e0d\u5230\u6709\u6548\u4e3b\u673a\uff0c\u539f\u56e0\u662f \u6ca1\u6709\u8db3\u591f\u7684\u4e3b\u673a\u53ef\u7528\u3002\u3002
</code></pre>
<br>
<h3><a id="17ComputeCPU_713"></a>（17）增大Compute节点的内存和CPU容量</h3>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 扩大Compute节点的CPU到6核，内存到8G；</p>
<p>删除失败的节点：</p>
<pre><code class="prism language-cpp">openstack server <span class="token keyword">delete</span> centos7_new
</code></pre>
<p>重新创建server：</p>
<pre><code class="prism language-cpp">openstack server create <span class="token operator">--</span>image centos7_x86_64_2 <span class="token operator">--</span>flavor centos72  centos7_new
</code></pre>
<p>依然创建实例失败；</p>
<p>通过日志排查问题：<br>
&nbsp;  &nbsp;  &nbsp;  &nbsp; 首先查看nova-api.log日志，如下所示并没有发现特别异常的地方：</p>
<pre><code class="prism language-cpp"><span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">18</span> <span class="token number">11</span><span class="token operator">:</span><span class="token number">01</span><span class="token operator">:</span><span class="token number">03.995</span> <span class="token number">2295</span> INFO nova<span class="token punctuation">.</span>api<span class="token punctuation">.</span>openstack<span class="token punctuation">.</span>wsgi <span class="token punctuation">[</span>req<span class="token operator">-</span><span class="token number">35135749</span><span class="token operator">-</span><span class="token number">7627</span><span class="token operator">-</span><span class="token number">414f</span><span class="token operator">-</span>a6d9<span class="token operator">-</span><span class="token number">4</span>ce248e3906f <span class="token number">9942</span>eb4321644336a0c7383d9f1c2bed a7d812868cb74f1a978035530f55f1d0 <span class="token operator">-</span> <span class="token keyword">default</span> <span class="token keyword">default</span><span class="token punctuation">]</span> HTTP exception thrown<span class="token operator">:</span> 云主机类型 centos72 没有找到。
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">18</span> <span class="token number">11</span><span class="token operator">:</span><span class="token number">01</span><span class="token operator">:</span><span class="token number">03.997</span> <span class="token number">2295</span> INFO nova<span class="token punctuation">.</span>osapi_compute<span class="token punctuation">.</span>wsgi<span class="token punctuation">.</span>server <span class="token punctuation">[</span>req<span class="token operator">-</span><span class="token number">35135749</span><span class="token operator">-</span><span class="token number">7627</span><span class="token operator">-</span><span class="token number">414f</span><span class="token operator">-</span>a6d9<span class="token operator">-</span><span class="token number">4</span>ce248e3906f <span class="token number">9942</span>eb4321644336a0c7383d9f1c2bed a7d812868cb74f1a978035530f55f1d0 <span class="token operator">-</span> <span class="token keyword">default</span> <span class="token keyword">default</span><span class="token punctuation">]</span> <span class="token number">192.168</span><span class="token punctuation">.</span><span class="token number">112.146</span> <span class="token string">"GET /v2.1/flavors/centos72 HTTP/1.1"</span> status<span class="token operator">:</span> <span class="token number">404</span> len<span class="token operator">:</span> <span class="token number">537</span> time<span class="token operator">:</span> <span class="token number">0.0310740</span>
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">18</span> <span class="token number">11</span><span class="token operator">:</span><span class="token number">01</span><span class="token operator">:</span><span class="token number">04.048</span> <span class="token number">2295</span> INFO nova<span class="token punctuation">.</span>osapi_compute<span class="token punctuation">.</span>wsgi<span class="token punctuation">.</span>server <span class="token punctuation">[</span>req<span class="token operator">-</span>ff217a3e<span class="token operator">-</span><span class="token number">5911</span><span class="token operator">-</span><span class="token number">4</span>bd1<span class="token operator">-</span><span class="token number">98</span>a0<span class="token operator">-</span>a2c18c67f749 <span class="token number">9942</span>eb4321644336a0c7383d9f1c2bed a7d812868cb74f1a978035530f55f1d0 <span class="token operator">-</span> <span class="token keyword">default</span> <span class="token keyword">default</span><span class="token punctuation">]</span> <span class="token number">192.168</span><span class="token punctuation">.</span><span class="token number">112.146</span> <span class="token string">"GET /v2.1/flavors HTTP/1.1"</span> status<span class="token operator">:</span> <span class="token number">200</span> len<span class="token operator">:</span> <span class="token number">965</span> time<span class="token operator">:</span> <span class="token number">0.0419452</span>
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">18</span> <span class="token number">11</span><span class="token operator">:</span><span class="token number">01</span><span class="token operator">:</span><span class="token number">04.085</span> <span class="token number">2295</span> INFO nova<span class="token punctuation">.</span>osapi_compute<span class="token punctuation">.</span>wsgi<span class="token punctuation">.</span>server <span class="token punctuation">[</span>req<span class="token operator">-</span>da335951<span class="token operator">-</span><span class="token number">60</span>ca<span class="token operator">-</span><span class="token number">41</span>bf<span class="token operator">-</span>b1fc<span class="token operator">-</span>b24fbd76b8c7 <span class="token number">9942</span>eb4321644336a0c7383d9f1c2bed a7d812868cb74f1a978035530f55f1d0 <span class="token operator">-</span> <span class="token keyword">default</span> <span class="token keyword">default</span><span class="token punctuation">]</span> <span class="token number">192.168</span><span class="token punctuation">.</span><span class="token number">112.146</span> <span class="token string">"GET /v2.1/flavors/3 HTTP/1.1"</span> status<span class="token operator">:</span> <span class="token number">200</span> len<span class="token operator">:</span> <span class="token number">766</span> time<span class="token operator">:</span> <span class="token number">0.0295641</span>
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">18</span> <span class="token number">11</span><span class="token operator">:</span><span class="token number">01</span><span class="token operator">:</span><span class="token number">05.811</span> <span class="token number">2295</span> INFO nova<span class="token punctuation">.</span>osapi_compute<span class="token punctuation">.</span>wsgi<span class="token punctuation">.</span>server <span class="token punctuation">[</span>req<span class="token operator">-</span>fbf96a04<span class="token operator">-</span><span class="token number">09</span>d5<span class="token operator">-</span><span class="token number">4e3</span>d<span class="token operator">-</span>bf35<span class="token operator">-</span><span class="token number">9</span>b0935969296 <span class="token number">9942</span>eb4321644336a0c7383d9f1c2bed a7d812868cb74f1a978035530f55f1d0 <span class="token operator">-</span> <span class="token keyword">default</span> <span class="token keyword">default</span><span class="token punctuation">]</span> <span class="token number">192.168</span><span class="token punctuation">.</span><span class="token number">112.146</span> <span class="token string">"POST /v2.1/servers HTTP/1.1"</span> status<span class="token operator">:</span> <span class="token number">202</span> len<span class="token operator">:</span> <span class="token number">876</span> time<span class="token operator">:</span> <span class="token number">1.6947610</span>
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">18</span> <span class="token number">11</span><span class="token operator">:</span><span class="token number">01</span><span class="token operator">:</span><span class="token number">05.962</span> <span class="token number">2295</span> INFO nova<span class="token punctuation">.</span>osapi_compute<span class="token punctuation">.</span>wsgi<span class="token punctuation">.</span>server <span class="token punctuation">[</span>req<span class="token operator">-</span>b6cae590<span class="token operator">-</span><span class="token number">65</span>b7<span class="token operator">-</span><span class="token number">4f</span>c6<span class="token operator">-</span><span class="token number">948</span>c<span class="token operator">-</span>acf3d7a1c23b <span class="token number">9942</span>eb4321644336a0c7383d9f1c2bed a7d812868cb74f1a978035530f55f1d0 <span class="token operator">-</span> <span class="token keyword">default</span> <span class="token keyword">default</span><span class="token punctuation">]</span> <span class="token number">192.168</span><span class="token punctuation">.</span><span class="token number">112.146</span> <span class="token string">"GET /v2.1/servers/2d43331b-bcff-43af-be11-5c3eefd8b7a5 HTTP/1.1"</span> status<span class="token operator">:</span> <span class="token number">200</span> len<span class="token operator">:</span> <span class="token number">1691</span> time<span class="token operator">:</span> <span class="token number">0.1441481</span>
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">18</span> <span class="token number">11</span><span class="token operator">:</span><span class="token number">01</span><span class="token operator">:</span><span class="token number">06.046</span> <span class="token number">2295</span> INFO nova<span class="token punctuation">.</span>osapi_compute<span class="token punctuation">.</span>wsgi<span class="token punctuation">.</span>server <span class="token punctuation">[</span>req<span class="token operator">-</span><span class="token number">914736</span>ca<span class="token operator">-</span><span class="token number">0</span>b90<span class="token operator">-</span><span class="token number">4628</span><span class="token operator">-</span>ac4b<span class="token operator">-</span>f53c92653224 <span class="token number">9942</span>eb4321644336a0c7383d9f1c2bed a7d812868cb74f1a978035530f55f1d0 <span class="token operator">-</span> <span class="token keyword">default</span> <span class="token keyword">default</span><span class="token punctuation">]</span> <span class="token number">192.168</span><span class="token punctuation">.</span><span class="token number">112.146</span> <span class="token string">"GET /v2.1/flavors/3 HTTP/1.1"</span> status<span class="token operator">:</span> <span class="token number">200</span> len<span class="token operator">:</span> <span class="token number">766</span> time<span class="token operator">:</span> <span class="token number">0.0342619</span>
</code></pre>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 继续排查nova-scheduler.log日志，</p>
<pre><code class="prism language-cpp"><span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">18</span> <span class="token number">11</span><span class="token operator">:</span><span class="token number">01</span><span class="token operator">:</span><span class="token number">09.117</span> <span class="token number">2629</span> WARNING nova<span class="token punctuation">.</span>scheduler<span class="token punctuation">.</span>filters<span class="token punctuation">.</span>compute_filter <span class="token punctuation">[</span>req<span class="token operator">-</span>fbf96a04<span class="token operator">-</span><span class="token number">09</span>d5<span class="token operator">-</span><span class="token number">4e3</span>d<span class="token operator">-</span>bf35<span class="token operator">-</span><span class="token number">9</span>b0935969296 <span class="token number">9942</span>eb4321644336a0c7383d9f1c2bed a7d812868cb74f1a978035530f55f1d0 <span class="token operator">-</span> <span class="token keyword">default</span> <span class="token keyword">default</span><span class="token punctuation">]</span> <span class="token punctuation">(</span>localhost<span class="token punctuation">.</span>localdomain<span class="token punctuation">,</span> localhost<span class="token punctuation">.</span>localdomain<span class="token punctuation">)</span> ram<span class="token operator">:</span> <span class="token number">3258</span>MB disk<span class="token operator">:</span> <span class="token number">32768</span>MB io_ops<span class="token operator">:</span> <span class="token number">0</span> instances<span class="token operator">:</span> <span class="token number">0</span> has <span class="token operator">not</span> been heard from in a <span class="token keyword">while</span>
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">18</span> <span class="token number">11</span><span class="token operator">:</span><span class="token number">01</span><span class="token operator">:</span><span class="token number">09.141</span> <span class="token number">2629</span> INFO nova<span class="token punctuation">.</span>filters <span class="token punctuation">[</span>req<span class="token operator">-</span>fbf96a04<span class="token operator">-</span><span class="token number">09</span>d5<span class="token operator">-</span><span class="token number">4e3</span>d<span class="token operator">-</span>bf35<span class="token operator">-</span><span class="token number">9</span>b0935969296 <span class="token number">9942</span>eb4321644336a0c7383d9f1c2bed a7d812868cb74f1a978035530f55f1d0 <span class="token operator">-</span> <span class="token keyword">default</span> <span class="token keyword">default</span><span class="token punctuation">]</span> Filter ComputeFilter returned <span class="token number">0</span> hosts
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">18</span> <span class="token number">11</span><span class="token operator">:</span><span class="token number">01</span><span class="token operator">:</span><span class="token number">09.142</span> <span class="token number">2629</span> INFO nova<span class="token punctuation">.</span>filters <span class="token punctuation">[</span>req<span class="token operator">-</span>fbf96a04<span class="token operator">-</span><span class="token number">09</span>d5<span class="token operator">-</span><span class="token number">4e3</span>d<span class="token operator">-</span>bf35<span class="token operator">-</span><span class="token number">9</span>b0935969296 <span class="token number">9942</span>eb4321644336a0c7383d9f1c2bed a7d812868cb74f1a978035530f55f1d0 <span class="token operator">-</span> <span class="token keyword">default</span> <span class="token keyword">default</span><span class="token punctuation">]</span> Filtering removed all hosts <span class="token keyword">for</span> the request with instance ID <span class="token string">'2d43331b-bcff-43af-be11-5c3eefd8b7a5'</span><span class="token punctuation">.</span> Filter results<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'AvailabilityZoneFilter: (start: 1, end: 1)'</span><span class="token punctuation">,</span> <span class="token string">'ComputeFilter: (start: 1, end: 0)'</span><span class="token punctuation">]</span>
</code></pre>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 查看nova-conductor.log日志：</p>
<pre><code class="prism language-cpp"><span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">18</span> <span class="token number">11</span><span class="token operator">:</span><span class="token number">01</span><span class="token operator">:</span><span class="token number">09.216</span> <span class="token number">2391</span> ERROR nova<span class="token punctuation">.</span>conductor<span class="token punctuation">.</span>manager <span class="token punctuation">[</span>req<span class="token operator">-</span>fbf96a04<span class="token operator">-</span><span class="token number">09</span>d5<span class="token operator">-</span><span class="token number">4e3</span>d<span class="token operator">-</span>bf35<span class="token operator">-</span><span class="token number">9</span>b0935969296 <span class="token number">9942</span>eb4321644336a0c7383d9f1c2bed a7d812868cb74f1a978035530f55f1d0 <span class="token operator">-</span> <span class="token keyword">default</span> <span class="token keyword">default</span><span class="token punctuation">]</span> Failed to schedule instances<span class="token operator">:</span> NoValidHost_Remote<span class="token operator">:</span> \u627e\u4e0d\u5230\u6709\u6548\u4e3b\u673a\uff0c\u539f\u56e0\u662f \u6ca1\u6709\u8db3\u591f\u7684\u4e3b\u673a\u53ef\u7528\u3002\u3002
<span class="token function">Traceback</span> <span class="token punctuation">(</span>most recent call last<span class="token punctuation">)</span><span class="token operator">:</span>

  File <span class="token string">"/usr/lib/python2.7/site-packages/oslo_messaging/rpc/server.py"</span><span class="token punctuation">,</span> line <span class="token number">235</span><span class="token punctuation">,</span> in inner
    <span class="token keyword">return</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">*</span><span class="token operator">*</span>kwargs<span class="token punctuation">)</span>

  File <span class="token string">"/usr/lib/python2.7/site-packages/nova/scheduler/manager.py"</span><span class="token punctuation">,</span> line <span class="token number">214</span><span class="token punctuation">,</span> in select_destinations
    allocation_request_version<span class="token punctuation">,</span> return_alternates<span class="token punctuation">)</span>

  File <span class="token string">"/usr/lib/python2.7/site-packages/nova/scheduler/filter_scheduler.py"</span><span class="token punctuation">,</span> line <span class="token number">96</span><span class="token punctuation">,</span> in select_destinations
    allocation_request_version<span class="token punctuation">,</span> return_alternates<span class="token punctuation">)</span>

  File <span class="token string">"/usr/lib/python2.7/site-packages/nova/scheduler/filter_scheduler.py"</span><span class="token punctuation">,</span> line <span class="token number">265</span><span class="token punctuation">,</span> in _schedule
    claimed_instance_uuids<span class="token punctuation">)</span>

  File <span class="token string">"/usr/lib/python2.7/site-packages/nova/scheduler/filter_scheduler.py"</span><span class="token punctuation">,</span> line <span class="token number">302</span><span class="token punctuation">,</span> in _ensure_sufficient_hosts
    raise exception<span class="token punctuation">.</span><span class="token function">NoValidHost</span><span class="token punctuation">(</span>reason<span class="token operator">=</span>reason<span class="token punctuation">)</span>

NoValidHost<span class="token operator">:</span> \u627e\u4e0d\u5230\u6709\u6548\u4e3b\u673a\uff0c\u539f\u56e0\u662f \u6ca1\u6709\u8db3\u591f\u7684\u4e3b\u673a\u53ef\u7528\u3002\u3002
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">18</span> <span class="token number">11</span><span class="token operator">:</span><span class="token number">01</span><span class="token operator">:</span><span class="token number">09.216</span> <span class="token number">2391</span> ERROR nova<span class="token punctuation">.</span>conductor<span class="token punctuation">.</span>manager <span class="token function">Traceback</span> <span class="token punctuation">(</span>most recent call last<span class="token punctuation">)</span><span class="token operator">:</span>
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">18</span> <span class="token number">11</span><span class="token operator">:</span><span class="token number">01</span><span class="token operator">:</span><span class="token number">09.216</span> <span class="token number">2391</span> ERROR nova<span class="token punctuation">.</span>conductor<span class="token punctuation">.</span>manager   File <span class="token string">"/usr/lib/python2.7/site-packages/nova/conductor/manager.py"</span><span class="token punctuation">,</span> line <span class="token number">1379</span><span class="token punctuation">,</span> in schedule_and_build_instances
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">18</span> <span class="token number">11</span><span class="token operator">:</span><span class="token number">01</span><span class="token operator">:</span><span class="token number">09.216</span> <span class="token number">2391</span> ERROR nova<span class="token punctuation">.</span>conductor<span class="token punctuation">.</span>manager     instance_uuids<span class="token punctuation">,</span> return_alternates<span class="token operator">=</span>True<span class="token punctuation">)</span>
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">18</span> <span class="token number">11</span><span class="token operator">:</span><span class="token number">01</span><span class="token operator">:</span><span class="token number">09.216</span> <span class="token number">2391</span> ERROR nova<span class="token punctuation">.</span>conductor<span class="token punctuation">.</span>manager   File <span class="token string">"/usr/lib/python2.7/site-packages/nova/conductor/manager.py"</span><span class="token punctuation">,</span> line <span class="token number">839</span><span class="token punctuation">,</span> in _schedule_instances
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">18</span> <span class="token number">11</span><span class="token operator">:</span><span class="token number">01</span><span class="token operator">:</span><span class="token number">09.216</span> <span class="token number">2391</span> ERROR nova<span class="token punctuation">.</span>conductor<span class="token punctuation">.</span>manager     return_alternates<span class="token operator">=</span>return_alternates<span class="token punctuation">)</span>
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">18</span> <span class="token number">11</span><span class="token operator">:</span><span class="token number">01</span><span class="token operator">:</span><span class="token number">09.216</span> <span class="token number">2391</span> ERROR nova<span class="token punctuation">.</span>conductor<span class="token punctuation">.</span>manager   File <span class="token string">"/usr/lib/python2.7/site-packages/nova/scheduler/client/query.py"</span><span class="token punctuation">,</span> line <span class="token number">42</span><span class="token punctuation">,</span> in select_destinations
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">18</span> <span class="token number">11</span><span class="token operator">:</span><span class="token number">01</span><span class="token operator">:</span><span class="token number">09.216</span> <span class="token number">2391</span> ERROR nova<span class="token punctuation">.</span>conductor<span class="token punctuation">.</span>manager     instance_uuids<span class="token punctuation">,</span> return_objects<span class="token punctuation">,</span> return_alternates<span class="token punctuation">)</span>
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">18</span> <span class="token number">11</span><span class="token operator">:</span><span class="token number">01</span><span class="token operator">:</span><span class="token number">09.216</span> <span class="token number">2391</span> ERROR nova<span class="token punctuation">.</span>conductor<span class="token punctuation">.</span>manager   File <span class="token string">"/usr/lib/python2.7/site-packages/nova/scheduler/rpcapi.py"</span><span class="token punctuation">,</span> line <span class="token number">160</span><span class="token punctuation">,</span> in select_destinations
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">18</span> <span class="token number">11</span><span class="token operator">:</span><span class="token number">01</span><span class="token operator">:</span><span class="token number">09.216</span> <span class="token number">2391</span> ERROR nova<span class="token punctuation">.</span>conductor<span class="token punctuation">.</span>manager     <span class="token keyword">return</span> cctxt<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>ctxt<span class="token punctuation">,</span> <span class="token string">'select_destinations'</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token operator">*</span>msg_args<span class="token punctuation">)</span>
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">18</span> <span class="token number">11</span><span class="token operator">:</span><span class="token number">01</span><span class="token operator">:</span><span class="token number">09.216</span> <span class="token number">2391</span> ERROR nova<span class="token punctuation">.</span>conductor<span class="token punctuation">.</span>manager   File <span class="token string">"/usr/lib/python2.7/site-packages/oslo_messaging/rpc/client.py"</span><span class="token punctuation">,</span> line <span class="token number">181</span><span class="token punctuation">,</span> in call
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">18</span> <span class="token number">11</span><span class="token operator">:</span><span class="token number">01</span><span class="token operator">:</span><span class="token number">09.216</span> <span class="token number">2391</span> ERROR nova<span class="token punctuation">.</span>conductor<span class="token punctuation">.</span>manager     transport_options<span class="token operator">=</span>self<span class="token punctuation">.</span>transport_options<span class="token punctuation">)</span>
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">18</span> <span class="token number">11</span><span class="token operator">:</span><span class="token number">01</span><span class="token operator">:</span><span class="token number">09.216</span> <span class="token number">2391</span> ERROR nova<span class="token punctuation">.</span>conductor<span class="token punctuation">.</span>manager   File <span class="token string">"/usr/lib/python2.7/site-packages/oslo_messaging/transport.py"</span><span class="token punctuation">,</span> line <span class="token number">129</span><span class="token punctuation">,</span> in _send
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">18</span> <span class="token number">11</span><span class="token operator">:</span><span class="token number">01</span><span class="token operator">:</span><span class="token number">09.216</span> <span class="token number">2391</span> ERROR nova<span class="token punctuation">.</span>conductor<span class="token punctuation">.</span>manager     transport_options<span class="token operator">=</span>transport_options<span class="token punctuation">)</span>
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">18</span> <span class="token number">11</span><span class="token operator">:</span><span class="token number">01</span><span class="token operator">:</span><span class="token number">09.216</span> <span class="token number">2391</span> ERROR nova<span class="token punctuation">.</span>conductor<span class="token punctuation">.</span>manager   File <span class="token string">"/usr/lib/python2.7/site-packages/oslo_messaging/_drivers/amqpdriver.py"</span><span class="token punctuation">,</span> line <span class="token number">674</span><span class="token punctuation">,</span> in send
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">18</span> <span class="token number">11</span><span class="token operator">:</span><span class="token number">01</span><span class="token operator">:</span><span class="token number">09.216</span> <span class="token number">2391</span> ERROR nova<span class="token punctuation">.</span>conductor<span class="token punctuation">.</span>manager     transport_options<span class="token operator">=</span>transport_options<span class="token punctuation">)</span>
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">18</span> <span class="token number">11</span><span class="token operator">:</span><span class="token number">01</span><span class="token operator">:</span><span class="token number">09.216</span> <span class="token number">2391</span> ERROR nova<span class="token punctuation">.</span>conductor<span class="token punctuation">.</span>manager   File <span class="token string">"/usr/lib/python2.7/site-packages/oslo_messaging/_drivers/amqpdriver.py"</span><span class="token punctuation">,</span> line <span class="token number">664</span><span class="token punctuation">,</span> in _send
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">18</span> <span class="token number">11</span><span class="token operator">:</span><span class="token number">01</span><span class="token operator">:</span><span class="token number">09.216</span> <span class="token number">2391</span> ERROR nova<span class="token punctuation">.</span>conductor<span class="token punctuation">.</span>manager     raise result
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">18</span> <span class="token number">11</span><span class="token operator">:</span><span class="token number">01</span><span class="token operator">:</span><span class="token number">09.216</span> <span class="token number">2391</span> ERROR nova<span class="token punctuation">.</span>conductor<span class="token punctuation">.</span>manager NoValidHost_Remote<span class="token operator">:</span> \u627e\u4e0d\u5230\u6709\u6548\u4e3b\u673a\uff0c\u539f\u56e0\u662f \u6ca1\u6709\u8db3\u591f\u7684\u4e3b\u673a\u53ef\u7528\u3002\u3002
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">18</span> <span class="token number">11</span><span class="token operator">:</span><span class="token number">01</span><span class="token operator">:</span><span class="token number">09.216</span> <span class="token number">2391</span> ERROR nova<span class="token punctuation">.</span>conductor<span class="token punctuation">.</span>manager <span class="token function">Traceback</span> <span class="token punctuation">(</span>most recent call last<span class="token punctuation">)</span><span class="token operator">:</span>
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">18</span> <span class="token number">11</span><span class="token operator">:</span><span class="token number">01</span><span class="token operator">:</span><span class="token number">09.216</span> <span class="token number">2391</span> ERROR nova<span class="token punctuation">.</span>conductor<span class="token punctuation">.</span>manager 
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">18</span> <span class="token number">11</span><span class="token operator">:</span><span class="token number">01</span><span class="token operator">:</span><span class="token number">09.216</span> <span class="token number">2391</span> ERROR nova<span class="token punctuation">.</span>conductor<span class="token punctuation">.</span>manager   File <span class="token string">"/usr/lib/python2.7/site-packages/oslo_messaging/rpc/server.py"</span><span class="token punctuation">,</span> line <span class="token number">235</span><span class="token punctuation">,</span> in inner
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">18</span> <span class="token number">11</span><span class="token operator">:</span><span class="token number">01</span><span class="token operator">:</span><span class="token number">09.216</span> <span class="token number">2391</span> ERROR nova<span class="token punctuation">.</span>conductor<span class="token punctuation">.</span>manager     <span class="token keyword">return</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">*</span><span class="token operator">*</span>kwargs<span class="token punctuation">)</span>
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">18</span> <span class="token number">11</span><span class="token operator">:</span><span class="token number">01</span><span class="token operator">:</span><span class="token number">09.216</span> <span class="token number">2391</span> ERROR nova<span class="token punctuation">.</span>conductor<span class="token punctuation">.</span>manager 
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">18</span> <span class="token number">11</span><span class="token operator">:</span><span class="token number">01</span><span class="token operator">:</span><span class="token number">09.216</span> <span class="token number">2391</span> ERROR nova<span class="token punctuation">.</span>conductor<span class="token punctuation">.</span>manager   File <span class="token string">"/usr/lib/python2.7/site-packages/nova/scheduler/manager.py"</span><span class="token punctuation">,</span> line <span class="token number">214</span><span class="token punctuation">,</span> in select_destinations
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">18</span> <span class="token number">11</span><span class="token operator">:</span><span class="token number">01</span><span class="token operator">:</span><span class="token number">09.216</span> <span class="token number">2391</span> ERROR nova<span class="token punctuation">.</span>conductor<span class="token punctuation">.</span>manager     allocation_request_version<span class="token punctuation">,</span> return_alternates<span class="token punctuation">)</span>
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">18</span> <span class="token number">11</span><span class="token operator">:</span><span class="token number">01</span><span class="token operator">:</span><span class="token number">09.216</span> <span class="token number">2391</span> ERROR nova<span class="token punctuation">.</span>conductor<span class="token punctuation">.</span>manager 
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">18</span> <span class="token number">11</span><span class="token operator">:</span><span class="token number">01</span><span class="token operator">:</span><span class="token number">09.216</span> <span class="token number">2391</span> ERROR nova<span class="token punctuation">.</span>conductor<span class="token punctuation">.</span>manager   File <span class="token string">"/usr/lib/python2.7/site-packages/nova/scheduler/filter_scheduler.py"</span><span class="token punctuation">,</span> line <span class="token number">96</span><span class="token punctuation">,</span> in select_destinations
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">18</span> <span class="token number">11</span><span class="token operator">:</span><span class="token number">01</span><span class="token operator">:</span><span class="token number">09.216</span> <span class="token number">2391</span> ERROR nova<span class="token punctuation">.</span>conductor<span class="token punctuation">.</span>manager     allocation_request_version<span class="token punctuation">,</span> return_alternates<span class="token punctuation">)</span>
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">18</span> <span class="token number">11</span><span class="token operator">:</span><span class="token number">01</span><span class="token operator">:</span><span class="token number">09.216</span> <span class="token number">2391</span> ERROR nova<span class="token punctuation">.</span>conductor<span class="token punctuation">.</span>manager 
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">18</span> <span class="token number">11</span><span class="token operator">:</span><span class="token number">01</span><span class="token operator">:</span><span class="token number">09.216</span> <span class="token number">2391</span> ERROR nova<span class="token punctuation">.</span>conductor<span class="token punctuation">.</span>manager   File <span class="token string">"/usr/lib/python2.7/site-packages/nova/scheduler/filter_scheduler.py"</span><span class="token punctuation">,</span> line <span class="token number">265</span><span class="token punctuation">,</span> in _schedule
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">18</span> <span class="token number">11</span><span class="token operator">:</span><span class="token number">01</span><span class="token operator">:</span><span class="token number">09.216</span> <span class="token number">2391</span> ERROR nova<span class="token punctuation">.</span>conductor<span class="token punctuation">.</span>manager     claimed_instance_uuids<span class="token punctuation">)</span>
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">18</span> <span class="token number">11</span><span class="token operator">:</span><span class="token number">01</span><span class="token operator">:</span><span class="token number">09.216</span> <span class="token number">2391</span> ERROR nova<span class="token punctuation">.</span>conductor<span class="token punctuation">.</span>manager 
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">18</span> <span class="token number">11</span><span class="token operator">:</span><span class="token number">01</span><span class="token operator">:</span><span class="token number">09.216</span> <span class="token number">2391</span> ERROR nova<span class="token punctuation">.</span>conductor<span class="token punctuation">.</span>manager   File <span class="token string">"/usr/lib/python2.7/site-packages/nova/scheduler/filter_scheduler.py"</span><span class="token punctuation">,</span> line <span class="token number">302</span><span class="token punctuation">,</span> in _ensure_sufficient_hosts
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">18</span> <span class="token number">11</span><span class="token operator">:</span><span class="token number">01</span><span class="token operator">:</span><span class="token number">09.216</span> <span class="token number">2391</span> ERROR nova<span class="token punctuation">.</span>conductor<span class="token punctuation">.</span>manager     raise exception<span class="token punctuation">.</span><span class="token function">NoValidHost</span><span class="token punctuation">(</span>reason<span class="token operator">=</span>reason<span class="token punctuation">)</span>
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">18</span> <span class="token number">11</span><span class="token operator">:</span><span class="token number">01</span><span class="token operator">:</span><span class="token number">09.216</span> <span class="token number">2391</span> ERROR nova<span class="token punctuation">.</span>conductor<span class="token punctuation">.</span>manager 
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">18</span> <span class="token number">11</span><span class="token operator">:</span><span class="token number">01</span><span class="token operator">:</span><span class="token number">09.216</span> <span class="token number">2391</span> ERROR nova<span class="token punctuation">.</span>conductor<span class="token punctuation">.</span>manager NoValidHost<span class="token operator">:</span> \u627e\u4e0d\u5230\u6709\u6548\u4e3b\u673a\uff0c\u539f\u56e0\u662f \u6ca1\u6709\u8db3\u591f\u7684\u4e3b\u673a\u53ef\u7528\u3002\u3002
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">18</span> <span class="token number">11</span><span class="token operator">:</span><span class="token number">01</span><span class="token operator">:</span><span class="token number">09.216</span> <span class="token number">2391</span> ERROR nova<span class="token punctuation">.</span>conductor<span class="token punctuation">.</span>manager 
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">18</span> <span class="token number">11</span><span class="token operator">:</span><span class="token number">01</span><span class="token operator">:</span><span class="token number">09.216</span> <span class="token number">2391</span> ERROR nova<span class="token punctuation">.</span>conductor<span class="token punctuation">.</span>manager 
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">18</span> <span class="token number">11</span><span class="token operator">:</span><span class="token number">01</span><span class="token operator">:</span><span class="token number">09.638</span> <span class="token number">2391</span> WARNING nova<span class="token punctuation">.</span>scheduler<span class="token punctuation">.</span>utils <span class="token punctuation">[</span>req<span class="token operator">-</span>fbf96a04<span class="token operator">-</span><span class="token number">09</span>d5<span class="token operator">-</span><span class="token number">4e3</span>d<span class="token operator">-</span>bf35<span class="token operator">-</span><span class="token number">9</span>b0935969296 <span class="token number">9942</span>eb4321644336a0c7383d9f1c2bed a7d812868cb74f1a978035530f55f1d0 <span class="token operator">-</span> <span class="token keyword">default</span> <span class="token keyword">default</span><span class="token punctuation">]</span> Failed to compute_task_build_instances<span class="token operator">:</span> 找不到有效主机，原因是 没有足够的主机可用。。
<span class="token function">Traceback</span> <span class="token punctuation">(</span>most recent call last<span class="token punctuation">)</span><span class="token operator">:</span>

  File <span class="token string">"/usr/lib/python2.7/site-packages/oslo_messaging/rpc/server.py"</span><span class="token punctuation">,</span> line <span class="token number">235</span><span class="token punctuation">,</span> in inner
    <span class="token keyword">return</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">*</span><span class="token operator">*</span>kwargs<span class="token punctuation">)</span>

  File <span class="token string">"/usr/lib/python2.7/site-packages/nova/scheduler/manager.py"</span><span class="token punctuation">,</span> line <span class="token number">214</span><span class="token punctuation">,</span> in select_destinations
    allocation_request_version<span class="token punctuation">,</span> return_alternates<span class="token punctuation">)</span>

  File <span class="token string">"/usr/lib/python2.7/site-packages/nova/scheduler/filter_scheduler.py"</span><span class="token punctuation">,</span> line <span class="token number">96</span><span class="token punctuation">,</span> in select_destinations
    allocation_request_version<span class="token punctuation">,</span> return_alternates<span class="token punctuation">)</span>

  File <span class="token string">"/usr/lib/python2.7/site-packages/nova/scheduler/filter_scheduler.py"</span><span class="token punctuation">,</span> line <span class="token number">265</span><span class="token punctuation">,</span> in _schedule
    claimed_instance_uuids<span class="token punctuation">)</span>

  File <span class="token string">"/usr/lib/python2.7/site-packages/nova/scheduler/filter_scheduler.py"</span><span class="token punctuation">,</span> line <span class="token number">302</span><span class="token punctuation">,</span> in _ensure_sufficient_hosts
    raise exception<span class="token punctuation">.</span><span class="token function">NoValidHost</span><span class="token punctuation">(</span>reason<span class="token operator">=</span>reason<span class="token punctuation">)</span>

NoValidHost<span class="token operator">:</span> \u627e\u4e0d\u5230\u6709\u6548\u4e3b\u673a\uff0c\u539f\u56e0\u662f \u6ca1\u6709\u8db3\u591f\u7684\u4e3b\u673a\u53ef\u7528\u3002\u3002
<span class="token operator">:</span> NoValidHost_Remote<span class="token operator">:</span> \u627e\u4e0d\u5230\u6709\u6548\u4e3b\u673a\uff0c\u539f\u56e0\u662f \u6ca1\u6709\u8db3\u591f\u7684\u4e3b\u673a\u53ef\u7528\u3002\u3002
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">18</span> <span class="token number">11</span><span class="token operator">:</span><span class="token number">01</span><span class="token operator">:</span><span class="token number">09.646</span> <span class="token number">2391</span> WARNING nova<span class="token punctuation">.</span>scheduler<span class="token punctuation">.</span>utils <span class="token punctuation">[</span>req<span class="token operator">-</span>fbf96a04<span class="token operator">-</span><span class="token number">09</span>d5<span class="token operator">-</span><span class="token number">4e3</span>d<span class="token operator">-</span>bf35<span class="token operator">-</span><span class="token number">9</span>b0935969296 <span class="token number">9942</span>eb4321644336a0c7383d9f1c2bed a7d812868cb74f1a978035530f55f1d0 <span class="token operator">-</span> <span class="token keyword">default</span> <span class="token keyword">default</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>instance<span class="token operator">:</span> <span class="token number">2</span>d43331b<span class="token operator">-</span>bcff<span class="token operator">-</span><span class="token number">43</span>af<span class="token operator">-</span>be11<span class="token operator">-</span><span class="token number">5</span>c3eefd8b7a5<span class="token punctuation">]</span> Setting instance to ERROR state<span class="token punctuation">.</span><span class="token operator">:</span> NoValidHost_Remote<span class="token operator">:</span> \u627e\u4e0d\u5230\u6709\u6548\u4e3b\u673a\uff0c\u539f\u56e0\u662f \u6ca1\u6709\u8db3\u591f\u7684\u4e3b\u673a\u53ef\u7528\u3002\u3002
</code></pre>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 查看nova-compute.log日志，没看出来有什么异常：</p>
<pre><code class="prism language-cpp"><span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">18</span> <span class="token number">11</span><span class="token operator">:</span><span class="token number">04</span><span class="token operator">:</span><span class="token number">22.905</span> <span class="token number">1556</span> INFO nova<span class="token punctuation">.</span>virt<span class="token punctuation">.</span>libvirt<span class="token punctuation">.</span>imagecache <span class="token punctuation">[</span>req<span class="token operator">-</span>caca30f2<span class="token operator">-</span>fddc<span class="token operator">-</span><span class="token number">48</span>ed<span class="token operator">-</span>a0f9<span class="token operator">-</span>d7250fb69311 <span class="token operator">-</span> <span class="token operator">-</span> <span class="token operator">-</span> <span class="token operator">-</span> <span class="token operator">-</span><span class="token punctuation">]</span> image <span class="token number">853f</span>71aa<span class="token operator">-</span><span class="token number">07</span>d5<span class="token operator">-</span><span class="token number">49</span>c4<span class="token operator">-</span>beb5<span class="token operator">-</span><span class="token number">81055</span>ac6f722 <span class="token function">at</span> <span class="token punctuation">(</span><span class="token operator">/</span>var<span class="token operator">/</span>lib<span class="token operator">/</span>nova<span class="token operator">/</span>instances<span class="token operator">/</span>_base<span class="token operator">/</span><span class="token number">7e2</span>bfe304c74a876f01642452d7930b251d7e3a8<span class="token punctuation">)</span><span class="token operator">:</span> checking
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">18</span> <span class="token number">11</span><span class="token operator">:</span><span class="token number">04</span><span class="token operator">:</span><span class="token number">22.914</span> <span class="token number">1556</span> INFO nova<span class="token punctuation">.</span>virt<span class="token punctuation">.</span>libvirt<span class="token punctuation">.</span>imagecache <span class="token punctuation">[</span>req<span class="token operator">-</span>caca30f2<span class="token operator">-</span>fddc<span class="token operator">-</span><span class="token number">48</span>ed<span class="token operator">-</span>a0f9<span class="token operator">-</span>d7250fb69311 <span class="token operator">-</span> <span class="token operator">-</span> <span class="token operator">-</span> <span class="token operator">-</span> <span class="token operator">-</span><span class="token punctuation">]</span> image f7cdcc6a<span class="token operator">-</span>dbec<span class="token operator">-</span><span class="token number">4</span>d4a<span class="token operator">-</span><span class="token number">82</span>c4<span class="token operator">-</span><span class="token number">4170</span>a9cc1a19 <span class="token function">at</span> <span class="token punctuation">(</span><span class="token operator">/</span>var<span class="token operator">/</span>lib<span class="token operator">/</span>nova<span class="token operator">/</span>instances<span class="token operator">/</span>_base<span class="token operator">/</span><span class="token number">23</span>a6b78eed18bc0b1ae4a43cde29aae49c9d666f<span class="token punctuation">)</span><span class="token operator">:</span> checking
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">18</span> <span class="token number">11</span><span class="token operator">:</span><span class="token number">04</span><span class="token operator">:</span><span class="token number">23.237</span> <span class="token number">1556</span> INFO nova<span class="token punctuation">.</span>virt<span class="token punctuation">.</span>libvirt<span class="token punctuation">.</span>imagecache <span class="token punctuation">[</span>req<span class="token operator">-</span>caca30f2<span class="token operator">-</span>fddc<span class="token operator">-</span><span class="token number">48</span>ed<span class="token operator">-</span>a0f9<span class="token operator">-</span>d7250fb69311 <span class="token operator">-</span> <span class="token operator">-</span> <span class="token operator">-</span> <span class="token operator">-</span> <span class="token operator">-</span><span class="token punctuation">]</span> Active base files<span class="token operator">:</span> <span class="token operator">/</span>var<span class="token operator">/</span>lib<span class="token operator">/</span>nova<span class="token operator">/</span>instances<span class="token operator">/</span>_base<span class="token operator">/</span><span class="token number">7e2</span>bfe304c74a876f01642452d7930b251d7e3a8 <span class="token operator">/</span>var<span class="token operator">/</span>lib<span class="token operator">/</span>nova<span class="token operator">/</span>instances<span class="token operator">/</span>_base<span class="token operator">/</span><span class="token number">23</span>a6b78eed18bc0b1ae4a43cde29aae49c9d666f
</code></pre>
</div>
</body>

</html>
