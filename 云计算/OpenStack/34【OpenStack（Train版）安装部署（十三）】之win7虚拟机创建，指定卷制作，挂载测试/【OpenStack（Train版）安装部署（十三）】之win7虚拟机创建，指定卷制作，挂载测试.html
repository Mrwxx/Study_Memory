<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>【OpenStack（Train版）安装部署（十三）】之win7虚拟机创建，指定卷制作，挂载测试</title>
  <link rel="stylesheet" href="https://stackedit.io/style.css" />
</head>

<body class="stackedit">
  <div class="stackedit__html"><p></p><div class="toc"><h3>文章目录</h3><ul><ul><li><a href="#_1">本文章由公号【开发小鸽】发布！欢迎关注！！！</a></li><li><a href="#1glancewin7_9">1.glance中win7虚拟机测试</a></li><ul><li><a href="#1win7qcow2glance_10">（1）-失败-win7的qcow2格式镜像上传glance</a></li><li><a href="#2win7dashboard_41">（2）-失败-win7虚拟机创建测试（dashboard图形化）</a></li><li><a href="#3win7dashboard_145">（3）win7虚拟机创建测试（dashboard图形化）</a></li><li><a href="#4win7xshell_201">（4）win7虚拟机创建测试（xshell命令）</a></li><li><a href="#5dashboard_214">（5）dashboard创建并挂载卷测试</a></li><li><a href="#6xshell_278">（6）xshell命令创建并挂载卷测试</a></li><li><a href="#7winvhd_458">（7）win机制作指定内容的vhd格式虚拟磁盘</a></li><li><a href="#8_489">（8）指定软件卷的制作</a></li><li><a href="#9_504">（9）控制节点程序嵌入虚拟机镜像测试</a></li></ul></ul></ul></div><p></p>
<h2><a id="_1"></a>本文章由公号【开发小鸽】发布！欢迎关注！！！</h2>
<br>
<p><strong>老规矩–妹妹镇楼：</strong></p>
<center>
<img src="https://img-blog.csdnimg.cn/20200721223424816.JPG" width="20%">
</center><h2><a id="1glancewin7_9"></a>1.glance中win7虚拟机测试</h2>
<h3><a id="1win7qcow2glance_10"></a>（1）-失败-win7的qcow2格式镜像上传glance</h3>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 将之前创建好的qcow2格式镜像上传到Controller节点中：<br>
<img src="https://img-blog.csdnimg.cn/bee21510584b49a2a39f318ad1c26e8f.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5byA5Y-R5bCP6bi9,size_19,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 将qcow2格式的镜像上传到glance中：</p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 上传qcow2格式镜像：</p>
<pre><code class="prism language-cpp">glance image<span class="token operator">-</span>create <span class="token operator">--</span>name <span class="token string">"win7_xshell_qcow2"</span> <span class="token operator">--</span>file <span class="token operator">/</span>vhost<span class="token operator">/</span>win7_xshell<span class="token punctuation">.</span>qcow2 <span class="token operator">--</span>disk<span class="token operator">-</span>format qcow2 <span class="token operator">--</span>container<span class="token operator">-</span>format bare <span class="token operator">--</span>visibility <span class="token keyword">public</span> <span class="token operator">--</span>progress
</code></pre>
<p><img src="https://img-blog.csdnimg.cn/65e9ba546dbe4d068c19da8764ce2401.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5byA5Y-R5bCP6bi9,size_19,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 查看当前的glance中的镜像情况：</p>
<p><img src="https://img-blog.csdnimg.cn/acb274d374be4e7ba1f7c041861f1caf.png" alt="在这里插入图片描述"></p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 在默认的glance的image目录下查看image情况：</p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; /var/lib/glance/images目录中的image镜像已经被上传了：</p>
<p><img src="https://img-blog.csdnimg.cn/006bdb4bc95648c5811175796624acb5.png" alt="在这里插入图片描述"><br>
<br></p>
<h3><a id="2win7dashboard_41"></a>（2）-失败-win7虚拟机创建测试（dashboard图形化）</h3>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; dashboard中创建虚拟机测试，出现了ERROR错误：</p>
<p><img src="https://img-blog.csdnimg.cn/e8e9b3b3062d4fe199320451b222f148.png" alt="在这里插入图片描述"></p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 在nova-scheduler.log中出现了如下的错误：</p>
<pre><code class="prism language-cpp"><span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">29</span> <span class="token number">15</span><span class="token operator">:</span><span class="token number">56</span><span class="token operator">:</span><span class="token number">26.588</span> <span class="token number">6701</span> ERROR nova NoMatches<span class="token operator">:</span> No <span class="token string">'nova.scheduler.driver'</span> driver found<span class="token punctuation">,</span> looking <span class="token keyword">for</span> <span class="token string">'nova.scheduler.filterscheduler.FilterScheduler'</span>
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">29</span> <span class="token number">15</span><span class="token operator">:</span><span class="token number">56</span><span class="token operator">:</span><span class="token number">26.588</span> <span class="token number">6701</span> ERROR nova 
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">29</span> <span class="token number">15</span><span class="token operator">:</span><span class="token number">56</span><span class="token operator">:</span><span class="token number">29.204</span> <span class="token number">6741</span> WARNING oslo_config<span class="token punctuation">.</span>cfg <span class="token punctuation">[</span><span class="token operator">-</span><span class="token punctuation">]</span> Deprecated<span class="token operator">:</span> Option <span class="token string">"scheduler_driver"</span> from group <span class="token string">"DEFAULT"</span> is deprecated<span class="token punctuation">.</span> Use option <span class="token string">"driver"</span> from group <span class="token string">"scheduler"</span><span class="token punctuation">.</span>
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">29</span> <span class="token number">15</span><span class="token operator">:</span><span class="token number">56</span><span class="token operator">:</span><span class="token number">29.204</span> <span class="token number">6741</span> WARNING stevedore<span class="token punctuation">.</span>named <span class="token punctuation">[</span><span class="token operator">-</span><span class="token punctuation">]</span> Could <span class="token operator">not</span> load nova<span class="token punctuation">.</span>scheduler<span class="token punctuation">.</span>filterscheduler<span class="token punctuation">.</span>FilterScheduler
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">29</span> <span class="token number">15</span><span class="token operator">:</span><span class="token number">56</span><span class="token operator">:</span><span class="token number">29.205</span> <span class="token number">6741</span> CRITICAL nova <span class="token punctuation">[</span><span class="token operator">-</span><span class="token punctuation">]</span> Unhandled error<span class="token operator">:</span> NoMatches<span class="token operator">:</span> No <span class="token string">'nova.scheduler.driver'</span> driver found<span class="token punctuation">,</span> looking <span class="token keyword">for</span> <span class="token string">'nova.scheduler.filterscheduler.FilterScheduler'</span>
</code></pre>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 在nova.conf配置文件中删除所有的filter配置：</p>
<pre><code class="prism language-cpp">scheduler_driver<span class="token operator">=</span>nova<span class="token punctuation">.</span>scheduler<span class="token punctuation">.</span>filterscheduler<span class="token punctuation">.</span>FilterScheduler
scheduler_available_filters <span class="token operator">=</span> nova<span class="token punctuation">.</span>scheduler<span class="token punctuation">.</span>filters<span class="token punctuation">.</span>all_filters
scheduler_default_filters <span class="token operator">=</span> AvailabilityZoneFilter<span class="token punctuation">,</span> RamFilter<span class="token punctuation">,</span> DiskFilter<span class="token punctuation">,</span> ComputeFilter
</code></pre>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 重新在dashboard中创建虚拟机测试，再一次创建失败，下面开始查看日志：</p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 查看nova-api.log中没有error错误；</p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 查看nova-compute.log日志：</p>
<pre><code class="prism language-cpp">#实例声明成功
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">29</span> <span class="token number">16</span><span class="token operator">:</span><span class="token number">34</span><span class="token operator">:</span><span class="token number">30.917</span> <span class="token number">2032</span> INFO nova<span class="token punctuation">.</span>compute<span class="token punctuation">.</span>claims <span class="token punctuation">[</span>req<span class="token operator">-</span>ce75f8ce<span class="token operator">-</span><span class="token number">65</span>b5<span class="token operator">-</span><span class="token number">4266</span><span class="token operator">-</span>acca<span class="token operator">-</span>e6cf8be864ab <span class="token number">9942</span>eb4321644336a0c7383d9f1c2bed a7d812868cb74f1a978035530f55f1d0 <span class="token operator">-</span> <span class="token keyword">default</span> <span class="token keyword">default</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>instance<span class="token operator">:</span> <span class="token number">6</span>ddd4885<span class="token operator">-</span><span class="token number">6134</span><span class="token operator">-</span><span class="token number">48</span>ef<span class="token operator">-</span>b5b4<span class="token operator">-</span><span class="token number">17804346</span>cb05<span class="token punctuation">]</span> Claim successful on node computer
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">29</span> <span class="token number">16</span><span class="token operator">:</span><span class="token number">34</span><span class="token operator">:</span><span class="token number">31.179</span> <span class="token number">2032</span> INFO nova<span class="token punctuation">.</span>virt<span class="token punctuation">.</span>libvirt<span class="token punctuation">.</span>driver <span class="token punctuation">[</span>req<span class="token operator">-</span>ce75f8ce<span class="token operator">-</span><span class="token number">65</span>b5<span class="token operator">-</span><span class="token number">4266</span><span class="token operator">-</span>acca<span class="token operator">-</span>e6cf8be864ab <span class="token number">9942</span>eb4321644336a0c7383d9f1c2bed a7d812868cb74f1a978035530f55f1d0 <span class="token operator">-</span> <span class="token keyword">default</span> <span class="token keyword">default</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>instance<span class="token operator">:</span> <span class="token number">6</span>ddd4885<span class="token operator">-</span><span class="token number">6134</span><span class="token operator">-</span><span class="token number">48</span>ef<span class="token operator">-</span>b5b4<span class="token operator">-</span><span class="token number">17804346</span>cb05<span class="token punctuation">]</span> Ignoring supplied device name<span class="token operator">:</span> <span class="token operator">/</span>dev<span class="token operator">/</span>vda<span class="token punctuation">.</span> Libvirt can<span class="token number">'</span>t honour user<span class="token operator">-</span>supplied dev names
#通过之前上传的win7的qcow2格式镜像启动
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">29</span> <span class="token number">16</span><span class="token operator">:</span><span class="token number">34</span><span class="token operator">:</span><span class="token number">31.309</span> <span class="token number">2032</span> INFO nova<span class="token punctuation">.</span>virt<span class="token punctuation">.</span>block_device <span class="token punctuation">[</span>req<span class="token operator">-</span>ce75f8ce<span class="token operator">-</span><span class="token number">65</span>b5<span class="token operator">-</span><span class="token number">4266</span><span class="token operator">-</span>acca<span class="token operator">-</span>e6cf8be864ab <span class="token number">9942</span>eb4321644336a0c7383d9f1c2bed a7d812868cb74f1a978035530f55f1d0 <span class="token operator">-</span> <span class="token keyword">default</span> <span class="token keyword">default</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>instance<span class="token operator">:</span> <span class="token number">6</span>ddd4885<span class="token operator">-</span><span class="token number">6134</span><span class="token operator">-</span><span class="token number">48</span>ef<span class="token operator">-</span>b5b4<span class="token operator">-</span><span class="token number">17804346</span>cb05<span class="token punctuation">]</span> Booting with volume<span class="token operator">-</span>backed<span class="token operator">-</span>image d5fde846<span class="token operator">-</span><span class="token number">32</span>c9<span class="token operator">-</span><span class="token number">46</span>d7<span class="token operator">-</span><span class="token number">9132</span><span class="token operator">-</span><span class="token number">20</span>a92e72fa90 at <span class="token operator">/</span>dev<span class="token operator">/</span>vda
#卷创建失败
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">29</span> <span class="token number">16</span><span class="token operator">:</span><span class="token number">34</span><span class="token operator">:</span><span class="token number">32.297</span> <span class="token number">2032</span> WARNING nova<span class="token punctuation">.</span>compute<span class="token punctuation">.</span>manager <span class="token punctuation">[</span>req<span class="token operator">-</span>ce75f8ce<span class="token operator">-</span><span class="token number">65</span>b5<span class="token operator">-</span><span class="token number">4266</span><span class="token operator">-</span>acca<span class="token operator">-</span>e6cf8be864ab <span class="token number">9942</span>eb4321644336a0c7383d9f1c2bed a7d812868cb74f1a978035530f55f1d0 <span class="token operator">-</span> <span class="token keyword">default</span> <span class="token keyword">default</span><span class="token punctuation">]</span> Volume id<span class="token operator">:</span> <span class="token number">034374e1</span><span class="token operator">-</span><span class="token number">542</span>b<span class="token operator">-</span><span class="token number">4847</span><span class="token operator">-</span>adad<span class="token operator">-</span><span class="token number">5985</span>b1644744 finished being created but its status is error<span class="token punctuation">.</span>
#实例没有挂载到卷
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">29</span> <span class="token number">16</span><span class="token operator">:</span><span class="token number">34</span><span class="token operator">:</span><span class="token number">32.472</span> <span class="token number">2032</span> ERROR nova<span class="token punctuation">.</span>compute<span class="token punctuation">.</span>manager <span class="token punctuation">[</span>req<span class="token operator">-</span>ce75f8ce<span class="token operator">-</span><span class="token number">65</span>b5<span class="token operator">-</span><span class="token number">4266</span><span class="token operator">-</span>acca<span class="token operator">-</span>e6cf8be864ab <span class="token number">9942</span>eb4321644336a0c7383d9f1c2bed a7d812868cb74f1a978035530f55f1d0 <span class="token operator">-</span> <span class="token keyword">default</span> <span class="token keyword">default</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>instance<span class="token operator">:</span> <span class="token number">6</span>ddd4885<span class="token operator">-</span><span class="token number">6134</span><span class="token operator">-</span><span class="token number">48</span>ef<span class="token operator">-</span>b5b4<span class="token operator">-</span><span class="token number">17804346</span>cb05<span class="token punctuation">]</span> Instance failed block device setup<span class="token operator">:</span> VolumeNotCreated<span class="token operator">:</span> \u5728\u7b49\u5f850 \u79d2\u62161\u5c1d\u8bd5\u540e\uff0c\u5377034374e1<span class="token operator">-</span><span class="token number">542</span>b<span class="token operator">-</span><span class="token number">4847</span><span class="token operator">-</span>adad<span class="token operator">-</span><span class="token number">5985</span>b1644744\u4ecd\u7136\u6ca1\u6709\u521b\u5efa\u6210\u529f\u3002\u5b83\u7684\u72b6\u6001\u662ferror\u3002
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">29</span> <span class="token number">16</span><span class="token operator">:</span><span class="token number">34</span><span class="token operator">:</span><span class="token number">32.472</span> <span class="token number">2032</span> ERROR nova<span class="token punctuation">.</span>compute<span class="token punctuation">.</span>manager <span class="token punctuation">[</span>instance<span class="token operator">:</span> <span class="token number">6</span>ddd4885<span class="token operator">-</span><span class="token number">6134</span><span class="token operator">-</span><span class="token number">48</span>ef<span class="token operator">-</span>b5b4<span class="token operator">-</span><span class="token number">17804346</span>cb05<span class="token punctuation">]</span> <span class="token function">Traceback</span> <span class="token punctuation">(</span>most recent call last<span class="token punctuation">)</span><span class="token operator">:</span>
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">29</span> <span class="token number">16</span><span class="token operator">:</span><span class="token number">34</span><span class="token operator">:</span><span class="token number">32.472</span> <span class="token number">2032</span> ERROR nova<span class="token punctuation">.</span>compute<span class="token punctuation">.</span>manager <span class="token punctuation">[</span>instance<span class="token operator">:</span> <span class="token number">6</span>ddd4885<span class="token operator">-</span><span class="token number">6134</span><span class="token operator">-</span><span class="token number">48</span>ef<span class="token operator">-</span>b5b4<span class="token operator">-</span><span class="token number">17804346</span>cb05<span class="token punctuation">]</span>   File <span class="token string">"/usr/lib/python2.7/site-packages/nova/compute/manager.py"</span><span class="token punctuation">,</span> line <span class="token number">1912</span><span class="token punctuation">,</span> in _prep_block_device
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">29</span> <span class="token number">16</span><span class="token operator">:</span><span class="token number">34</span><span class="token operator">:</span><span class="token number">32.472</span> <span class="token number">2032</span> ERROR nova<span class="token punctuation">.</span>compute<span class="token punctuation">.</span>manager <span class="token punctuation">[</span>instance<span class="token operator">:</span> <span class="token number">6</span>ddd4885<span class="token operator">-</span><span class="token number">6134</span><span class="token operator">-</span><span class="token number">48</span>ef<span class="token operator">-</span>b5b4<span class="token operator">-</span><span class="token number">17804346</span>cb05<span class="token punctuation">]</span>     wait_func<span class="token operator">=</span>self<span class="token punctuation">.</span>_await_block_device_map_created<span class="token punctuation">)</span>
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">29</span> <span class="token number">16</span><span class="token operator">:</span><span class="token number">34</span><span class="token operator">:</span><span class="token number">32.472</span> <span class="token number">2032</span> ERROR nova<span class="token punctuation">.</span>compute<span class="token punctuation">.</span>manager <span class="token punctuation">[</span>instance<span class="token operator">:</span> <span class="token number">6</span>ddd4885<span class="token operator">-</span><span class="token number">6134</span><span class="token operator">-</span><span class="token number">48</span>ef<span class="token operator">-</span>b5b4<span class="token operator">-</span><span class="token number">17804346</span>cb05<span class="token punctuation">]</span>   File <span class="token string">"/usr/lib/python2.7/site-packages/nova/virt/block_device.py"</span><span class="token punctuation">,</span> line <span class="token number">882</span><span class="token punctuation">,</span> in attach_block_devices
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">29</span> <span class="token number">16</span><span class="token operator">:</span><span class="token number">34</span><span class="token operator">:</span><span class="token number">32.472</span> <span class="token number">2032</span> ERROR nova<span class="token punctuation">.</span>compute<span class="token punctuation">.</span>manager <span class="token punctuation">[</span>instance<span class="token operator">:</span> <span class="token number">6</span>ddd4885<span class="token operator">-</span><span class="token number">6134</span><span class="token operator">-</span><span class="token number">48</span>ef<span class="token operator">-</span>b5b4<span class="token operator">-</span><span class="token number">17804346</span>cb05<span class="token punctuation">]</span>     <span class="token function">_log_and_attach</span><span class="token punctuation">(</span>device<span class="token punctuation">)</span>
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">29</span> <span class="token number">16</span><span class="token operator">:</span><span class="token number">34</span><span class="token operator">:</span><span class="token number">32.472</span> <span class="token number">2032</span> ERROR nova<span class="token punctuation">.</span>compute<span class="token punctuation">.</span>manager <span class="token punctuation">[</span>instance<span class="token operator">:</span> <span class="token number">6</span>ddd4885<span class="token operator">-</span><span class="token number">6134</span><span class="token operator">-</span><span class="token number">48</span>ef<span class="token operator">-</span>b5b4<span class="token operator">-</span><span class="token number">17804346</span>cb05<span class="token punctuation">]</span>   File <span class="token string">"/usr/lib/python2.7/site-packages/nova/virt/block_device.py"</span><span class="token punctuation">,</span> line <span class="token number">879</span><span class="token punctuation">,</span> in _log_and_attach
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">29</span> <span class="token number">16</span><span class="token operator">:</span><span class="token number">34</span><span class="token operator">:</span><span class="token number">32.472</span> <span class="token number">2032</span> ERROR nova<span class="token punctuation">.</span>compute<span class="token punctuation">.</span>manager <span class="token punctuation">[</span>instance<span class="token operator">:</span> <span class="token number">6</span>ddd4885<span class="token operator">-</span><span class="token number">6134</span><span class="token operator">-</span><span class="token number">48</span>ef<span class="token operator">-</span>b5b4<span class="token operator">-</span><span class="token number">17804346</span>cb05<span class="token punctuation">]</span>     bdm<span class="token punctuation">.</span><span class="token function">attach</span><span class="token punctuation">(</span><span class="token operator">*</span>attach_args<span class="token punctuation">,</span> <span class="token operator">*</span><span class="token operator">*</span>attach_kwargs<span class="token punctuation">)</span>
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">29</span> <span class="token number">16</span><span class="token operator">:</span><span class="token number">34</span><span class="token operator">:</span><span class="token number">32.472</span> <span class="token number">2032</span> ERROR nova<span class="token punctuation">.</span>compute<span class="token punctuation">.</span>manager <span class="token punctuation">[</span>instance<span class="token operator">:</span> <span class="token number">6</span>ddd4885<span class="token operator">-</span><span class="token number">6134</span><span class="token operator">-</span><span class="token number">48</span>ef<span class="token operator">-</span>b5b4<span class="token operator">-</span><span class="token number">17804346</span>cb05<span class="token punctuation">]</span>   File <span class="token string">"/usr/lib/python2.7/site-packages/nova/virt/block_device.py"</span><span class="token punctuation">,</span> line <span class="token number">769</span><span class="token punctuation">,</span> in attach
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">29</span> <span class="token number">16</span><span class="token operator">:</span><span class="token number">34</span><span class="token operator">:</span><span class="token number">32.472</span> <span class="token number">2032</span> ERROR nova<span class="token punctuation">.</span>compute<span class="token punctuation">.</span>manager <span class="token punctuation">[</span>instance<span class="token operator">:</span> <span class="token number">6</span>ddd4885<span class="token operator">-</span><span class="token number">6134</span><span class="token operator">-</span><span class="token number">48</span>ef<span class="token operator">-</span>b5b4<span class="token operator">-</span><span class="token number">17804346</span>cb05<span class="token punctuation">]</span>     wait_func<span class="token operator">=</span>wait_func<span class="token punctuation">,</span> image_id<span class="token operator">=</span>self<span class="token punctuation">.</span>image_id<span class="token punctuation">)</span>
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">29</span> <span class="token number">16</span><span class="token operator">:</span><span class="token number">34</span><span class="token operator">:</span><span class="token number">32.472</span> <span class="token number">2032</span> ERROR nova<span class="token punctuation">.</span>compute<span class="token punctuation">.</span>manager <span class="token punctuation">[</span>instance<span class="token operator">:</span> <span class="token number">6</span>ddd4885<span class="token operator">-</span><span class="token number">6134</span><span class="token operator">-</span><span class="token number">48</span>ef<span class="token operator">-</span>b5b4<span class="token operator">-</span><span class="token number">17804346</span>cb05<span class="token punctuation">]</span>   File <span class="token string">"/usr/lib/python2.7/site-packages/nova/virt/block_device.py"</span><span class="token punctuation">,</span> line <span class="token number">367</span><span class="token punctuation">,</span> in _create_volume
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">29</span> <span class="token number">16</span><span class="token operator">:</span><span class="token number">34</span><span class="token operator">:</span><span class="token number">32.472</span> <span class="token number">2032</span> ERROR nova<span class="token punctuation">.</span>compute<span class="token punctuation">.</span>manager <span class="token punctuation">[</span>instance<span class="token operator">:</span> <span class="token number">6</span>ddd4885<span class="token operator">-</span><span class="token number">6134</span><span class="token operator">-</span><span class="token number">48</span>ef<span class="token operator">-</span>b5b4<span class="token operator">-</span><span class="token number">17804346</span>cb05<span class="token punctuation">]</span>     self<span class="token punctuation">.</span><span class="token function">_call_wait_func</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> wait_func<span class="token punctuation">,</span> volume_api<span class="token punctuation">,</span> vol<span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">29</span> <span class="token number">16</span><span class="token operator">:</span><span class="token number">34</span><span class="token operator">:</span><span class="token number">32.472</span> <span class="token number">2032</span> ERROR nova<span class="token punctuation">.</span>compute<span class="token punctuation">.</span>manager <span class="token punctuation">[</span>instance<span class="token operator">:</span> <span class="token number">6</span>ddd4885<span class="token operator">-</span><span class="token number">6134</span><span class="token operator">-</span><span class="token number">48</span>ef<span class="token operator">-</span>b5b4<span class="token operator">-</span><span class="token number">17804346</span>cb05<span class="token punctuation">]</span>   File <span class="token string">"/usr/lib/python2.7/site-packages/nova/virt/block_device.py"</span><span class="token punctuation">,</span> line <span class="token number">724</span><span class="token punctuation">,</span> in _call_wait_func
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">29</span> <span class="token number">16</span><span class="token operator">:</span><span class="token number">34</span><span class="token operator">:</span><span class="token number">32.472</span> <span class="token number">2032</span> ERROR nova<span class="token punctuation">.</span>compute<span class="token punctuation">.</span>manager <span class="token punctuation">[</span>instance<span class="token operator">:</span> <span class="token number">6</span>ddd4885<span class="token operator">-</span><span class="token number">6134</span><span class="token operator">-</span><span class="token number">48</span>ef<span class="token operator">-</span>b5b4<span class="token operator">-</span><span class="token number">17804346</span>cb05<span class="token punctuation">]</span>     <span class="token punctuation">{</span><span class="token string">'volume_id'</span><span class="token operator">:</span> volume_id<span class="token punctuation">,</span> <span class="token string">'exc'</span><span class="token operator">:</span> exc<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">29</span> <span class="token number">16</span><span class="token operator">:</span><span class="token number">34</span><span class="token operator">:</span><span class="token number">32.472</span> <span class="token number">2032</span> ERROR nova<span class="token punctuation">.</span>compute<span class="token punctuation">.</span>manager <span class="token punctuation">[</span>instance<span class="token operator">:</span> <span class="token number">6</span>ddd4885<span class="token operator">-</span><span class="token number">6134</span><span class="token operator">-</span><span class="token number">48</span>ef<span class="token operator">-</span>b5b4<span class="token operator">-</span><span class="token number">17804346</span>cb05<span class="token punctuation">]</span>   File <span class="token string">"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py"</span><span class="token punctuation">,</span> line <span class="token number">220</span><span class="token punctuation">,</span> in __exit__
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">29</span> <span class="token number">16</span><span class="token operator">:</span><span class="token number">34</span><span class="token operator">:</span><span class="token number">32.472</span> <span class="token number">2032</span> ERROR nova<span class="token punctuation">.</span>compute<span class="token punctuation">.</span>manager <span class="token punctuation">[</span>instance<span class="token operator">:</span> <span class="token number">6</span>ddd4885<span class="token operator">-</span><span class="token number">6134</span><span class="token operator">-</span><span class="token number">48</span>ef<span class="token operator">-</span>b5b4<span class="token operator">-</span><span class="token number">17804346</span>cb05<span class="token punctuation">]</span>     self<span class="token punctuation">.</span><span class="token function">force_reraise</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">29</span> <span class="token number">16</span><span class="token operator">:</span><span class="token number">34</span><span class="token operator">:</span><span class="token number">32.472</span> <span class="token number">2032</span> ERROR nova<span class="token punctuation">.</span>compute<span class="token punctuation">.</span>manager <span class="token punctuation">[</span>instance<span class="token operator">:</span> <span class="token number">6</span>ddd4885<span class="token operator">-</span><span class="token number">6134</span><span class="token operator">-</span><span class="token number">48</span>ef<span class="token operator">-</span>b5b4<span class="token operator">-</span><span class="token number">17804346</span>cb05<span class="token punctuation">]</span>   File <span class="token string">"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py"</span><span class="token punctuation">,</span> line <span class="token number">196</span><span class="token punctuation">,</span> in force_reraise
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">29</span> <span class="token number">16</span><span class="token operator">:</span><span class="token number">34</span><span class="token operator">:</span><span class="token number">32.472</span> <span class="token number">2032</span> ERROR nova<span class="token punctuation">.</span>compute<span class="token punctuation">.</span>manager <span class="token punctuation">[</span>instance<span class="token operator">:</span> <span class="token number">6</span>ddd4885<span class="token operator">-</span><span class="token number">6134</span><span class="token operator">-</span><span class="token number">48</span>ef<span class="token operator">-</span>b5b4<span class="token operator">-</span><span class="token number">17804346</span>cb05<span class="token punctuation">]</span>     six<span class="token punctuation">.</span><span class="token function">reraise</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>type_<span class="token punctuation">,</span> self<span class="token punctuation">.</span>value<span class="token punctuation">,</span> self<span class="token punctuation">.</span>tb<span class="token punctuation">)</span>
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">29</span> <span class="token number">16</span><span class="token operator">:</span><span class="token number">34</span><span class="token operator">:</span><span class="token number">32.472</span> <span class="token number">2032</span> ERROR nova<span class="token punctuation">.</span>compute<span class="token punctuation">.</span>manager <span class="token punctuation">[</span>instance<span class="token operator">:</span> <span class="token number">6</span>ddd4885<span class="token operator">-</span><span class="token number">6134</span><span class="token operator">-</span><span class="token number">48</span>ef<span class="token operator">-</span>b5b4<span class="token operator">-</span><span class="token number">17804346</span>cb05<span class="token punctuation">]</span>   File <span class="token string">"/usr/lib/python2.7/site-packages/nova/virt/block_device.py"</span><span class="token punctuation">,</span> line <span class="token number">714</span><span class="token punctuation">,</span> in _call_wait_func
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">29</span> <span class="token number">16</span><span class="token operator">:</span><span class="token number">34</span><span class="token operator">:</span><span class="token number">32.472</span> <span class="token number">2032</span> ERROR nova<span class="token punctuation">.</span>compute<span class="token punctuation">.</span>manager <span class="token punctuation">[</span>instance<span class="token operator">:</span> <span class="token number">6</span>ddd4885<span class="token operator">-</span><span class="token number">6134</span><span class="token operator">-</span><span class="token number">48</span>ef<span class="token operator">-</span>b5b4<span class="token operator">-</span><span class="token number">17804346</span>cb05<span class="token punctuation">]</span>     <span class="token function">wait_func</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> volume_id<span class="token punctuation">)</span>
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">29</span> <span class="token number">16</span><span class="token operator">:</span><span class="token number">34</span><span class="token operator">:</span><span class="token number">32.472</span> <span class="token number">2032</span> ERROR nova<span class="token punctuation">.</span>compute<span class="token punctuation">.</span>manager <span class="token punctuation">[</span>instance<span class="token operator">:</span> <span class="token number">6</span>ddd4885<span class="token operator">-</span><span class="token number">6134</span><span class="token operator">-</span><span class="token number">48</span>ef<span class="token operator">-</span>b5b4<span class="token operator">-</span><span class="token number">17804346</span>cb05<span class="token punctuation">]</span>   File <span class="token string">"/usr/lib/python2.7/site-packages/nova/compute/manager.py"</span><span class="token punctuation">,</span> line <span class="token number">1571</span><span class="token punctuation">,</span> in _await_block_device_map_created
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">29</span> <span class="token number">16</span><span class="token operator">:</span><span class="token number">34</span><span class="token operator">:</span><span class="token number">32.472</span> <span class="token number">2032</span> ERROR nova<span class="token punctuation">.</span>compute<span class="token punctuation">.</span>manager <span class="token punctuation">[</span>instance<span class="token operator">:</span> <span class="token number">6</span>ddd4885<span class="token operator">-</span><span class="token number">6134</span><span class="token operator">-</span><span class="token number">48</span>ef<span class="token operator">-</span>b5b4<span class="token operator">-</span><span class="token number">17804346</span>cb05<span class="token punctuation">]</span>     volume_status<span class="token operator">=</span>volume_status<span class="token punctuation">)</span>
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">29</span> <span class="token number">16</span><span class="token operator">:</span><span class="token number">34</span><span class="token operator">:</span><span class="token number">32.472</span> <span class="token number">2032</span> ERROR nova<span class="token punctuation">.</span>compute<span class="token punctuation">.</span>manager <span class="token punctuation">[</span>instance<span class="token operator">:</span> <span class="token number">6</span>ddd4885<span class="token operator">-</span><span class="token number">6134</span><span class="token operator">-</span><span class="token number">48</span>ef<span class="token operator">-</span>b5b4<span class="token operator">-</span><span class="token number">17804346</span>cb05<span class="token punctuation">]</span> VolumeNotCreated<span class="token operator">:</span> \u5728\u7b49\u5f850 \u79d2\u62161\u5c1d\u8bd5\u540e\uff0c\u5377034374e1<span class="token operator">-</span><span class="token number">542</span>b<span class="token operator">-</span><span class="token number">4847</span><span class="token operator">-</span>adad<span class="token operator">-</span><span class="token number">5985</span>b1644744\u4ecd\u7136\u6ca1\u6709\u521b\u5efa\u6210\u529f\u3002\u5b83\u7684\u72b6\u6001\u662ferror\u3002
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">29</span> <span class="token number">16</span><span class="token operator">:</span><span class="token number">34</span><span class="token operator">:</span><span class="token number">32.472</span> <span class="token number">2032</span> ERROR nova<span class="token punctuation">.</span>compute<span class="token punctuation">.</span>manager <span class="token punctuation">[</span>instance<span class="token operator">:</span> <span class="token number">6</span>ddd4885<span class="token operator">-</span><span class="token number">6134</span><span class="token operator">-</span><span class="token number">48</span>ef<span class="token operator">-</span>b5b4<span class="token operator">-</span><span class="token number">17804346</span>cb05<span class="token punctuation">]</span> 
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">29</span> <span class="token number">16</span><span class="token operator">:</span><span class="token number">34</span><span class="token operator">:</span><span class="token number">34.396</span> <span class="token number">2032</span> ERROR nova<span class="token punctuation">.</span>compute<span class="token punctuation">.</span>manager <span class="token punctuation">[</span>req<span class="token operator">-</span>ce75f8ce<span class="token operator">-</span><span class="token number">65</span>b5<span class="token operator">-</span><span class="token number">4266</span><span class="token operator">-</span>acca<span class="token operator">-</span>e6cf8be864ab <span class="token number">9942</span>eb4321644336a0c7383d9f1c2bed a7d812868cb74f1a978035530f55f1d0 <span class="token operator">-</span> <span class="token keyword">default</span> <span class="token keyword">default</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>instance<span class="token operator">:</span> <span class="token number">6</span>ddd4885<span class="token operator">-</span><span class="token number">6134</span><span class="token operator">-</span><span class="token number">48</span>ef<span class="token operator">-</span>b5b4<span class="token operator">-</span><span class="token number">17804346</span>cb05<span class="token punctuation">]</span> 实例<span class="token number">6</span>ddd4885<span class="token operator">-</span><span class="token number">6134</span><span class="token operator">-</span><span class="token number">48</span>ef<span class="token operator">-</span>b5b4<span class="token operator">-</span><span class="token number">17804346</span>cb05的构建已中止：在等待<span class="token number">0</span> 秒或<span class="token number">1</span>尝试后，卷<span class="token number">034374e1</span><span class="token operator">-</span><span class="token number">542</span>b<span class="token operator">-</span><span class="token number">4847</span><span class="token operator">-</span>adad<span class="token operator">-</span><span class="token number">5985</span>b1644744仍然没有创建成功。它的状态是error。<span class="token operator">:</span> BuildAbortException<span class="token operator">:</span> \u5b9e\u4f8b6ddd4885<span class="token operator">-</span><span class="token number">6134</span><span class="token operator">-</span><span class="token number">48</span>ef<span class="token operator">-</span>b5b4<span class="token operator">-</span><span class="token number">17804346</span>cb05\u7684\u6784\u5efa\u5df2\u4e2d\u6b62\uff1a\u5728\u7b49\u5f850 \u79d2\u62161\u5c1d\u8bd5\u540e\uff0c\u5377034374e1<span class="token operator">-</span><span class="token number">542</span>b<span class="token operator">-</span><span class="token number">4847</span><span class="token operator">-</span>adad<span class="token operator">-</span><span class="token number">5985</span>b1644744\u4ecd\u7136\u6ca1\u6709\u521b\u5efa\u6210\u529f\u3002\u5b83\u7684\u72b6\u6001\u662ferror\u3002
#去除该实例的<span class="token keyword">virtual</span> IP
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">29</span> <span class="token number">16</span><span class="token operator">:</span><span class="token number">34</span><span class="token operator">:</span><span class="token number">34.399</span> <span class="token number">2032</span> INFO os_vif <span class="token punctuation">[</span>req<span class="token operator">-</span>ce75f8ce<span class="token operator">-</span><span class="token number">65</span>b5<span class="token operator">-</span><span class="token number">4266</span><span class="token operator">-</span>acca<span class="token operator">-</span>e6cf8be864ab <span class="token number">9942</span>eb4321644336a0c7383d9f1c2bed a7d812868cb74f1a978035530f55f1d0 <span class="token operator">-</span> <span class="token keyword">default</span> <span class="token keyword">default</span><span class="token punctuation">]</span> Successfully unplugged vif <span class="token function">VIFBridge</span><span class="token punctuation">(</span>active<span class="token operator">=</span>False<span class="token punctuation">,</span>address<span class="token operator">=</span>fa<span class="token operator">:</span><span class="token number">16</span><span class="token operator">:</span><span class="token number">3</span>e<span class="token operator">:</span>d0<span class="token operator">:</span><span class="token number">9</span>b<span class="token operator">:</span><span class="token number">25</span><span class="token punctuation">,</span>bridge_name<span class="token operator">=</span><span class="token string">'brq9d470a6f-3b'</span><span class="token punctuation">,</span>has_traffic_filtering<span class="token operator">=</span>True<span class="token punctuation">,</span>id<span class="token operator">=</span><span class="token number">1</span>c293d4e<span class="token operator">-</span><span class="token number">9e15</span><span class="token operator">-</span><span class="token number">4</span>cce<span class="token operator">-</span><span class="token number">887</span>d<span class="token operator">-</span><span class="token number">0</span>d12d94580b2<span class="token punctuation">,</span>network<span class="token operator">=</span><span class="token function">Network</span><span class="token punctuation">(</span><span class="token number">9</span>d470a6f<span class="token operator">-</span><span class="token number">3</span>b69<span class="token operator">-</span><span class="token number">4105</span><span class="token operator">-</span>b0eb<span class="token operator">-</span>f6ef70a9dec3<span class="token punctuation">)</span><span class="token punctuation">,</span>plugin<span class="token operator">=</span><span class="token string">'linux_bridge'</span><span class="token punctuation">,</span>port_profile<span class="token operator">=</span><span class="token operator">&lt;</span><span class="token operator">?</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>preserve_on_delete<span class="token operator">=</span>False<span class="token punctuation">,</span>vif_name<span class="token operator">=</span><span class="token string">'tap1c293d4e-9e'</span><span class="token punctuation">)</span>
#将该实例分配的网络撤销
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">29</span> <span class="token number">16</span><span class="token operator">:</span><span class="token number">34</span><span class="token operator">:</span><span class="token number">36.226</span> <span class="token number">2032</span> INFO nova<span class="token punctuation">.</span>compute<span class="token punctuation">.</span>manager <span class="token punctuation">[</span>req<span class="token operator">-</span>ce75f8ce<span class="token operator">-</span><span class="token number">65</span>b5<span class="token operator">-</span><span class="token number">4266</span><span class="token operator">-</span>acca<span class="token operator">-</span>e6cf8be864ab <span class="token number">9942</span>eb4321644336a0c7383d9f1c2bed a7d812868cb74f1a978035530f55f1d0 <span class="token operator">-</span> <span class="token keyword">default</span> <span class="token keyword">default</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>instance<span class="token operator">:</span> <span class="token number">6</span>ddd4885<span class="token operator">-</span><span class="token number">6134</span><span class="token operator">-</span><span class="token number">48</span>ef<span class="token operator">-</span>b5b4<span class="token operator">-</span><span class="token number">17804346</span>cb05<span class="token punctuation">]</span> Took <span class="token number">1.83</span> seconds to deallocate network <span class="token keyword">for</span> instance<span class="token punctuation">.</span>
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">29</span> <span class="token number">16</span><span class="token operator">:</span><span class="token number">34</span><span class="token operator">:</span><span class="token number">36.538</span> <span class="token number">2032</span> INFO nova<span class="token punctuation">.</span>scheduler<span class="token punctuation">.</span>client<span class="token punctuation">.</span>report <span class="token punctuation">[</span>req<span class="token operator">-</span>ce75f8ce<span class="token operator">-</span><span class="token number">65</span>b5<span class="token operator">-</span><span class="token number">4266</span><span class="token operator">-</span>acca<span class="token operator">-</span>e6cf8be864ab <span class="token number">9942</span>eb4321644336a0c7383d9f1c2bed a7d812868cb74f1a978035530f55f1d0 <span class="token operator">-</span> <span class="token keyword">default</span> <span class="token keyword">default</span><span class="token punctuation">]</span> Deleted allocation <span class="token keyword">for</span> instance <span class="token number">6</span>ddd4885<span class="token operator">-</span><span class="token number">6134</span><span class="token operator">-</span><span class="token number">48</span>ef<span class="token operator">-</span>b5b4<span class="token operator">-</span><span class="token number">17804346</span>cb05
</code></pre>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 可以从日志中看到，卷创建失败，推测是compute节点的存储空间不够了，因此删除一个大的centos实例后，查看compute节点的资源情况：</p>
<p><img src="https://img-blog.csdnimg.cn/3135053133d24d188f6a90f3d2c400b4.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5byA5Y-R5bCP6bi9,size_19,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 可以看到，compute节点原本设置的存储空间就很少（40G），可用的只有35G，设置了两个cirros实例，存储空间使用了2G，内存之前设置了8G，可用的只有7.6G，使用了640MB；</p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; controller节点设置了40G的存储空间，可用的只有35G，内存设置了4G，可用的内存空间为3.7G，使用了512MB内存。</p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 再次在dashboard中创建虚拟机，依然是ERROR状态，艹了，继续查看日志：</p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 主要是compute节点中的nova-compute.log日志的错误：</p>
<pre><code class="prism language-cpp">#卷创建失败
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">29</span> <span class="token number">22</span><span class="token operator">:</span><span class="token number">07</span><span class="token operator">:</span><span class="token number">28.028</span> <span class="token number">1843</span> ERROR nova<span class="token punctuation">.</span>compute<span class="token punctuation">.</span>manager <span class="token punctuation">[</span>instance<span class="token operator">:</span> dc030e38<span class="token operator">-</span><span class="token number">1</span>ad1<span class="token operator">-</span><span class="token number">4318</span><span class="token operator">-</span>b0df<span class="token operator">-</span>a3df40daa4ef<span class="token punctuation">]</span> VolumeNotCreated<span class="token operator">:</span> \u5728\u7b49\u5f85132 \u79d2\u621643\u5c1d\u8bd5\u540e\uff0c\u53778e64cc5d<span class="token operator">-</span>b20c<span class="token operator">-</span><span class="token number">453e-8886</span><span class="token operator">-</span>f57502ff2924\u4ecd\u7136\u6ca1\u6709\u521b\u5efa\u6210\u529f\u3002\u5b83\u7684\u72b6\u6001\u662ferror\u3002
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">29</span> <span class="token number">22</span><span class="token operator">:</span><span class="token number">07</span><span class="token operator">:</span><span class="token number">28.028</span> <span class="token number">1843</span> ERROR nova<span class="token punctuation">.</span>compute<span class="token punctuation">.</span>manager <span class="token punctuation">[</span>instance<span class="token operator">:</span> dc030e38<span class="token operator">-</span><span class="token number">1</span>ad1<span class="token operator">-</span><span class="token number">4318</span><span class="token operator">-</span>b0df<span class="token operator">-</span>a3df40daa4ef<span class="token punctuation">]</span> 
#由于卷创建失败，实例的创建也失败了
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">29</span> <span class="token number">22</span><span class="token operator">:</span><span class="token number">07</span><span class="token operator">:</span><span class="token number">28.143</span> <span class="token number">1843</span> ERROR nova<span class="token punctuation">.</span>compute<span class="token punctuation">.</span>manager <span class="token punctuation">[</span>req<span class="token operator">-</span><span class="token number">032</span>b8463<span class="token operator">-</span><span class="token number">1</span>cc1<span class="token operator">-</span><span class="token number">43</span>d2<span class="token operator">-</span><span class="token number">83</span>c1<span class="token operator">-</span><span class="token number">047</span>b8d50db6e <span class="token number">9942</span>eb4321644336a0c7383d9f1c2bed a7d812868cb74f1a978035530f55f1d0 <span class="token operator">-</span> <span class="token keyword">default</span> <span class="token keyword">default</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>instance<span class="token operator">:</span> dc030e38<span class="token operator">-</span><span class="token number">1</span>ad1<span class="token operator">-</span><span class="token number">4318</span><span class="token operator">-</span>b0df<span class="token operator">-</span>a3df40daa4ef<span class="token punctuation">]</span> 实例dc030e38<span class="token operator">-</span><span class="token number">1</span>ad1<span class="token operator">-</span><span class="token number">4318</span><span class="token operator">-</span>b0df<span class="token operator">-</span>a3df40daa4ef的构建已中止：在等待<span class="token number">132</span> 秒或<span class="token number">43</span>尝试后，卷<span class="token number">8e64</span>cc5d<span class="token operator">-</span>b20c<span class="token operator">-</span><span class="token number">453e-8886</span><span class="token operator">-</span>f57502ff2924仍然没有创建成功。它的状态是error。<span class="token operator">:</span> BuildAbortException<span class="token operator">:</span> \u5b9e\u4f8bdc030e38<span class="token operator">-</span><span class="token number">1</span>ad1<span class="token operator">-</span><span class="token number">4318</span><span class="token operator">-</span>b0df<span class="token operator">-</span>a3df40daa4ef\u7684\u6784\u5efa\u5df2\u4e2d\u6b62\uff1a\u5728\u7b49\u5f85132 \u79d2\u621643\u5c1d\u8bd5\u540e\uff0c\u53778e64cc5d<span class="token operator">-</span>b20c<span class="token operator">-</span><span class="token number">453e-8886</span><span class="token operator">-</span>f57502ff2924\u4ecd\u7136\u6ca1\u6709\u521b\u5efa\u6210\u529f\u3002\u5b83\u7684\u72b6\u6001\u662ferror\u3002
</code></pre>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 再次在compute节点的cinder服务的volume.log中查看日志：</p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 有个关键信息如下所示，我们之前创建的win7的qcow2格式镜像设置的虚拟大小为100G，而这里为该进镜像设置的卷大小只有20G，可能是这里出现了问题。</p>
<pre><code class="prism language-cpp"><span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">29</span> <span class="token number">22</span><span class="token operator">:</span><span class="token number">07</span><span class="token operator">:</span><span class="token number">26.738</span> <span class="token number">1802</span> ERROR cinder<span class="token punctuation">.</span>volume<span class="token punctuation">.</span>manager ImageUnacceptable<span class="token operator">:</span> \u6620\u50cf d5fde846<span class="token operator">-</span><span class="token number">32</span>c9<span class="token operator">-</span><span class="token number">46</span>d7<span class="token operator">-</span><span class="token number">9132</span><span class="token operator">-</span><span class="token number">20</span>a92e72fa90 \u65e0\u6cd5\u69f\u56e0\u662f\uff1a \u6620\u50cf\u865a\u62df\u5927\u5c0f\u4e3a <span class="token number">100</span>GB\uff0c\u5728\u5927\u5c0f\u4e3a <span class="token number">20</span>GB \u7684\u5377\u4e2d\u5c06\u65e0\u6cd5
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">29</span> <span class="token number">22</span><span class="token operator">:</span><span class="token number">07</span><span class="token operator">:</span><span class="token number">26.738</span> <span class="token number">1802</span> ERROR cinder<span class="token punctuation">.</span>volume<span class="token punctuation">.</span>manager
</code></pre>
<br>
<h3><a id="3win7dashboard_145"></a>（3）win7虚拟机创建测试（dashboard图形化）</h3>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 因此，我们将qcow2格式的win7磁盘修改为20G：</p>
<pre><code class="prism language-cpp">qemu<span class="token operator">-</span>img resize <span class="token operator">--</span>shrink win7_xshell<span class="token punctuation">.</span>qcow2 <span class="token number">20</span>G
</code></pre>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 将qcow2格式的镜像上传到glance中：</p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 上传qcow2格式镜像：</p>
<pre><code class="prism language-cpp">glance image<span class="token operator">-</span>create <span class="token operator">--</span>name <span class="token string">"win7_xshell_qcow2"</span> <span class="token operator">--</span>file <span class="token operator">/</span>vhost<span class="token operator">/</span>win7_xshell<span class="token punctuation">.</span>qcow2 <span class="token operator">--</span>disk<span class="token operator">-</span>format qcow2 <span class="token operator">--</span>container<span class="token operator">-</span>format bare <span class="token operator">--</span>visibility <span class="token keyword">public</span> <span class="token operator">--</span>progress
</code></pre>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 在nova.conf配置文件中删除所有的filter配置：</p>
<pre><code class="prism language-cpp">scheduler_driver<span class="token operator">=</span>nova<span class="token punctuation">.</span>scheduler<span class="token punctuation">.</span>filterscheduler<span class="token punctuation">.</span>FilterScheduler
scheduler_available_filters <span class="token operator">=</span> nova<span class="token punctuation">.</span>scheduler<span class="token punctuation">.</span>filters<span class="token punctuation">.</span>all_filters
scheduler_default_filters <span class="token operator">=</span> AvailabilityZoneFilter<span class="token punctuation">,</span> RamFilter<span class="token punctuation">,</span> DiskFilter<span class="token punctuation">,</span> ComputeFilter
</code></pre>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 重新尝试通过dashboard创建虚拟机：</p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 设置flavor为2核，2G内存，20G磁盘；</p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 可惜又出现了volume创建错误：</p>
<pre><code class="prism language-cpp">Exception during message handling<span class="token operator">:</span> ImageCopyFailure<span class="token operator">:</span> \u672a\u80fd\u5c06\u6620\u50cf\u590d\u5236\u5230\u5377\uff1aqemu<span class="token operator">-</span>img<span class="token operator">:</span> error <span class="token keyword">while</span> writing sector <span class="token number">38797312</span><span class="token operator">:</span> Input<span class="token operator">/</span>output error
</code></pre>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 看起来又是volume的创建问题，镜像复制失败，回想起创建实例时是通过qcow2格式的镜像创建的，但是也选择了创建一个新的卷做持久化存储。这个选项可能就是将镜像复制到volume卷中做持久化的，这样就导致了镜像复制错误的问题。</p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 因此，这一次我们选择直接通过image镜像创建实例，而不创建新的卷，果然创建成功了，草草草！！！<br>
<img src="https://img-blog.csdnimg.cn/2cc403f29c3a4c4baeab038a3d071d17.png" alt="在这里插入图片描述"></p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 通过控制台连接刚刚创建的虚拟机，如下所示出现了创建该win7虚拟机镜像时的文档，因此可以得出该虚拟机就是通过之前的qcow2格式镜像创建的，完全一致：<br>
<img src="https://img-blog.csdnimg.cn/799966efbea3427197dd7f8c2a1ec06b.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5byA5Y-R5bCP6bi9,size_12,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 查看该虚拟机的IP地址：</p>
<p><img src="https://img-blog.csdnimg.cn/a8a7b27f198e45e393b6dbf884c9a5dc.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5byA5Y-R5bCP6bi9,size_19,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 查看当前的虚拟资源使用情况：</p>
<p><img src="https://img-blog.csdnimg.cn/1af389b5595448b58facef22d5cc0bfa.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5byA5Y-R5bCP6bi9,size_19,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p>
<br>
<h3><a id="4win7xshell_201"></a>（4）win7虚拟机创建测试（xshell命令）</h3>
<pre><code class="prism language-cpp">openstack server create <span class="token operator">--</span>image win7_xshell_qcow2 <span class="token operator">--</span>flavor win7_xshell win7_xshell
</code></pre>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 如下所示，虚拟机创建完毕：</p>
<p><img src="https://img-blog.csdnimg.cn/b9bc5f58efaf4321befc12f8f113f603.png" alt="在这里插入图片描述"><br>
<br></p>
<h3><a id="5dashboard_214"></a>（5）dashboard创建并挂载卷测试</h3>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 直接在dashboard中创建卷，给win7_dash虚拟机创建了一个2G的空白卷并挂载到该虚拟机上。通过控制台连接到该虚拟机，却没有发现该2G的磁盘，只有一个10G的根磁盘。<br>
<img src="https://img-blog.csdnimg.cn/ab659ace15514db68c1877fb640ec39d.png" alt="在这里插入图片描述"></p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 通过cmd命令查看虚拟机中的磁盘情况：</p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 先调用命令diskpart；</p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 再执行命令list disk；</p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 可以看到磁盘数量如下所示：</p>
<p><img src="https://img-blog.csdnimg.cn/9071ed276c3b452286e5b5390ccebbd2.png" alt="在这里插入图片描述"></p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 通过磁盘管理查看磁盘情况：</p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 控制管理器-》管理工具-》磁盘管理<br>
<img src="https://img-blog.csdnimg.cn/23fb06fb558c41779f675c70b77d6170.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5byA5Y-R5bCP6bi9,size_19,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 可以手动在磁盘管理中进行磁盘的分区，选择设置为D盘，继而在计算机中显示了该D盘：<br>
<img src="https://img-blog.csdnimg.cn/9d8330c988cf4563af4564003daa307b.png" alt="在这里插入图片描述"></p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 在D盘中创建一个文档作为标志；</p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 对该卷进行备份测试，dashboard中直接对该卷进行分离实例，使得卷的状态为可用，尝试为该卷创建备份，将该卷上传到glance中：<br>
<img src="https://img-blog.csdnimg.cn/3f6f0a075c054b1188184ffeebd4f49b.png" alt="在这里插入图片描述"></p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 再次通过该image镜像创建一个卷chrome_img，然后将该卷挂载到另一个实例win7_xshell中：<br>
<img src="https://img-blog.csdnimg.cn/1eb158b112cd4d518cde2762e0bec857.png" alt="在这里插入图片描述"></p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 通过控制台连接该实例，竟然查看到该虚拟机的磁盘管理中除了有一个10G的根磁盘，那个2G的磁盘竟然直接显示出来作为了D盘，这难道是因为我们在win7_dash虚拟机中直接挂载了2G的磁盘后进行了备份，并且作为镜像上传到了glance中，接着通过该镜像创建新的卷chrome_img直接挂载到另一个实例win7_xshell中。新的卷不需要进行卷的分区，可以直接使用。<br>
<img src="https://img-blog.csdnimg.cn/793a4089315b44c0b6ef42a569412f89.png" alt="在这里插入图片描述"></p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 可以看到，该磁盘中有我们之前创建好的标志文档，标志着这就是我们之前创建的磁盘。</p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 在dashboard中扩展原始的chrome卷为3G的大小，再次将该卷挂载到win7_dash实例上，连接到该实例中查看磁盘的使用情况：<br>
<img src="https://img-blog.csdnimg.cn/071cf18e9a0f4b279beba06c1b1f6b58.png" alt="在这里插入图片描述"></p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 并通过cmd命令查看该虚拟机挂载的磁盘情况：<br>
<img src="https://img-blog.csdnimg.cn/43480d6392d44cc696120ddb1226bab8.png" alt="在这里插入图片描述"></p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 可以看到，确实挂载了3G的扩展卷，但是新增的1G卷并没有进行磁盘分区，因此无法使用，还需要手动到磁盘管理中进行分配，扩展原有的D盘为3G；</p>
<p><img src="https://img-blog.csdnimg.cn/99deef21bdf94ad78b5f3964572b2d80.png" alt="在这里插入图片描述"></p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 继续查看磁盘中的使用情况，可以看到出现了3G的磁盘：<br>
<img src="https://img-blog.csdnimg.cn/4ad03932e87d4bc89a0799ce321c1cf4.png" alt="在这里插入图片描述"></p>
<br>
<h3><a id="6xshell_278"></a>（6）xshell命令创建并挂载卷测试</h3>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; volume命令如下所示：<br>
卷备份：</p>
<pre><code class="prism language-cpp">  volume backup create
  volume backup <span class="token keyword">delete</span>
  volume backup list
  volume backup restore
  volume backup set
  volume backup show
</code></pre>
<p>卷操作：</p>
<pre><code class="prism language-cpp">  volume create
  volume <span class="token keyword">delete</span>
  volume host set
  volume list
  volume migrate
</code></pre>
<p>卷qos：</p>
<pre><code class="prism language-cpp">  volume qos associate
  volume qos create
  volume qos <span class="token keyword">delete</span>
  volume qos disassociate
  volume qos list
  volume qos set
  volume qos show
  volume qos unset
</code></pre>
<p>volume的分布式服务：</p>
<pre><code class="prism language-cpp">  volume service list
  volume service set
</code></pre>
<p>卷设置：</p>
<pre><code class="prism language-cpp">  volume set
  volume show
</code></pre>
<p>卷的快照：</p>
<pre><code class="prism language-cpp">  volume snapshot create
  volume snapshot <span class="token keyword">delete</span>
  volume snapshot list
  volume snapshot set
  volume snapshot show
  volume snapshot unset
  volume transfer request accept
  volume transfer request create
  volume transfer request <span class="token keyword">delete</span>
  volume transfer request list
  volume transfer request show
</code></pre>
<p>卷的类型：</p>
<pre><code class="prism language-cpp">  volume type create
  volume type <span class="token keyword">delete</span>
  volume type list
  volume type set
  volume type show
  volume type unset
  volume unset
</code></pre>
<p>创建卷：</p>
<pre><code class="prism language-cpp">openstack volume create <span class="token operator">--</span>size <span class="token number">2</span> <span class="token operator">--</span>image chrome_img chrome_3  
</code></pre>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 经过一段时间的创建，创建成功了卷：<br>
<img src="https://img-blog.csdnimg.cn/1a684ea8cbd445c08f371db623688c01.png" alt="在这里插入图片描述"></p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 将卷chrome_3挂载到实例win7_dash上：</p>
<pre><code class="prism language-cpp">openstack server add volume win7_dash chrome_3
</code></pre>
<p><img src="https://img-blog.csdnimg.cn/8a309bc7c0f74980b8355769b039943d.png" alt="在这里插入图片描述"></p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 可以看到，win7_dash实例中挂载了该卷到/dev/vdc中；</p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 通过控制台查看win7_dash实例，并没有看到挂载的第二个卷：</p>
<p><img src="https://img-blog.csdnimg.cn/b2c78c99c17f4b71889ee9d3c9fc7098.png" alt="在这里插入图片描述"></p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 再次通过cmd命令查看磁盘挂载情况：</p>
<p><img src="https://img-blog.csdnimg.cn/c45d3d9a882b4d089c3844329f376659.png" alt="在这里插入图片描述"></p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 为啥该磁盘是脱机状态呢？</p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 将卷chrome从win7_dash实例中脱机，可以看到该磁盘自动从实例中脱机了：</p>
<pre><code class="prism language-cpp">openstack server remove volume win7_dash chrome
</code></pre>
<p><img src="https://img-blog.csdnimg.cn/9e9b5383b4704b09a127a2902f0c3d7f.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5byA5Y-R5bCP6bi9,size_19,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 再次将卷chrome_3从实例win_dash中脱机，并且再次挂载，可以看到之前没有挂载显示的卷chrome_3重新显示出来了：<br>
<img src="https://img-blog.csdnimg.cn/d451ab41e7c743a69f5dfa3b5005feb1.png" alt="在这里插入图片描述"></p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 通过卷chrome_3来创建image镜像chrome_img_2：</p>
<pre><code class="prism language-cpp">openstack image create <span class="token operator">--</span>container<span class="token operator">-</span>format bare <span class="token operator">--</span>disk<span class="token operator">-</span>format qcow2 <span class="token operator">--</span>volume chrome_3 chrome_img_2
</code></pre>
<p><img src="https://img-blog.csdnimg.cn/81322ed1256c4633bb61326a2a3783af.png" alt="在这里插入图片描述"></p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 通过该镜像chrome_img_2创建新的卷chrome_4：</p>
<pre><code class="prism language-cpp">openstack volume create <span class="token operator">--</span>size <span class="token number">2</span> <span class="token operator">--</span>image chrome_img_2 chrome_4  
</code></pre>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 卷的状态是ERROR；</p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 重新对卷chrome_3创建新的镜像chrome_img_3：</p>
<pre><code class="prism language-cpp">openstack image create <span class="token operator">--</span>container<span class="token operator">-</span>format bare <span class="token operator">--</span>disk<span class="token operator">-</span>format raw <span class="token operator">--</span>volume chrome_3 chrome_img_3
</code></pre>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 可以看到，该镜像的大小是2G，与之前640KB的qcow2格式对比明显：<br>
<img src="https://img-blog.csdnimg.cn/3d74c4c5146b4f1c9e82ac398a185c12.png" alt="在这里插入图片描述"></p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 重新通过该镜像chrome_img_3创建新的卷chrome_4：</p>
<pre><code class="prism language-cpp">openstack volume create <span class="token operator">--</span>size <span class="token number">2</span> <span class="token operator">--</span>image chrome_img_3 chrome_4  
</code></pre>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 创建的卷的状态依然是ERROR；</p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 因此，尝试使用如下的命令创建卷的image镜像chrome_img_2：</p>
<pre><code class="prism language-cpp">cinder upload<span class="token operator">-</span>to<span class="token operator">-</span>image <span class="token operator">--</span>disk<span class="token operator">-</span>format raw <span class="token operator">--</span>visibility shared chrome_3 chrome_img_2   
</code></pre>
<p><img src="https://img-blog.csdnimg.cn/b3529d6d0dc14d07aa228f4ab35326c0.png" alt="在这里插入图片描述"></p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 再次通过镜像创建新的卷chrome_4</p>
<pre><code class="prism language-cpp">openstack volume create <span class="token operator">--</span>size <span class="token number">2</span> <span class="token operator">--</span>image chrome_img_2 chrome_4
</code></pre>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 状态依然失败，算了，不试了艹，估计做卷的备份的地方应该不多；<br>
<br></p>
<h3><a id="7winvhd_458"></a>（7）win机制作指定内容的vhd格式虚拟磁盘</h3>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 在磁盘管理中创建新的vhd格式的虚拟磁盘，显示为新的E盘；</p>
<p><img src="https://img-blog.csdnimg.cn/f1a69ed94fcc43f6b1c2b31b295e85c0.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5byA5Y-R5bCP6bi9,size_19,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 将需要传输的文件装入新的虚拟磁盘E中，然后将该磁盘从win机中分离：</p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 将该vhd格式文件上传到Controller节点中，然后上传到glance中作为镜像：</p>
<pre><code class="prism language-cpp">glance image<span class="token operator">-</span>create <span class="token operator">--</span>name <span class="token string">"chrome_vhd"</span> <span class="token operator">--</span>file <span class="token operator">/</span>image<span class="token operator">/</span>chrome<span class="token punctuation">.</span>vhd <span class="token operator">--</span>disk<span class="token operator">-</span>format vhd <span class="token operator">--</span>container<span class="token operator">-</span>format bare <span class="token operator">--</span>visibility <span class="token keyword">public</span> <span class="token operator">--</span>progress
</code></pre>
<p><img src="https://img-blog.csdnimg.cn/f087ed9879544c0baafcc2673fc819df.png" alt="在这里插入图片描述"></p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 再通过该vhd格式镜像创建卷：</p>
<p><img src="https://img-blog.csdnimg.cn/bfab301dc9094525be02cdba6a7420b8.png" alt="在这里插入图片描述"></p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 将该卷挂载到实例win7_dash中，通过控制台连接实例查看：<br>
<img src="https://img-blog.csdnimg.cn/34c3b53694754323a8e51f353bf08912.png" alt="在这里插入图片描述"></p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 可以看到，该卷直接挂载到了实例上，并且可以直接查看使用。<br>
<br></p>
<h3><a id="8_489"></a>（8）指定软件卷的制作</h3>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 在Win机中创建两个vhd格式虚拟磁盘，将指定的exe程序放入虚拟磁盘中，并将该磁盘用上面的方式上传到glance中作为卷：</p>
<p><img src="https://img-blog.csdnimg.cn/e2fee30ff73647c2a6b9ed8401725439.png" alt="在这里插入图片描述"></p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 接着通过该镜像创建卷：<br>
<img src="https://img-blog.csdnimg.cn/9204316b321045f09e897af1c4a00f2a.png" alt="在这里插入图片描述"></p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 可以直接挂载到实例上；<br>
<br></p>
<h3><a id="9_504"></a>（9）控制节点程序嵌入虚拟机镜像测试</h3>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 微服务都是java程序，因此需要在虚拟机win7_dash中安装JDK以及IDEA；</p>
<p><img src="https://img-blog.csdnimg.cn/cb13bd4758fa40ec9a5c4a7452d19bfd.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5byA5Y-R5bCP6bi9,size_17,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p>
</div>
</body>

</html>
