<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>【Java学习笔记（二十六）】之JDBC，JDBC的核心API，工具类以及JDBC的事务管理</title>
  <link rel="stylesheet" href="https://stackedit.io/style.css" />
</head>

<body class="stackedit">
  <div class="stackedit__html"><h2><a id="_0"></a>本文章由公号【开发小鸽】发布！欢迎关注！！！</h2>
<br>
<p><strong>老规矩–妹妹镇楼：</strong></p>
<center>
<img src="https://img-blog.csdnimg.cn/20200721223424816.JPG" width="20%">
</center><h2><a id="%09JDBC_9"></a>一．	JDBC</h2>
<h3><a id="%09_10"></a>（一）	概述</h3>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp;Java DataBase Connectivity，从名称来看，JDBC是用于Java连接数据库的。JDBC的本质是Java定义的访问数据库的标准接口，Java并没有定义如何访问各种数据库，具体的访问各种数据库的实现类是由各大数据库厂商实现的，这些实现类称为数据库驱动，厂商一般都会提供相应的jar包下载。<br>
<br></p>
<h3><a id="%09JDBC_15"></a>（二）	JDBC的优势</h3>
<br>
<ol>
<li>
<p>开发者只需面向接口编程，不用关注实现类。</p>
</li>
<li>
<p>使用同一套Java代码，只需少量修改就可访问JDBC支持的数据库。<br>
<br></p>
</li>
</ol>
<h3><a id="%09JDBCAPI_27"></a>（三）	JDBC的核心API</h3>
<br>

<table>
<thead>
<tr>
<th>API</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr>
<td>DriverManager  类</td>
<td>1) 管理和注册数据库驱动 2) 得到数据库连接对象</td>
</tr>
<tr>
<td>Connection  接口</td>
<td>一个连接对象，可用于创建 Statement 和 PreparedStatement 对象</td>
</tr>
<tr>
<td>Statement  接口</td>
<td>一个 SQL 语句对象，用于将 SQL 语句发送给数据库服务器。</td>
</tr>
<tr>
<td>PreparedStatemen  接口</td>
<td>一个 SQL 语句对象，是 Statement 的子接口</td>
</tr>
<tr>
<td>ResultSet  接口</td>
<td>用于封装数据库查询的结果集，返回给客户端 Java 程序</td>
</tr>
</tbody>
</table><br>
<h2><a id="%09DriverManager_43"></a>二．	DriverManager类</h2>
<h3><a id="_45"></a>（一）功能</h3>
<h4><a id="nbsp__nbsp__nbsp__nbsp1__47"></a>&nbsp;  &nbsp;  &nbsp;  &nbsp;1. 管理和注册驱动</h4>
<h4><a id="nbsp__nbsp__nbsp__nbsp2__49"></a>&nbsp;  &nbsp;  &nbsp;  &nbsp;2. 获得数据库连接对象</h4>
<br>
<h3><a id="_54"></a>（二）注册驱动</h3>
<h4><a id="nbsp__nbsp__nbsp__nbsp1_jar_55"></a>&nbsp;  &nbsp;  &nbsp;  &nbsp;1. 导入数据库驱动jar包</h4>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp;首先我们需要导入数据库驱动jar包，在项目下设置一个Lib文件夹，并将它右键Add as Library，设置为库。<br>
<br></p>
<h4><a id="nbsp__nbsp__nbsp__nbsp2__61"></a>&nbsp;  &nbsp;  &nbsp;  &nbsp;2. 注册驱动</h4>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp;告诉了程序该使用什么数据库驱动jar包。首先要注册驱动，通过下列语句实现：</p>
<pre><code class="prism language-sql">Class<span class="token punctuation">.</span>forName<span class="token punctuation">(</span> 数据库驱动实现类<span class="token punctuation">)</span>  
</code></pre>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp;加载和注册数据库驱动，数据库驱动由 mysql 厂商提供（com.mysql.cj,jdbc.Driver）</p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp;Class.forName(“com.mysql.cj.jdbc.Driver”);实现注册mysql驱动。（mysql8.0之后的注册驱动为com.mysql.cj.jdbc.Driver）</p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp;深入com.mysql.jdbc.Driver源码查看实现，</p>
<pre><code class="prism language-sql">try {
	DriverManager<span class="token punctuation">.</span>registerDriver<span class="token punctuation">(</span>new Driver<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//注册数据库驱动</span>
} catch <span class="token punctuation">(</span>SQLException var1<span class="token punctuation">)</span> {
	throw new RuntimeException<span class="token punctuation">(</span><span class="token string">"Can't register driver!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
}
</code></pre>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp;可以看到，注册驱动调用的是DriverManager类中的registerDriver方法。</p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp;注意：mysql5之后的驱动jar包可以省略注册驱动步骤，但是建议写上。<br>
<br></p>
<h3><a id="_91"></a>（三）获取数据库连接对象</h3>
<br>
<h4><a id="1__96"></a>1. 方法</h4>
<br>

<table>
<thead>
<tr>
<th>静态方法</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>Connection getConnection (String url, String user, String password)</td>
<td>通过连接字符串，用户名，密码来得到数据库的连接对象</td>
</tr>
<tr>
<td>Connection getConnection (String url, Properties info)</td>
<td>通过连接字符串，属性对象来到连接对象</td>
</tr>
</tbody>
</table><br>
<h4><a id="2_URL_109"></a>2. URL的地址格式</h4>
<br>
<pre><code class="prism language-sql">协议名: 子协议:<span class="token comment">// 服务器名或 IP  地址: 端口号/ 数据库名? 参数= 参数值</span>
</code></pre>
<p>如：</p>
<pre><code class="prism language-sql">jdbc:mysql:<span class="token comment">//localhost:3306/数据库?参数</span>
</code></pre>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp;如连接本地服务器，且端口号为3306，则可省略localhost:3306<br>
<br></p>
<h4><a id="3__130"></a>3. 连接数据库测试</h4>
<br>
<pre><code class="prism language-java"><span class="token keyword">package</span> JDBC<span class="token punctuation">;</span>

<span class="token keyword">import</span> java<span class="token punctuation">.</span>io<span class="token punctuation">.</span>IOException<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span>Connection<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span>DriverManager<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span>SQLException<span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">test</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> IOException<span class="token punctuation">,</span> SQLException <span class="token punctuation">{</span>

        String url <span class="token operator">=</span> <span class="token string">"jdbc:mysql://localhost:3306/h"</span><span class="token punctuation">;</span>
        Connection con <span class="token operator">=</span> DriverManager<span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token string">"root"</span><span class="token punctuation">,</span> <span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>con<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp;注意，可能会出现TIME_ZONE问题，这是数据库的系统时间设置，需要改为东八区”+8:00”。</p>
<br>
<h2><a id="_Connection_159"></a>三. Connection接口</h2>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp;Connection接口的具体实现类由厂商实现，代表一个连接对象。<br>
<br></p>
<h3><a id="SQL_165"></a>（一）获取执行SQL的对象</h3>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp;方法：返回一个可以执行sql语句的对象。</p>
<pre><code class="prism language-sql">Statement createStatement<span class="token punctuation">(</span><span class="token punctuation">)</span>		
preparedStatement prepareStatement<span class="token punctuation">(</span>String <span class="token keyword">sql</span><span class="token punctuation">)</span>
</code></pre>
<br>
<h3><a id="_177"></a>（二）管理事务</h3>
<h4><a id="1__178"></a>1. 开启事务</h4>
<pre><code class="prism language-sql">setAutoCommit<span class="token punctuation">(</span><span class="token keyword">Boolean</span> autoCommit<span class="token punctuation">)</span>
</code></pre>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp;该方法用于设置自动提交，参数设为false即为手动提交，即手动开启事务。<br>
<br></p>
<h4><a id="2__189"></a>2. 提交事务</h4>
<pre><code class="prism language-sql"><span class="token keyword">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
<br>
<h4><a id="3__198"></a>3. 回滚事务</h4>
<pre><code class="prism language-sql"><span class="token keyword">rollback</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
<br>
<h2><a id="%09Statement_208"></a>四．	Statement接口</h2>
<h3><a id="_209"></a>（一）作用</h3>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp;Statement对象为一个语句对象，用于发送SQL语句给服务器，用于执行静态的SQL语句并返回他所生成结果的对象。<br>
<br></p>
<h3><a id="_215"></a>（二）方法</h3>
<br>

<table>
<thead>
<tr>
<th>方法</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr>
<td>boolean execute(String sql)</td>
<td>执行任意的SQL语句</td>
</tr>
<tr>
<td>int executeUpdate(String sql)</td>
<td>执行DML（insert, update, delete）语句，DDL（create, alter, drop）语句，返回的是该语句影响的行数，通过这个行数判断SQL语句是否执行成功，行数大于0则成功。</td>
</tr>
<tr>
<td>ResultSet executeQuery(String sql)</td>
<td>执行DQL（select）语句</td>
</tr>
</tbody>
</table><br>
<h2><a id="ResultSet_230"></a>五．ResultSet接口</h2>
<h3><a id="%09_232"></a>（一）	作用</h3>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp;封装数据库的查询结果集，用于对结果集进行遍历，取出每一条数据。<br>
<br></p>
<h3><a id="%09_238"></a>（二）	使用</h3>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp;ResultSet结果集使用游标进行遍历，游标按照行进行遍历的，每次游标指向一行。一开始的游标指向第一条记录的上面，要获取第一条记录，我们需要将游标下移一行。<br>
<br></p>
<h3><a id="%09_244"></a>（三）	方法</h3>
<br>

<table>
<thead>
<tr>
<th>方法</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr>
<td>boolean next()</td>
<td>游标下移一行，返回boolean，如有下一条记录返回true</td>
</tr>
<tr>
<td>数据类型 getxx(String/ int)</td>
<td>xx是数据类型，参数可以为字段名getString(“name”)或者是列号getString(1)，列号从1开始</td>
</tr>
</tbody>
</table><p>如</p>
<pre><code class="prism language-sql"><span class="token keyword">double</span> getDouble<span class="token punctuation">(</span>String columnLabel<span class="token punctuation">)</span>
<span class="token keyword">double</span> getDouble<span class="token punctuation">(</span><span class="token keyword">Int</span> columnNumber<span class="token punctuation">)</span>
</code></pre>
<br>
<h3><a id="%09ResultSet_264"></a>（四）	遍历ResultSet</h3>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp;用游标的next()函数的返回值判断是否是最后一行，可以不断循环知道最后一行。<br>
<br></p>
<pre><code class="prism language-java"><span class="token keyword">package</span> JDBC<span class="token punctuation">;</span>

<span class="token keyword">import</span> java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span>*<span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ResultSet</span>使用 <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        Connection con <span class="token operator">=</span> null<span class="token punctuation">;</span>
        Statement stm <span class="token operator">=</span> null<span class="token punctuation">;</span>
        ResultSet rs <span class="token operator">=</span> null<span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            Class<span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token string">"com.mysql.cj.jdbc.Driver"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            con <span class="token operator">=</span> DriverManager<span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token string">"jdbc:mysql:///heima"</span><span class="token punctuation">,</span> <span class="token string">"root"</span><span class="token punctuation">,</span> <span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            String sql <span class="token operator">=</span> <span class="token string">"select * from student"</span><span class="token punctuation">;</span>
            stm <span class="token operator">=</span> con<span class="token punctuation">.</span><span class="token function">createStatement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            rs <span class="token operator">=</span> stm<span class="token punctuation">.</span><span class="token function">executeQuery</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">while</span><span class="token punctuation">(</span>rs<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token keyword">int</span> id <span class="token operator">=</span> rs<span class="token punctuation">.</span><span class="token function">getInt</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                String name <span class="token operator">=</span> rs<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">int</span> age <span class="token operator">=</span> rs<span class="token punctuation">.</span><span class="token function">getInt</span><span class="token punctuation">(</span><span class="token string">"age"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>name <span class="token operator">+</span> <span class="token string">"的id是"</span> <span class="token operator">+</span> id <span class="token operator">+</span> <span class="token string">" 年龄是"</span> <span class="token operator">+</span> age <span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">ClassNotFoundException</span> <span class="token operator">|</span> SQLException e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">finally</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>rs <span class="token operator">!=</span> null<span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token keyword">try</span> <span class="token punctuation">{</span>
                    rs<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>

            <span class="token keyword">if</span><span class="token punctuation">(</span>stm <span class="token operator">!=</span> null<span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token keyword">try</span> <span class="token punctuation">{</span>
                    stm<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>

            <span class="token keyword">if</span><span class="token punctuation">(</span>con <span class="token operator">!=</span> null<span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token keyword">try</span> <span class="token punctuation">{</span>
                    con<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<br>
<h2><a id="%09PreparedStatement_326"></a>六．	PreparedStatement接口</h2>
<h3><a id="%09_327"></a>（一）	概述</h3>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp;表示预编译的SQL语句对象，SQL已经预编译并存储在PreparedStatement对象中。使用该对象可以解决SQL的注入问题。PreparedStatement对象会先将SQL语句发送给数据库预编译，然后该对象引用预编译后的结果，可以多次传入不同的参数给PreparedStatement对象并执行，减少了SQL编译次数，提高了效率。<br>
<br></p>
<h3><a id="%09SQL_333"></a>（二）	SQL注入问题</h3>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp;在拼接SQL时，有一些SQL的特殊关键字参与字符串的拼接中，会造成意想不到的安全问题。<br>
<br></p>
<h3><a id="%09PreparedStatement_339"></a>（三）	使用PreparedStatement</h3>
<h4><a id="1%09_340"></a>1.	？占位符</h4>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp;在定义SQL语句时，使用？占位符作为SQL的参数，如：</p>
<pre><code class="prism language-sql"><span class="token keyword">Select</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token keyword">user</span> <span class="token keyword">where</span> username<span class="token operator">=</span>? <span class="token operator">and</span> password<span class="token operator">=</span>?<span class="token punctuation">;</span>
</code></pre>
<br>
<h4><a id="2%09ConnectionpreparedStatementString_sql_350"></a>2.	Connection.preparedStatement(String sql)</h4>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp;获取该对象时要传入SQL语句<br>
<br></p>
<h4><a id="3%09_356"></a>3.	给？占位符赋值</h4>
<p>方法：setxx(参数1，参数2)<br>
&nbsp;  &nbsp;  &nbsp;  &nbsp;xx为参数的类型；</p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp;参数1：？占位符的位置编号，从1开始，即第几个？<br>
&nbsp;  &nbsp;  &nbsp;  &nbsp;参数2：？占位符的值<br>
如：</p>
<p>Sql语句为：</p>
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token keyword">user</span> <span class="token keyword">where</span> username<span class="token operator">=</span>? <span class="token operator">and</span> password<span class="token operator">=</span>?
</code></pre>
<p>赋值语句为：</p>
<pre><code class="prism language-sql">setString<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> username<span class="token punctuation">)</span><span class="token punctuation">;</span>
setString<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<br>
<h4><a id="4%09PreparedStatmentSQL_380"></a>4.	PreparedStatment对象执行SQL语句不需要传参</h4>
<br>
<h2><a id="%09_385"></a>七．	释放资源</h2>
<h3><a id="%09_386"></a>（一）	需要释放的对象</h3>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp;ResultSet结果集，Statement语句，Connection连接<br>
<br></p>
<h3><a id="%09_392"></a>（二）	释放顺序</h3>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp;先创建的后关闭，后创建的先关闭。</p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp;ResultSet -&gt; Statement -&gt; Connection<br>
<br></p>
<h3><a id="%09_400"></a>（三）	位置</h3>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp;释放资源是必须做的，因此不能放在try代码段中，因为可能有不执行的风险，我们需要将该代码放在finally代码块中。</p>
<br>
<h2><a id="_JDBC_405"></a>八． JDBC表中插入数据</h2>
<br>
<pre><code class="prism language-java"><span class="token keyword">package</span> JDBC<span class="token punctuation">;</span>

<span class="token keyword">import</span> java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span>Connection<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span>DriverManager<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span>SQLException<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span>Statement<span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">InsertTest</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        Statement stm <span class="token operator">=</span> null<span class="token punctuation">;</span>
        Connection con <span class="token operator">=</span> null<span class="token punctuation">;</span>

        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token comment">//1.注册驱动</span>
            Class<span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token string">"com.mysql.cj.jdbc.Driver"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//2.定义SQL</span>
            String sql <span class="token operator">=</span> <span class="token string">"insert into student(id,name,age) values(14,'dd',24)"</span><span class="token punctuation">;</span>
            <span class="token comment">//3.获取Connection对象</span>
            con <span class="token operator">=</span> DriverManager<span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token string">"jdbc:mysql:///heima"</span><span class="token punctuation">,</span> <span class="token string">"root"</span><span class="token punctuation">,</span> <span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//4.获取执行SQL的对象Statement</span>
            stm <span class="token operator">=</span> con<span class="token punctuation">.</span><span class="token function">createStatement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//5.执行SQL</span>
            <span class="token keyword">int</span> count <span class="token operator">=</span> stm<span class="token punctuation">.</span><span class="token function">executeUpdate</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//6.处理结果</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>count <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"添加成功！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">else</span><span class="token punctuation">{</span>
                System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"添加失败！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">ClassNotFoundException</span> <span class="token operator">|</span> SQLException e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">finally</span> <span class="token punctuation">{</span>
            <span class="token comment">//释放资源</span>
            <span class="token comment">//判断空指针异常</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>stm <span class="token operator">!=</span> null<span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token keyword">try</span> <span class="token punctuation">{</span>
                    stm<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>

            <span class="token keyword">if</span><span class="token punctuation">(</span>con <span class="token operator">!=</span> null<span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token keyword">try</span> <span class="token punctuation">{</span>
                    con<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>

        <span class="token punctuation">}</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp;注意：SQL语句中的字段名称没有带引号。</p>
<br>
<h2><a id="_JDBC_474"></a>九． JDBC的工具类</h2>
<h3><a id="%09_475"></a>（一）	创建工具类</h3>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp;用JDBC每次连接数据库都要重复一些步骤 ，为了简化流程，我们可以将一些功能封装成一个工具类，在不同的地方复用。</p>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp;在使用JDBC的模块下创建一个类：JDBCUtils<br>
<br></p>
<h3><a id="%09_483"></a>（二）	工具类的方法</h3>
<br>
<ol>
<li>
<p>抽取一个方法获取连接对象</p>
</li>
<li>
<p>抽取一个方法释放资源<br>
<br></p>
</li>
</ol>
<h3><a id="%09_491"></a>（三）	使用配置文件</h3>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp;使用配置文件，提高工具类的通用性。将Driver，User，Password，Url等可能会变化的字符串写到配置文件中，可以省去在代码中修改的麻烦。<br>
<br></p>
<h3><a id="%09_496"></a>（四）	使用静态代码块读取配置文件</h3>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp;静态代码块读取配置文件，只需读取一次即可。<br>
<br></p>
<h3><a id="%09_500"></a>（五）	使用类加载器获取配置文件路径</h3>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp;类加载器可以用于找到配置文件的文件路径，通过配置对象的加载将配置文件加载到配置对象中，进而导出文件中的属性值。<br>
<br></p>
<h3><a id="%09_506"></a>（六）	工具类代码示例</h3>
<br>
<pre><code class="prism language-java"><span class="token keyword">package</span> Utils<span class="token punctuation">;</span>

<span class="token keyword">import</span> java<span class="token punctuation">.</span>io<span class="token punctuation">.</span>FileReader<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>io<span class="token punctuation">.</span>IOException<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>net<span class="token punctuation">.</span>URL<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>Properties<span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JDBCUtils</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> String url<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> String user<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> String password<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> String driver<span class="token punctuation">;</span>

    <span class="token keyword">static</span><span class="token punctuation">{</span>
        <span class="token comment">//读取配置文件</span>
        <span class="token comment">//创建Properties集合类</span>
        Properties  pro <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Properties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//加载文件</span>
        <span class="token comment">//通过名称找到该配置文件</span>
        <span class="token comment">//类加载器</span>
        ClassLoader classLoader <span class="token operator">=</span> JDBCUtils<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//类加载器找资源</span>
        URL res <span class="token operator">=</span> classLoader<span class="token punctuation">.</span><span class="token function">getResource</span><span class="token punctuation">(</span><span class="token string">"jdbc.properties"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//获取该资源的绝对路径</span>
        String path <span class="token operator">=</span> res<span class="token punctuation">.</span><span class="token function">getPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            pro<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FileReader</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        
        <span class="token comment">//获取数据</span>
        url <span class="token operator">=</span> pro<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"url"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        user <span class="token operator">=</span> pro<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"user"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        password <span class="token operator">=</span> pro<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"password"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        driver <span class="token operator">=</span> pro<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"driver"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//注册驱动</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            Class<span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span>driver<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">ClassNotFoundException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token comment">/**
     * 获取连接
     * @return 连接对象
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> Connection <span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> SQLException <span class="token punctuation">{</span>

        <span class="token keyword">return</span> DriverManager<span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> user<span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 释放资源
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">close</span><span class="token punctuation">(</span>Statement stm<span class="token punctuation">,</span> Connection con<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>stm <span class="token operator">!=</span> null<span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
                stm<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">if</span><span class="token punctuation">(</span>con <span class="token operator">!=</span> null<span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
                con<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">close</span><span class="token punctuation">(</span>ResultSet rs<span class="token punctuation">,</span>  Statement stm<span class="token punctuation">,</span> Connection con<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>rs <span class="token operator">!=</span> null<span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
                rs<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">if</span><span class="token punctuation">(</span>stm <span class="token operator">!=</span> null<span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
                stm<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">if</span><span class="token punctuation">(</span>con <span class="token operator">!=</span> null<span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
                con<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<br>
<h2><a id="%09JDBC_620"></a>十．	JDBC管理事务</h2>
<h3><a id="%09_621"></a>（一）	开启事务</h3>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp;使用setAutoCommit(Boolean autoCommit)开启事务，在执行SQL语句之前开启事务。<br>
<br></p>
<h3><a id="_627"></a>（二）提交事务</h3>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp;执行完所有SQL语句后提交事务。<br>
<br></p>
<h3><a id="_633"></a>（三）回滚事务</h3>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp;用try-catch-语句将事务包起来，try代码段中写执行SQL语句，catch代码段中写回滚事务rollback()。当出现异常时，catch异常代码块中会执行事务的回滚，将事务状态回滚到之前的状态。<br>
<br></p>
<h3><a id="_639"></a>（四）代码实现</h3>
<br>
<pre><code class="prism language-java"><span class="token keyword">package</span> JDBC<span class="token punctuation">;</span>

<span class="token keyword">import</span> Utils<span class="token punctuation">.</span>JDBCUtils<span class="token punctuation">;</span>

<span class="token keyword">import</span> java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span>Connection<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span>PreparedStatement<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span>SQLException<span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Transaction</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        Connection connecton <span class="token operator">=</span> null<span class="token punctuation">;</span>
        PreparedStatement ps <span class="token operator">=</span> null<span class="token punctuation">;</span>
        <span class="token keyword">try</span><span class="token punctuation">{</span>
            <span class="token comment">//连接</span>
            connecton <span class="token operator">=</span> JDBCUtils<span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//开启事务</span>
            connecton<span class="token punctuation">.</span><span class="token function">setAutoCommit</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            String sql <span class="token operator">=</span> <span class="token string">"update student set age = age - ? where name = ?"</span><span class="token punctuation">;</span>
            <span class="token comment">//执行语句对象</span>
            ps <span class="token operator">=</span> connecton<span class="token punctuation">.</span><span class="token function">prepareStatement</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//设置值</span>
            ps<span class="token punctuation">.</span><span class="token function">setInt</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            ps<span class="token punctuation">.</span><span class="token function">setString</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">"xx"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//更新</span>
            ps<span class="token punctuation">.</span><span class="token function">executeUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//设置异常</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token number">100</span> <span class="token operator">/</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//提交事务</span>
            connecton<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"修改成功"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
                connecton<span class="token punctuation">.</span><span class="token function">rollback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> ex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                ex<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"修改失败"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">finally</span> <span class="token punctuation">{</span>
            <span class="token comment">//关闭资源</span>
            JDBCUtils<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span>ps<span class="token punctuation">,</span> connecton<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
</div>
</body>

</html>
