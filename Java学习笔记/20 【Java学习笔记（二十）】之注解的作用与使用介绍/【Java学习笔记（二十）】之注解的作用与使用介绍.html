<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>【Java学习笔记（二十）】之注解的作用与使用介绍</title>
  <link rel="stylesheet" href="https://stackedit.io/style.css" />
</head>

<body class="stackedit">
  <div class="stackedit__html"><h2><a id="_0"></a>本文章由公号【开发小鸽】发布！欢迎关注！！！</h2>
<br>
<p><strong>老规矩–妹妹镇楼：</strong></p>
<center>
<img src="https://img-blog.csdnimg.cn/20200721223424816.JPG" width="20%">
</center><h2><a id="%09_7"></a>一．	注解</h2>
<h3><a id="%09_8"></a>（一）	概述</h3>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 也叫元数据。一种代码级别的说明。它是JDK1.5及以后版本引入的一个特性，与类、接口、枚举是在同一个层次。它可以声明在包、类、字段、方法、局部变量、方法参数等的前面，用来对这些元素进行说明，注释。<br>
<br></p>
<h3><a id="%09_13"></a>（二）	使用方法</h3>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; @注解名称<br>
<br></p>
<h3><a id="%09_17"></a>（三）	注解的作用</h3>
<h4><a id="1%09_18"></a>1.	编写文档</h4>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 通过代码里标识的注解生成文档。<br>
<br></p>
<h4><a id="2%09_22"></a>2.	代码分析</h4>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 通过代码里标识的注解对代码进行分析<br>
<br></p>
<h4><a id="3%09_26"></a>3.	编译检查</h4>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 通过代码里标识的注解让编译器能够实现基本的编译检查（如@Override）</p>
<br>
<h2><a id="JDK_31"></a>二．JDK内置注解</h2>
<h3><a id="1%09Override_32"></a>1.	@Override</h3>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 检测该注解标注的方法是否是继承自父类的。<br>
<br></p>
<h3><a id="2%09Deprecated_36"></a>2.	@Deprecated</h3>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 表示该注解标注的内容已经过时了，可以用但是不建议使用。<br>
<br></p>
<h3><a id="3_SuppressWarnings_40"></a>3. @SuppressWarnings</h3>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 抑制警告，抑制已经显示的警告。一般传递参数all</p>
<pre><code class="prism language-java"><span class="token annotation punctuation">@SuppressWarnings</span><span class="token punctuation">(</span>“all”<span class="token punctuation">)</span>
</code></pre>
<br>
<h2><a id="__48"></a>三 自定义注解</h2>
<h3><a id="%09_49"></a>（一）	格式</h3>
<pre><code class="prism language-java">元注解
<span class="token keyword">public</span> @<span class="token keyword">interface</span> 注解名称<span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre>
<br>
<h3><a id="%09_57"></a>（二）	注解的本质</h3>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 注解本质上是一个接口，改接口默认继承Annotation接口<br>
<br></p>
<h3><a id="%09_61"></a>（三）	注解的属性</h3>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 注解中的属性即接口中的抽象方法，属性的返回值类型只能用以下的类型：</p>
<ol>
<li>基本数据类型</li>
<li>String</li>
<li>枚举</li>
<li>注解</li>
<li>以上类型的数组</li>
</ol>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; <strong>定义了属性后，在使用注解时需要给属性赋值。即给抽象方法的返回值赋值。</strong><br>
<br></p>
<p><strong>注意：<br>
&nbsp;  &nbsp;  &nbsp;  &nbsp; 如果使用default关键字给属性默认初始化值，则使用注解时可以不赋值属性。<br>
&nbsp;  &nbsp;  &nbsp;  &nbsp; 如果只有一个属性要赋值，该属性名称为value，则value可省略直接定义值。</strong></p>
<br>
<h2><a id="_79"></a>四．元注解</h2>
<h3><a id="_80"></a>（一）概述</h3>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 预定义的注解，用于描述注解的注解。<br>
<br></p>
<h3><a id="_84"></a>（二）举例</h3>
<h4><a id="1_Target_85"></a>1. @Target</h4>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 用于描述注解能够作用的位置</p>
<pre><code class="prism language-java">TYPE<span class="token operator">:</span>作用于类上
METHOD<span class="token operator">:</span>作用于方法上
FIELD<span class="token operator">:</span>作用于成员变量上
</code></pre>
<br>
<h4><a id="2Retention_96"></a>2．@Retention</h4>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 描述注解被保留的阶段，三个阶段：源代码夹断，Class类阶段，运行阶段。</p>
<pre><code class="prism language-java"><span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span>RetentionPolicy<span class="token punctuation">.</span>SOURCE<span class="token punctuation">)</span>
<span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span>RetentionPolicy<span class="token punctuation">.</span>CLASS<span class="token punctuation">)</span>
<span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span>RetentionPolicy<span class="token punctuation">.</span>RUNTIME<span class="token punctuation">)</span>
</code></pre>
<br>
<h4><a id="3%09Documented_106"></a>3.	@Documented</h4>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 描述注解是否被抽取到api文档中显示。<br>
<br></p>
<h4><a id="4%09Inherited_110"></a>4.	@Inherited</h4>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 描述注解是否被子类继承</p>
<br>
<h2><a id="_115"></a>五．注解的使用</h2>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 注解通常用于取代配置文件，通过解析注解即可获取注解中定义的属性。<br>
<br></p>
<h3><a id="%09_119"></a>（一）	定义注解：</h3>
<pre><code class="prism language-java"><span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span><span class="token punctuation">{</span>Element<span class="token punctuation">.</span>Type<span class="token punctuation">.</span>TYPE<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span>RetentionPolicy<span class="token punctuation">.</span>RUNTIME<span class="token punctuation">)</span>
<span class="token keyword">public</span> @<span class="token keyword">interface</span> <span class="token class-name">Pro</span><span class="token punctuation">{</span>
	String <span class="token function">className</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	String <span class="token function">methodName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<br>
<h3><a id="%09_131"></a>（二）	定义类</h3>
<pre><code class="prism language-java"><span class="token annotation punctuation">@Pro</span><span class="token punctuation">(</span>className <span class="token operator">=</span> “xx<span class="token punctuation">.</span>xx”<span class="token punctuation">,</span> methodName <span class="token operator">=</span> “xx”<span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">ReTest</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 我们要在ReTest类中利用注解取得相应的className和methodName，需要通过以下的步骤来获取。<br>
<br></p>
<h4><a id="1%09_141"></a>1.	解析注解</h4>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 获取该类的字节码文件对象</p>
<pre><code class="prism language-java">Class<span class="token generics function"><span class="token punctuation">&lt;</span>ReTest<span class="token punctuation">&gt;</span></span> ret <span class="token operator">=</span> ReTest<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">;</span>
</code></pre>
<br>
<h4><a id="2%09_149"></a>2.	获取注解定义位置的对象</h4>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 获取注解对象就是在内存中生成了该注解接口的子类实现对象。</p>
<pre><code class="prism language-java">Pro an <span class="token operator">=</span> ret<span class="token punctuation">.</span><span class="token function">getAnnotation</span><span class="token punctuation">(</span>Pro<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
</code></pre>
<br>
<h4><a id="3%09_157"></a>3.	调用注解对象中定义的抽象方法，获取返回值</h4>
<pre><code class="prism language-java">String className <span class="token operator">=</span> an<span class="token punctuation">.</span><span class="token function">className</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
String methodName <span class="token operator">=</span> an<span class="token punctuation">.</span><span class="token function">methodName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<br>
<h2><a id="_165"></a>六．注解用于搭建简单的测试框架</h2>
<h3><a id="_166"></a>（一）需求</h3>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 将注解加于方法之上，即可测试该方法是否会出现异常，并将异常记录在文件中。<br>
<br></p>
<h3><a id="_170"></a>（二）代码</h3>
<p>&nbsp;  &nbsp;  &nbsp;  &nbsp; 测试计算器类Calculator中的方法是有会出现异常，将@Check注解放置于方法上，有注解的方法被测试类TestCheck测试，测试结果放在bug.txt文本文件中。<br>
<br></p>
<p><strong>每个文件的代码如下：</strong></p>
<h4><a id="1_Calculator_176"></a>1. 计算器类Calculator</h4>
<pre><code class="prism language-java"><span class="token keyword">package</span> 注解实现测试框架<span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Calculator</span> <span class="token punctuation">{</span>
    <span class="token comment">//加法</span>
    <span class="token annotation punctuation">@Check</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"1 + 0 ="</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">+</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//减法</span>
    <span class="token annotation punctuation">@Check</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">sub</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"1- 0 = "</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//除法</span>
    <span class="token annotation punctuation">@Check</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">div</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"1 / 0 = "</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">/</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<br>
<h4><a id="2Check_204"></a>2.自定义注解@Check</h4>
<br>
<pre><code class="prism language-java"><span class="token keyword">package</span> 注解实现测试框架<span class="token punctuation">;</span>

<span class="token keyword">import</span> java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>ElementType<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>Retention<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>RetentionPolicy<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>Target<span class="token punctuation">;</span>

<span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span>RetentionPolicy<span class="token punctuation">.</span>RUNTIME<span class="token punctuation">)</span>
<span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span>ElementType<span class="token punctuation">.</span>METHOD<span class="token punctuation">)</span>
<span class="token keyword">public</span> @<span class="token keyword">interface</span> <span class="token class-name">Check</span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span>
</code></pre>
<br>
<h4><a id="3_224"></a>3.测试类</h4>
<br>
<pre><code class="prism language-java"><span class="token keyword">package</span> 注解实现测试框架<span class="token punctuation">;</span>

<span class="token keyword">import</span> java<span class="token punctuation">.</span>io<span class="token punctuation">.</span>BufferedWriter<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>io<span class="token punctuation">.</span>FileWriter<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>io<span class="token punctuation">.</span>IOException<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span>InvocationTargetException<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span>Method<span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestCheck</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> IOException <span class="token punctuation">{</span>
        Calculator c <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Calculator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//获取该类的字节码文件对象</span>
        Class<span class="token operator">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">Calculator</span><span class="token operator">&gt;</span> cls <span class="token operator">=</span> c<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//获取所有方法</span>
        Method<span class="token punctuation">[</span><span class="token punctuation">]</span> methods <span class="token operator">=</span> cls<span class="token punctuation">.</span><span class="token function">getMethods</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">int</span> num <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        BufferedWriter bw <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BufferedWriter</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FileWriter</span><span class="token punctuation">(</span><span class="token string">"bug.txt"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">for</span><span class="token punctuation">(</span>Method method <span class="token operator">:</span> methods<span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token comment">//判断方法上是否有Check注解</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>method<span class="token punctuation">.</span><span class="token function">isAnnotationPresent</span><span class="token punctuation">(</span>Check<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token comment">//有Check注解，执行</span>
                <span class="token keyword">try</span><span class="token punctuation">{</span>
                    method<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token comment">//捕获异常，记录到文件中</span>

                    num<span class="token operator">++</span><span class="token punctuation">;</span>
                    bw<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>method<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"方法出现异常"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    bw<span class="token punctuation">.</span><span class="token function">newLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    bw<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">"异常的名称："</span> <span class="token operator">+</span> e<span class="token punctuation">.</span><span class="token function">getCause</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    bw<span class="token punctuation">.</span><span class="token function">newLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    bw<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">"异常的原因："</span> <span class="token operator">+</span> e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    bw<span class="token punctuation">.</span><span class="token function">newLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    bw<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">"----------------"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    bw<span class="token punctuation">.</span><span class="token function">newLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        bw<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">"本次测试一共出现"</span> <span class="token operator">+</span> num <span class="token operator">+</span> <span class="token string">"次异常"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        bw<span class="token punctuation">.</span><span class="token function">flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        bw<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
</div>
</body>

</html>
